

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>SIRENA functions &mdash; SIRENA 2.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/_themes/themes_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/style.css" type="text/css" />
  

  
    <link rel="top" title="SIRENA 2.0 documentation" href="index.html"/>
        <link rel="next" title="References" href="zreferences.html"/>
        <link rel="prev" title="SIRENA Tools CLI" href="SIRENAcommandline.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> SIRENA
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="SIRENA.html">SIRENA description</a></li>
<li class="toctree-l1"><a class="reference internal" href="SIRENAcommandline.html">SIRENA Tools CLI</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SIRENA functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">SIRENA</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>SIRENA functions</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="_sources/SIRENAfunctions.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="functions"></span><div class="section" id="sirena-functions">
<h1>SIRENA functions<a class="headerlink" href="#sirena-functions" title="Permalink to this headline">¶</a></h1>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#a"><span class="std std-ref">A</span></a></td>
<td><a class="reference internal" href="#b"><span class="std std-ref">B</span></a></td>
<td><a class="reference internal" href="#c"><span class="std std-ref">C</span></a></td>
<td><a class="reference internal" href="#d"><span class="std std-ref">D</span></a></td>
<td><a class="reference internal" href="#e"><span class="std std-ref">E</span></a></td>
<td><a class="reference internal" href="#f"><span class="std std-ref">F</span></a></td>
<td><a class="reference internal" href="#g"><span class="std std-ref">G</span></a></td>
<td><a class="reference internal" href="#h"><span class="std std-ref">H</span></a></td>
<td><a class="reference internal" href="#i"><span class="std std-ref">I</span></a></td>
<td><a class="reference internal" href="#j"><span class="std std-ref">J</span></a></td>
<td><a class="reference internal" href="#k"><span class="std std-ref">K</span></a></td>
<td><a class="reference internal" href="#l"><span class="std std-ref">L</span></a></td>
<td><a class="reference internal" href="#m"><span class="std std-ref">M</span></a></td>
<td><a class="reference internal" href="#n"><span class="std std-ref">N</span></a></td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#o"><span class="std std-ref">O</span></a></td>
<td><a class="reference internal" href="#p"><span class="std std-ref">P</span></a></td>
<td><a class="reference internal" href="#q"><span class="std std-ref">Q</span></a></td>
<td><a class="reference internal" href="#r"><span class="std std-ref">R</span></a></td>
<td><a class="reference internal" href="#s"><span class="std std-ref">S</span></a></td>
<td><a class="reference internal" href="#t"><span class="std std-ref">T</span></a></td>
<td><a class="reference internal" href="#u"><span class="std std-ref">U</span></a></td>
<td><a class="reference internal" href="#v"><span class="std std-ref">V</span></a></td>
<td><a class="reference internal" href="#w"><span class="std std-ref">W</span></a></td>
<td><a class="reference internal" href="#x"><span class="std std-ref">X</span></a></td>
<td><a class="reference internal" href="#y"><span class="std std-ref">Y</span></a></td>
<td><a class="reference internal" href="#z"><span class="std std-ref">Z</span></a></td>
</tr>
</tbody>
</table>
<p>Search functions by name at <a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a>.</p>
<span class="target" id="a"></span><dl class="function">
<dt id="_CPPv211addFirstRowP21ReconstructInitSIRENAPP8fitsfilediP10gsl_vectorP10gsl_vectorP10gsl_matrixP10gsl_matrixP10gsl_matrixP10gsl_matrixP10gsl_matrixP10gsl_matrix">
<span id="addFirstRow__ReconstructInitSIRENAP.fitsfilePP.double.i.gsl_vectorP.gsl_vectorP.gsl_matrixP.gsl_matrixP.gsl_matrixP.gsl_matrixP.gsl_matrixP.gsl_matrixP"></span>int <code class="descclassname"></code><code class="descname">addFirstRow</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em>, fitsfile **<em>inLibObject</em>, double <em>samprate</em>, int <em>runF0orB0val</em>, gsl_vector *<em>E</em>, gsl_vector *<em>PHEIGHT</em>, gsl_matrix *<em>PULSE</em>, gsl_matrix *<em>PULSEB0</em>, gsl_matrix *<em>MF</em>, gsl_matrix *<em>MFB0</em>, gsl_matrix *<em>COVAR</em>, gsl_matrix *<em>WEIGHT</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv211addFirstRowP21ReconstructInitSIRENAPP8fitsfilediP10gsl_vectorP10gsl_vectorP10gsl_matrixP10gsl_matrixP10gsl_matrixP10gsl_matrixP10gsl_matrixP10gsl_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function writes the first row of the library (without intermediate AB-related values, because it would be necessary to have at least two rows=energies in the library). It also writes the <strong>FIXFILTT</strong> and <strong>FIXFILTF</strong> HDUs with the optimal filters in the time and frequency domain (real and imag parts) with fixed legnth.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N11addFirstRow16reconstruct_initE">
<span id="addFirstRow::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N11addFirstRow16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses
<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> and the noise_spectrum in order to run <a class="reference internal" href="#_CPPv222calculus_optimalFilteriiiP10gsl_vectorldiP10gsl_vectorP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPP18gsl_vector_complex" title="calculus_optimalFilter"><code class="xref cpp cpp-func docutils literal"><span class="pre">calculus_optimalFilter()</span></code></a>.</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11addFirstRow11inLibObjectE">
<span id="addFirstRow::inLibObject__fitsfilePP"></span>fitsfile **<code class="descclassname"></code><code class="descname">inLibObject</code><a class="headerlink" href="#_CPPv2N11addFirstRow11inLibObjectE" title="Permalink to this definition">¶</a></dt>
<dd><p>FITS object containing information of the library FITS file</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11addFirstRow8samprateE">
<span id="addFirstRow::samprate__double"></span>double <code class="descclassname"></code><code class="descname">samprate</code><a class="headerlink" href="#_CPPv2N11addFirstRow8samprateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11addFirstRow12runF0orB0valE">
<span id="addFirstRow::runF0orB0val__i"></span>int <code class="descclassname"></code><code class="descname">runF0orB0val</code><a class="headerlink" href="#_CPPv2N11addFirstRow12runF0orB0valE" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a> = <strong>F0</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N11addFirstRow12runF0orB0valE" title="addFirstRow::runF0orB0val"><code class="xref cpp cpp-member docutils literal"><span class="pre">runF0orB0val</span></code></a> = 1. If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a> = <strong>B0</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N11addFirstRow12runF0orB0valE" title="addFirstRow::runF0orB0val"><code class="xref cpp cpp-member docutils literal"><span class="pre">runF0orB0val</span></code></a> = 0</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11addFirstRow1EE">
<span id="addFirstRow::E__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">E</code><a class="headerlink" href="#_CPPv2N11addFirstRow1EE" title="Permalink to this definition">¶</a></dt>
<dd><p>First energy to be included in the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11addFirstRow7PHEIGHTE">
<span id="addFirstRow::PHEIGHT__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">PHEIGHT</code><a class="headerlink" href="#_CPPv2N11addFirstRow7PHEIGHTE" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulse height associated to the first energy to be included in the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11addFirstRow5PULSEE">
<span id="addFirstRow::PULSE__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">PULSE</code><a class="headerlink" href="#_CPPv2N11addFirstRow5PULSEE" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulse template associated to the first energy to be included in the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11addFirstRow7PULSEB0E">
<span id="addFirstRow::PULSEB0__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">PULSEB0</code><a class="headerlink" href="#_CPPv2N11addFirstRow7PULSEB0E" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulse template without baseline associated to the first energy to be included in the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11addFirstRow2MFE">
<span id="addFirstRow::MF__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">MF</code><a class="headerlink" href="#_CPPv2N11addFirstRow2MFE" title="Permalink to this definition">¶</a></dt>
<dd><p>Matched filter associated to the first energy to be included in the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11addFirstRow4MFB0E">
<span id="addFirstRow::MFB0__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">MFB0</code><a class="headerlink" href="#_CPPv2N11addFirstRow4MFB0E" title="Permalink to this definition">¶</a></dt>
<dd><p>Matched filter (baseline subtracted) associated to the first energy to be included in the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11addFirstRow5COVARE">
<span id="addFirstRow::COVAR__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">COVAR</code><a class="headerlink" href="#_CPPv2N11addFirstRow5COVARE" title="Permalink to this definition">¶</a></dt>
<dd><p>Covariance matrix associated to the first energy to be included in the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11addFirstRow6WEIGHTE">
<span id="addFirstRow::WEIGHT__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">WEIGHT</code><a class="headerlink" href="#_CPPv2N11addFirstRow6WEIGHTE" title="Permalink to this definition">¶</a></dt>
<dd><p>Weight matrix associated to the first energy to be included in the library</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv25aligndPP10gsl_vectorPP10gsl_vector">
<span id="align__double.gsl_vectorPP.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">align</code><span class="sig-paren">(</span>double <em>samprate</em>, gsl_vector **<em>vector1</em>, gsl_vector **<em>vector2</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv25aligndPP10gsl_vectorPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>Based on <a class="reference internal" href="zreferences.html#gilpita2005" id="id1">[GilPita+05]</a></p>
<p>This function aligns <a class="reference internal" href="#_CPPv2N5align7vector1E" title="align::vector1"><code class="xref cpp cpp-member docutils literal"><span class="pre">vector1</span></code></a> with <a class="reference internal" href="#_CPPv2N5align7vector2E" title="align::vector2"><code class="xref cpp cpp-member docutils literal"><span class="pre">vector2</span></code></a> (by delaying or moving forward <a class="reference internal" href="#_CPPv2N5align7vector2E" title="align::vector2"><code class="xref cpp cpp-member docutils literal"><span class="pre">vector2</span></code></a>) assuming that <a class="reference internal" href="#_CPPv2N5align7vector1E" title="align::vector1"><code class="xref cpp cpp-member docutils literal"><span class="pre">vector1</span></code></a> and <a class="reference internal" href="#_CPPv2N5align7vector2E" title="align::vector2"><code class="xref cpp cpp-member docutils literal"><span class="pre">vector2</span></code></a> are shifted replicas of the same function.</p>
<p>From the discrete function <img class="math" src="_images/math/b47bffc8d5be7382662512ccd20c62dd96cccfb8.png" alt="x[n] (n=0,...,N-1,N)"/> and according to the time shifting property of the Fourier transform:</p>
<div class="math">
<p><img src="_images/math/b610711d9cfdca7ebf50cca7ecb9cfc2751b68cb.png" alt="&amp; x[n]    &lt;------&gt; X[f]\\
&amp; x[n-m]  &lt;------&gt; X[f] exp(-j2\cdot\pi\cdot m/N)"/></p>
</div><p>If <img class="math" src="_images/math/c21adf3b32f8b8d5ad059d19ca0a8e8ffcd28fd1.png" alt="\mathit{Shift} = m"/> then <img class="math" src="_images/math/3a881db199e0cd1be4b8e7466880428cb162bb6a.png" alt="\mathit{PhaseDueToTheShift}= 2\pi m/N"/> and thus, <img class="math" src="_images/math/45b3096cf4ca238823b4b3f0eba926f1fc52016f.png" alt="m = \mathit{PhaseDueToTheShift}\cdot N/(2\pi)"/></p>
<ol class="arabic simple">
<li>Declare variables</li>
<li>FFT of <a class="reference internal" href="#_CPPv2N5align7vector1E" title="align::vector1"><code class="xref cpp cpp-member docutils literal"><span class="pre">vector1</span></code></a></li>
<li>FFT of <a class="reference internal" href="#_CPPv2N5align7vector2E" title="align::vector2"><code class="xref cpp cpp-member docutils literal"><span class="pre">vector2</span></code></a></li>
<li>(Phases of the <em>FFT_vector1</em> and <em>FFT_vector2</em>) <img class="math" src="_images/math/8aeb7edc6ad4ddcb1104ffc74df863d7db51b86d.png" alt="*size/(2\pi)"/></li>
<li>Shift between the input vectors</li>
<li><em>shiftdouble</em> into <em>shiftint</em> (because we are working with samples)</li>
<li>Move forward or delay <a class="reference internal" href="#_CPPv2N5align7vector1E" title="align::vector1"><code class="xref cpp cpp-member docutils literal"><span class="pre">vector1</span></code></a> depending on positive or negative shift</li>
</ol>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N5align8samprateE">
<span id="align::samprate__double"></span>double <code class="descclassname"></code><code class="descname">samprate</code><a class="headerlink" href="#_CPPv2N5align8samprateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N5align7vector1E">
<span id="align::vector1__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">vector1</code><a class="headerlink" href="#_CPPv2N5align7vector1E" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with input vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N5align7vector2E">
<span id="align::vector2__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">vector2</code><a class="headerlink" href="#_CPPv2N5align7vector2E" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL with input vector which is delayed or moved forward to be aligned with <a class="reference internal" href="#_CPPv2N5align7vector1E" title="align::vector1"><code class="xref cpp cpp-member docutils literal"><span class="pre">vector1</span></code></a></p>
</dd></dl>

</dd></dl>

<span class="target" id="c"><span id="b"></span></span><dl class="function">
<dt id="_CPPv215calculateEnergyP10gsl_vectoriP10gsl_vectorP18gsl_vector_complexiiiP21ReconstructInitSIRENAidP10gsl_vectorP10gsl_matrixPd">
<span id="calculateEnergy__gsl_vectorP.i.gsl_vectorP.gsl_vector_complexP.i.i.i.ReconstructInitSIRENAP.i.double.gsl_vectorP.gsl_matrixP.doubleP"></span>int <code class="descclassname"></code><code class="descname">calculateEnergy</code><span class="sig-paren">(</span>gsl_vector *<em>vector</em>, int <em>pulseGrade</em>, gsl_vector *<em>filter</em>, gsl_vector_complex *<em>filterFFT</em>, int <em>runEMethod</em>, int <em>indexEalpha</em>, int <em>indexEbeta</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, int <em>domain</em>, double <em>samprate</em>, gsl_vector *<em>Pab</em>, gsl_matrix *<em>PRCLWN</em>, double *<em>calculatedEnergy</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv215calculateEnergyP10gsl_vectoriP10gsl_vectorP18gsl_vector_complexiiiP21ReconstructInitSIRENAidP10gsl_vectorP10gsl_matrixPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function calculates the energy of a pulse (<a class="reference internal" href="#_CPPv2N15calculateEnergy6vectorE" title="calculateEnergy::vector"><code class="xref cpp cpp-member docutils literal"><span class="pre">vector</span></code></a>) depending on the <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> and the <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterDomain"><code class="xref std std-option docutils literal"><span class="pre">FilterDomain</span></code></a>
selected from input parameters.</p>
<ol class="loweralpha simple">
<li><strong>OPTFILT</strong> (= <strong>I2R</strong> or <strong>I2RALL</strong>, <strong>I2RNOL</strong> or <strong>I2RFITTED</strong>): Optimal filter = Wiener filter  (see <a class="reference internal" href="SIRENA.html#optimalfilter"><span class="std std-ref">Optimal Filtering</span></a>)</li>
</ol>
<p>Once the filter template has been created (<a class="reference internal" href="#_CPPv2N15calculateEnergy6filterE" title="calculateEnergy::filter"><code class="xref cpp cpp-member docutils literal"><span class="pre">filter</span></code></a> or <a class="reference internal" href="#_CPPv2N15calculateEnergy9filterFFTE" title="calculateEnergy::filterFFT"><code class="xref cpp cpp-member docutils literal"><span class="pre">filterFFT</span></code></a>), pulse height analysis is performed by aligning the template
with a pulse and multiplying each point in the template by the corresponding point in the pulse. The sum of these products is the energy.</p>
<p>In the practice, the alignment of the pulse relative to the trigger is not completely accurate, so a number of <em>n</em> lags could be used in order to find
the peak value of the energy. The <em>n</em> peak values are fitted to a parabola to find the most accurate energy (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LagsOrNot"><code class="xref std std-option docutils literal"><span class="pre">LagsOrNot</span></code></a>).</p>
<ol class="loweralpha simple" start="2">
<li><strong>WEIGHT</strong> and <strong>WEIGHTN</strong> (see <a class="reference internal" href="SIRENA.html#covmatrices"><span class="std std-ref">Covariance matrices</span></a>)</li>
</ol>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N15calculateEnergy6vectorE">
<span id="calculateEnergy::vector__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">vector</code><a class="headerlink" href="#_CPPv2N15calculateEnergy6vectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulse whose energy has to be determined</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy10pulseGradeE">
<span id="calculateEnergy::pulseGrade__i"></span>int <code class="descclassname"></code><code class="descname">pulseGrade</code><a class="headerlink" href="#_CPPv2N15calculateEnergy10pulseGradeE" title="Permalink to this definition">¶</a></dt>
<dd><p>Grade of the input pulse (to decide whether a full or only a rough estimation of energy is required). If <a class="reference internal" href="#_CPPv2N15calculateEnergy10pulseGradeE" title="calculateEnergy::pulseGrade"><code class="xref cpp cpp-member docutils literal"><span class="pre">pulseGrade</span></code></a> =-1 (rejected) the provided calculated energy is -1</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy6filterE">
<span id="calculateEnergy::filter__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">filter</code><a class="headerlink" href="#_CPPv2N15calculateEnergy6filterE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal filter in time domain</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy9filterFFTE">
<span id="calculateEnergy::filterFFT__gsl_vector_complexP"></span>gsl_vector_complex *<code class="descclassname"></code><code class="descname">filterFFT</code><a class="headerlink" href="#_CPPv2N15calculateEnergy9filterFFTE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal filter in frequency domain</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy10runEMethodE">
<span id="calculateEnergy::runEMethod__i"></span>int <code class="descclassname"></code><code class="descname">runEMethod</code><a class="headerlink" href="#_CPPv2N15calculateEnergy10runEMethodE" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li><a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>OPTFILT</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N15calculateEnergy10runEMethodE" title="calculateEnergy::runEMethod"><code class="xref cpp cpp-member docutils literal"><span class="pre">runEMethod</span></code></a> = 0</li>
<li><a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>I2R</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N15calculateEnergy10runEMethodE" title="calculateEnergy::runEMethod"><code class="xref cpp cpp-member docutils literal"><span class="pre">runEMethod</span></code></a> = 0</li>
<li><a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>I2RALL</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N15calculateEnergy10runEMethodE" title="calculateEnergy::runEMethod"><code class="xref cpp cpp-member docutils literal"><span class="pre">runEMethod</span></code></a> = 0</li>
<li><a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>I2RNOL</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N15calculateEnergy10runEMethodE" title="calculateEnergy::runEMethod"><code class="xref cpp cpp-member docutils literal"><span class="pre">runEMethod</span></code></a> = 0</li>
<li><a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>I2RFITTED</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N15calculateEnergy10runEMethodE" title="calculateEnergy::runEMethod"><code class="xref cpp cpp-member docutils literal"><span class="pre">runEMethod</span></code></a> = 0</li>
<li><a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>WEIGHT</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N15calculateEnergy10runEMethodE" title="calculateEnergy::runEMethod"><code class="xref cpp cpp-member docutils literal"><span class="pre">runEMethod</span></code></a> = 1</li>
<li><a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>WEIGHTN</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N15calculateEnergy10runEMethodE" title="calculateEnergy::runEMethod"><code class="xref cpp cpp-member docutils literal"><span class="pre">runEMethod</span></code></a> = 2</li>
</ul>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy11indexEalphaE">
<span id="calculateEnergy::indexEalpha__i"></span>int <code class="descclassname"></code><code class="descname">indexEalpha</code><a class="headerlink" href="#_CPPv2N15calculateEnergy11indexEalphaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the energy lower than the energy of the pulse which is being analyzed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy10indexEbetaE">
<span id="calculateEnergy::indexEbeta__i"></span>int <code class="descclassname"></code><code class="descname">indexEbeta</code><a class="headerlink" href="#_CPPv2N15calculateEnergy10indexEbetaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the energy higher than the energy of the pulse which is being analyzed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy16reconstruct_initE">
<span id="calculateEnergy::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N15calculateEnergy16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy6domainE">
<span id="calculateEnergy::domain__i"></span>int <code class="descclassname"></code><code class="descname">domain</code><a class="headerlink" href="#_CPPv2N15calculateEnergy6domainE" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li><a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterDomain"><code class="xref std std-option docutils literal"><span class="pre">FilterDomain</span></code></a> = <strong>T</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N15calculateEnergy6domainE" title="calculateEnergy::domain"><code class="xref cpp cpp-member docutils literal"><span class="pre">domain</span></code></a> = 0</li>
<li><a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterDomain"><code class="xref std std-option docutils literal"><span class="pre">FilterDomain</span></code></a> = <strong>F</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N15calculateEnergy6domainE" title="calculateEnergy::domain"><code class="xref cpp cpp-member docutils literal"><span class="pre">domain</span></code></a> = 1</li>
</ul>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy7nrmfctrE">
<span id="calculateEnergy::nrmfctr__double"></span>double <code class="descclassname"></code><code class="descname">nrmfctr</code><a class="headerlink" href="#_CPPv2N15calculateEnergy7nrmfctrE" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalization factor to make the estimation of <em>E</em> in units of energy</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy8samprateE">
<span id="calculateEnergy::samprate__double"></span>double <code class="descclassname"></code><code class="descname">samprate</code><a class="headerlink" href="#_CPPv2N15calculateEnergy8samprateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate in Hz</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy3PabE">
<span id="calculateEnergy::Pab__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">Pab</code><a class="headerlink" href="#_CPPv2N15calculateEnergy3PabE" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>PAB</strong> column in the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy6PRCLWNE">
<span id="calculateEnergy::PRCLWN__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">PRCLWN</code><a class="headerlink" href="#_CPPv2N15calculateEnergy6PRCLWNE" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>PRCLx</strong> column in the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15calculateEnergy16calculatedEnergyE">
<span id="calculateEnergy::calculatedEnergy__doubleP"></span>double *<code class="descclassname"></code><code class="descname">calculatedEnergy</code><a class="headerlink" href="#_CPPv2N15calculateEnergy16calculatedEnergyE" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculated energy in eV.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv218calculateIntParamsP21ReconstructInitSIRENAiidiP10gsl_matrixP10gsl_matrixP10gsl_matrixP10gsl_vectorPP10gsl_matrixPP10gsl_matrixPP10gsl_vectorPP10gsl_matrixPP10gsl_matrixPP10gsl_matrixPP10gsl_vectorPP10gsl_matrixPP10gsl_matrixPP10gsl_matrixPP10gsl_matrixPP10gsl_matrix">
<span id="calculateIntParams__ReconstructInitSIRENAP.i.i.double.i.gsl_matrixP.gsl_matrixP.gsl_matrixP.gsl_vectorP.gsl_matrixPP.gsl_matrixPP.gsl_vectorPP.gsl_matrixPP.gsl_matrixPP.gsl_matrixPP.gsl_vectorPP.gsl_matrixPP.gsl_matrixPP.gsl_matrixPP.gsl_matrixPP.gsl_matrixPP"></span>int <code class="descclassname"></code><code class="descname">calculateIntParams</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em>, int <em>indexa</em>, int <em>indexb</em>, double <em>samprate</em>, int <em>runF0orB0val</em>, gsl_matrix *<em>modelsaux</em>, gsl_matrix *<em>covarianceaux</em>, gsl_matrix *<em>weightaux</em>, gsl_vector *<em>energycolumn</em>, gsl_matrix **<em>Wabaux</em>, gsl_matrix **<em>TVaux</em>, gsl_vector **<em>tEcolumn</em>, gsl_matrix **<em>XMaux</em>, gsl_matrix **<em>YVaux</em>, gsl_matrix **<em>ZVaux</em>, gsl_vector **<em>rEcolumn</em>, gsl_matrix **<em>Pabaux</em>, gsl_matrix **<em>Dabaux</em>, gsl_matrix **<em>PrecalWMaux</em>, gsl_matrix **<em>optimalfiltersabFREQaux</em>, gsl_matrix **<em>optimalfiltersabTIMEaux</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv218calculateIntParamsP21ReconstructInitSIRENAiidiP10gsl_matrixP10gsl_matrixP10gsl_matrixP10gsl_vectorPP10gsl_matrixPP10gsl_matrixPP10gsl_vectorPP10gsl_matrixPP10gsl_matrixPP10gsl_matrixPP10gsl_vectorPP10gsl_matrixPP10gsl_matrixPP10gsl_matrixPP10gsl_matrixPP10gsl_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function calculates some intermediate scalars, vectors and matrices (WAB, TV, tE, XM, YV, ZV, rE, PAB and DAB) for the interpolation and covariance methods. See <a class="reference internal" href="SIRENA.html#covmatrices"><span class="std std-ref">Covariance matrices</span></a> reconstruction method.</p>
<ul class="simple">
<li>Declare variables and allocate GSL vectors and matrices</li>
<li>Calculate intermediate scalars, vectors and matrices</li>
<li>Free allocated GSL vectors and matrices</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N18calculateIntParams16reconstruct_initE">
<span id="calculateIntParams::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N18calculateIntParams16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function
uses <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-PulseLength"><code class="xref std std-option docutils literal"><span class="pre">PulseLength</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams6indexaE">
<span id="calculateIntParams::indexa__i"></span>int <code class="descclassname"></code><code class="descname">indexa</code><a class="headerlink" href="#_CPPv2N18calculateIntParams6indexaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower index of the library to calculate the intermediate params (<img class="math" src="_images/math/877d234f4cec6974ce218fc2e975a486a7972dfd.png" alt="\alpha"/>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams6indexbE">
<span id="calculateIntParams::indexb__i"></span>int <code class="descclassname"></code><code class="descname">indexb</code><a class="headerlink" href="#_CPPv2N18calculateIntParams6indexbE" title="Permalink to this definition">¶</a></dt>
<dd><p>Higher index of the library to calculate the intermediate params (<img class="math" src="_images/math/410a9d0df9c135dd73b269cba7ef04dcfd932b1f.png" alt="\beta"/>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams8samprateE">
<span id="calculateIntParams::samprate__double"></span>double <code class="descclassname"></code><code class="descname">samprate</code><a class="headerlink" href="#_CPPv2N18calculateIntParams8samprateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams12runF0orB0valE">
<span id="calculateIntParams::runF0orB0val__i"></span>int <code class="descclassname"></code><code class="descname">runF0orB0val</code><a class="headerlink" href="#_CPPv2N18calculateIntParams12runF0orB0valE" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a> = <strong>F0</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N18calculateIntParams12runF0orB0valE" title="calculateIntParams::runF0orB0val"><code class="xref cpp cpp-member docutils literal"><span class="pre">runF0orB0val</span></code></a> = 1. If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a> = <strong>B0</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N18calculateIntParams12runF0orB0valE" title="calculateIntParams::runF0orB0val"><code class="xref cpp cpp-member docutils literal"><span class="pre">runF0orB0val</span></code></a> = 0</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams9modelsauxE">
<span id="calculateIntParams::modelsaux__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">modelsaux</code><a class="headerlink" href="#_CPPv2N18calculateIntParams9modelsauxE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL input matrix with model template</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams13covarianceauxE">
<span id="calculateIntParams::covarianceaux__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">covarianceaux</code><a class="headerlink" href="#_CPPv2N18calculateIntParams13covarianceauxE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL input matrix with weight matrix</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams9weightauxE">
<span id="calculateIntParams::weightaux__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">weightaux</code><a class="headerlink" href="#_CPPv2N18calculateIntParams9weightauxE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL input matrix with weight matrix</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams12energycolumnE">
<span id="calculateIntParams::energycolumn__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">energycolumn</code><a class="headerlink" href="#_CPPv2N18calculateIntParams12energycolumnE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL input vector with list of energies</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams3WABE">
<span id="calculateIntParams::WAB__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">WAB</code><a class="headerlink" href="#_CPPv2N18calculateIntParams3WABE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output intermediate parameter</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams5TVauxE">
<span id="calculateIntParams::TVaux__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">TVaux</code><a class="headerlink" href="#_CPPv2N18calculateIntParams5TVauxE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output intermediate parameter</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams8tEcolumnE">
<span id="calculateIntParams::tEcolumn__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">tEcolumn</code><a class="headerlink" href="#_CPPv2N18calculateIntParams8tEcolumnE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output intermediate parameter</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams5XMauxE">
<span id="calculateIntParams::XMaux__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">XMaux</code><a class="headerlink" href="#_CPPv2N18calculateIntParams5XMauxE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output intermediate parameter</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams5YVauxE">
<span id="calculateIntParams::YVaux__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">YVaux</code><a class="headerlink" href="#_CPPv2N18calculateIntParams5YVauxE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output intermediate parameter</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams5ZVauxE">
<span id="calculateIntParams::ZVaux__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">ZVaux</code><a class="headerlink" href="#_CPPv2N18calculateIntParams5ZVauxE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output intermediate parameter</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams8rEcolumnE">
<span id="calculateIntParams::rEcolumn__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">rEcolumn</code><a class="headerlink" href="#_CPPv2N18calculateIntParams8rEcolumnE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output intermediate parameter</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams6PabauxE">
<span id="calculateIntParams::Pabaux__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">Pabaux</code><a class="headerlink" href="#_CPPv2N18calculateIntParams6PabauxE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output intermediate parameter</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams6DabauxE">
<span id="calculateIntParams::Dabaux__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">Dabaux</code><a class="headerlink" href="#_CPPv2N18calculateIntParams6DabauxE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output intermediate parameter</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams11precalWMauxE">
<span id="calculateIntParams::precalWMaux__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">precalWMaux</code><a class="headerlink" href="#_CPPv2N18calculateIntParams11precalWMauxE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output intermediate parameter</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams23optimalfiltersabFREQauxE">
<span id="calculateIntParams::optimalfiltersabFREQaux__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">optimalfiltersabFREQaux</code><a class="headerlink" href="#_CPPv2N18calculateIntParams23optimalfiltersabFREQauxE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output intermediate parameter</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18calculateIntParams23optimalfiltersabTIMEauxE">
<span id="calculateIntParams::optimalfiltersabTIMEaux__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">optimalfiltersabTIMEaux</code><a class="headerlink" href="#_CPPv2N18calculateIntParams23optimalfiltersabTIMEauxE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output intermediate parameter</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv217calculateTemplateP21ReconstructInitSIRENAP16PulsesCollectionP16PulsesCollectiondPP10gsl_vectorPdPP10gsl_matrixPP10gsl_matrix">
<span id="calculateTemplate__ReconstructInitSIRENAP.PulsesCollectionP.PulsesCollectionP.double.gsl_vectorPP.doubleP.gsl_matrixPP.gsl_matrixPP"></span>int <code class="descclassname"></code><code class="descname">calculateTemplate</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em>, PulsesCollection *<em>pulsesAll</em>, PulsesCollection *<em>pulsesInRecord</em>, double <em>samprate</em>, gsl_vector **<em>pulseaverage</em>, double *<em>pulseaverageHeight</em>, gsl_matrix **<em>covariance</em>, gsl_matrix **<em>weight</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv217calculateTemplateP21ReconstructInitSIRENAP16PulsesCollectionP16PulsesCollectiondPP10gsl_vectorPdPP10gsl_matrixPP10gsl_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function calculates the template (<strong>PULSE</strong> column in the library) of non piled-up pulses.
Just in case in the detection process some piled-up pulses have not been distinguished as different pulses, a pulseheights histogram is built. It uses the pulseheights histogram (built by using the <strong>PHEIGHT</strong> column of the library), <strong>Tstart</strong> and <strong>quality</strong> to select the non piled-up pulses.</p>
<ol class="arabic">
<li><p class="first">Declare and initialize variables</p>
</li>
<li><p class="first">Before building the histogram, select the pulseheights of the pulses well separated from other pulses and with <em>quality</em> = 0</p>
</li>
<li><p class="first">Create the pulseheights histogram</p>
</li>
<li><p class="first">Calculate the pulseaverage only taking into account the valid pulses:</p>
<blockquote>
<div><ul class="simple">
<li>Check if the pulse is piled-up or not</li>
<li>Non piled-up pulses <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Align and average them (currently <a class="reference internal" href="#_CPPv25aligndPP10gsl_vectorPP10gsl_vector" title="align"><code class="xref cpp cpp-func docutils literal"><span class="pre">align()</span></code></a> is not used because the starting times of the pulses are provided as input parameter)</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Calculate covariance and weight matrices</p>
</li>
<li><p class="first">Free allocated GSL vectors</p>
</li>
</ol>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N17calculateTemplate16reconstruct_initE">
<span id="calculateTemplate::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N17calculateTemplate16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values).  In particular, this function uses <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-PulseLength"><code class="xref std std-option docutils literal"><span class="pre">PulseLength</span></code></a> and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17calculateTemplate9pulsesAllE">
<span id="calculateTemplate::pulsesAll__PulsesCollectionP"></span>PulsesCollection *<code class="descclassname"></code><code class="descname">pulsesAll</code><a class="headerlink" href="#_CPPv2N17calculateTemplate9pulsesAllE" title="Permalink to this definition">¶</a></dt>
<dd><p>Collection of pulses found in the previous records</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17calculateTemplate14pulsesInRecordE">
<span id="calculateTemplate::pulsesInRecord__PulsesCollectionP"></span>PulsesCollection *<code class="descclassname"></code><code class="descname">pulsesInRecord</code><a class="headerlink" href="#_CPPv2N17calculateTemplate14pulsesInRecordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Collection of pulses found in the current record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17calculateTemplate12pulseaverageE">
<span id="calculateTemplate::pulseaverage__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">pulseaverage</code><a class="headerlink" href="#_CPPv2N17calculateTemplate12pulseaverageE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the pulseaverage (template) of the non piled-up pulses</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17calculateTemplate18pulseaverageHeightE">
<span id="calculateTemplate::pulseaverageHeight__doubleP"></span>double *<code class="descclassname"></code><code class="descname">pulseaverageHeight</code><a class="headerlink" href="#_CPPv2N17calculateTemplate18pulseaverageHeightE" title="Permalink to this definition">¶</a></dt>
<dd><p>Height value of the pulseaverage</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17calculateTemplate10covarianceE">
<span id="calculateTemplate::covariance__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">covariance</code><a class="headerlink" href="#_CPPv2N17calculateTemplate10covarianceE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL matrix with covariance matrix</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17calculateTemplate6weightE">
<span id="calculateTemplate::weight__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">weight</code><a class="headerlink" href="#_CPPv2N17calculateTemplate6weightE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL matrix with weight matrix (inverse of covariance matrix)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv222calculus_optimalFilteriiiP10gsl_vectorldiP10gsl_vectorP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPP18gsl_vector_complex">
<span id="calculus_optimalFilter__i.i.i.gsl_vectorP.l.double.i.gsl_vectorP.gsl_vectorP.gsl_vectorPP.gsl_vectorPP.gsl_vectorPP.gsl_vector_complexPP"></span>int <code class="descclassname"></code><code class="descname">calculus_optimalFilter</code><span class="sig-paren">(</span>int <em>TorF</em>, int <em>intermediate</em>, int <em>mode</em>, gsl_vector *<em>matchedfiltergsl</em>, long <em>mf_size</em>, double <em>samprate</em>, int <em>runF0orB0val</em>, gsl_vector *<em>freqgsl</em>, gsl_vector *<em>csdgsl</em>, gsl_vector **<em>optimal_filtergsl</em>, gsl_vector **<em>of_f</em>, gsl_vector **<em>of_FFT</em>, gsl_vector_complex **<em>of_FFT_complex</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv222calculus_optimalFilteriiiP10gsl_vectorldiP10gsl_vectorP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPP18gsl_vector_complex" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>See description also at <a class="reference internal" href="SIRENA.html#optimalfilter"><span class="std std-ref">optimal filter chapter</span></a></p>
<p>This function calculates the optimal filter for a pulse whose matched filter (normalized template) is provided as input
parameter, <a class="reference internal" href="#_CPPv2N22calculus_optimalFilter16matchedfiltergslE" title="calculus_optimalFilter::matchedfiltergsl"><code class="xref cpp cpp-member docutils literal"><span class="pre">matchedfiltergsl</span></code></a>. An optimal filter is just a matched filter that has been adjusted based on the
noise spectrum of the system.</p>
<p>It is assumed that all pulses are scaled versions of a template. In the frequency domain (as noise can be frequency dependent), the raw data
can be expressed as <img class="math" src="_images/math/94be4491ca020fdee74bd3fcfedac42054eff7f7.png" alt="P(f)=E\cdot S(f)+N(f)"/>, where <img class="math" src="_images/math/b2f67a4faf74e9acbc6c0ffb7048e3f413ec8ef7.png" alt="S(f)"/> is the normalized model pulse shape in the frequency domain,
<img class="math" src="_images/math/1472d8c90c81821f3b7388c17905e5aa7a8ae6db.png" alt="N(f)"/> is the power spectrum of the noise and <img class="math" src="_images/math/4b6222b865b812d2a59368cd1629eed6b54454d5.png" alt="E"/> is the scalar amplitude for the photon energy.</p>
<p>The second assumption is that the noise is stationary, i.e., it does not vary with time. The amplitude of each pulse can then be estimated by
minimizing (weighted least-squares sense) the difference between the noisy data and the model pulse shape, being the <img class="math" src="_images/math/b0a677c7b64a9ce46bca897eabaf2af1c84de1a5.png" alt="\chi^2"/> condition
to be minimized:</p>
<div class="math">
<p><img src="_images/math/d876505e8663e64465cf3e96b284801c216dbc78.png" alt="\chi^2 = \int \frac{(P(f)-E \cdot S(f))^2}{\langle\lvert N(f)\lvert ^2\rangle} df"/></p>
</div><p>In the time domain, the amplitude is the best weighted (optimally filtered) sum of the values in the pulse</p>
<div class="math">
<p><img src="_images/math/63b63249f56333ac83006f27d4a429e7e981db25.png" alt="E = k \int p(t)\cdot of(t)"/></p>
</div><p>where <img class="math" src="_images/math/92c6bf2a925060f6d31bba670dbfbbca9a601153.png" alt="of(t)"/> is the time domain expression of optimal filter which in frequency domain</p>
<div class="math">
<p><img src="_images/math/2ea70a8acefdfcdb475b00eb0f91c9e24491be3e.png" alt="OF(f) = \frac{S^*(f)}{\langle\lvert N(f)\lvert ^2\rangle}"/></p>
</div><p>and <img class="math" src="_images/math/0b7c1e16a3a8a849bb8ffdcdbf86f65fd1f30438.png" alt="k"/> is the normalization factor to give <img class="math" src="_images/math/4b6222b865b812d2a59368cd1629eed6b54454d5.png" alt="E"/> in units of energy</p>
<div class="math">
<p><img src="_images/math/4cc2b936d06d51f76d03b94baa896d0ddfb7799b.png" alt="k = \int \frac{S(f)\cdot S^{*}(f)}{\langle\lvert N(f)\lvert ^2\rangle} df"/></p>
</div><p>Steps:</p>
<ul>
<li><p class="first">FFT calculus of the matched filter (normalized template)</p>
<blockquote>
<div><ul class="simple">
<li>Declare variables</li>
<li>Complex FFT values for positive and negative frequencies</li>
<li>FFT calculus</li>
<li>Generation of the frequencies (positive and negative)</li>
<li>Magnitude and argument for positive and negative frequencies</li>
<li>Free allocated GSL vectors</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><img class="math" src="_images/math/1472d8c90c81821f3b7388c17905e5aa7a8ae6db.png" alt="N(f)"/></p>
</li>
<li><p class="first">To divide <img class="math" src="_images/math/396091b9e405050ba5000c44bc40f1866db7813e.png" alt="MatchedFilter(f)/N^2(f)"/> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <img class="math" src="_images/math/c921ea585d43f4817b4fa39f759b1f6513b83797.png" alt="MatchedFilter(f)"/> and <img class="math" src="_images/math/1472d8c90c81821f3b7388c17905e5aa7a8ae6db.png" alt="N(f)"/> must have the same number of points</p>
<blockquote>
<div><ul>
<li><p class="first"><em>if</em> (<a class="reference internal" href="#_CPPv2N22calculus_optimalFilter7mf_sizeE" title="calculus_optimalFilter::mf_size"><code class="xref cpp cpp-member docutils literal"><span class="pre">mf_size</span></code></a> &lt; <em>freqgsl-&gt;size</em>)</p>
<blockquote>
<div><ul class="simple">
<li><em>if</em> ((<em>freqgsl-&gt;size)%mf_size</em> == 0) <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Decimate noise samples</li>
<li><em>else</em> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> It is necessary to work only with the positive frequencies so as not to handle the <img class="math" src="_images/math/ae09f91435e422917ae67f4e29733a7645dabf1b.png" alt="f=0"/> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <img class="math" src="_images/math/1472d8c90c81821f3b7388c17905e5aa7a8ae6db.png" alt="N(f)"/> interpolation (<a class="reference internal" href="#_CPPv214interpolatePOSP10gsl_vectorP10gsl_vectorldPP10gsl_vectorPP10gsl_vector" title="interpolatePOS"><code class="xref cpp cpp-func docutils literal"><span class="pre">interpolatePOS()</span></code></a>)</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><em>else if</em> (<a class="reference internal" href="#_CPPv2N22calculus_optimalFilter7mf_sizeE" title="calculus_optimalFilter::mf_size"><code class="xref cpp cpp-member docutils literal"><span class="pre">mf_size</span></code></a> &gt; <em>freqgsl-&gt;size</em>) <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Error: Noise spectrum must have more samples than pulse spectrum</p>
</li>
<li><p class="first"><em>else if</em> (<a class="reference internal" href="#_CPPv2N22calculus_optimalFilter7mf_sizeE" title="calculus_optimalFilter::mf_size"><code class="xref cpp cpp-member docutils literal"><span class="pre">mf_size</span></code></a> == <em>freqgsl-&gt;size</em>) <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> It is not necessary to do anything</p>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><img class="math" src="_images/math/ca8c79b48ffc910386c476d7d2491e6cbc79f1e2.png" alt="OptimalFilter = MatchedFilter'(f)/N^2(f)"/></p>
</li>
<li><p class="first">Calculus of the normalization factor</p>
</li>
<li><p class="first">Inverse FFT (to get the expression of the optimal filter in time domain)</p>
<blockquote>
<div><ul class="simple">
<li>Complex <img class="math" src="_images/math/4a1a91d04d6c20738fab347a4dd0e0446d72cde2.png" alt="OptimalFilter(f)"/> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Taking into account magnitude <img class="math" src="_images/math/396091b9e405050ba5000c44bc40f1866db7813e.png" alt="MatchedFilter(f)/N^2(f)"/> and phase given by <img class="math" src="_images/math/c921ea585d43f4817b4fa39f759b1f6513b83797.png" alt="MatchedFilter(f)"/></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Free allocated GSL vectors</p>
</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter4TorFE">
<span id="calculus_optimalFilter::TorF__i"></span>int <code class="descclassname"></code><code class="descname">TorF</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter4TorFE" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterDomain"><code class="xref std std-option docutils literal"><span class="pre">FilterDomain</span></code></a> = <strong>T</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N22calculus_optimalFilter4TorFE" title="calculus_optimalFilter::TorF"><code class="xref cpp cpp-member docutils literal"><span class="pre">TorF</span></code></a> = 0; If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterDomain"><code class="xref std std-option docutils literal"><span class="pre">FilterDomain</span></code></a> = <strong>F</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N22calculus_optimalFilter4TorFE" title="calculus_optimalFilter::TorF"><code class="xref cpp cpp-member docutils literal"><span class="pre">TorF</span></code></a> = 1</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter12intermediateE">
<span id="calculus_optimalFilter::intermediate__i"></span>int <code class="descclassname"></code><code class="descname">intermediate</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter12intermediateE" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-intermediate"><code class="xref std std-option docutils literal"><span class="pre">intermediate</span></code></a> = 0 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Do not write an intermediate file; If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-intermediate"><code class="xref std std-option docutils literal"><span class="pre">intermediate</span></code></a> = 1 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Write an intermediate file</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter4modeE">
<span id="calculus_optimalFilter::mode__i"></span>int <code class="descclassname"></code><code class="descname">mode</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter4modeE" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 0 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> CALIBRATION run (library creation); If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 1 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> RECONSTRUCTION run (energy determination)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter16matchedfiltergslE">
<span id="calculus_optimalFilter::matchedfiltergsl__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">matchedfiltergsl</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter16matchedfiltergslE" title="Permalink to this definition">¶</a></dt>
<dd><p>Matched filter associated to the pulse (in general, from the interpolation between two matched filters of the library)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter7mf_sizeE">
<span id="calculus_optimalFilter::mf_size__l"></span>long <code class="descclassname"></code><code class="descname">mf_size</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter7mf_sizeE" title="Permalink to this definition">¶</a></dt>
<dd><p>Matched filter size (samples)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter8samprateE">
<span id="calculus_optimalFilter::samprate__double"></span>double <code class="descclassname"></code><code class="descname">samprate</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter8samprateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter12runF0orB0valE">
<span id="calculus_optimalFilter::runF0orB0val__i"></span>int <code class="descclassname"></code><code class="descname">runF0orB0val</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter12runF0orB0valE" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a> = <strong>F0</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N22calculus_optimalFilter12runF0orB0valE" title="calculus_optimalFilter::runF0orB0val"><code class="xref cpp cpp-member docutils literal"><span class="pre">runF0orB0val</span></code></a> = 1. If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a> = <strong>B0</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N22calculus_optimalFilter12runF0orB0valE" title="calculus_optimalFilter::runF0orB0val"><code class="xref cpp cpp-member docutils literal"><span class="pre">runF0orB0val</span></code></a> = 0.</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter7freqgslE">
<span id="calculus_optimalFilter::freqgsl__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">freqgsl</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter7freqgslE" title="Permalink to this definition">¶</a></dt>
<dd><p>Frequency axis of the current noise spectral density (input)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter6csdgslE">
<span id="calculus_optimalFilter::csdgsl__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">csdgsl</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter6csdgslE" title="Permalink to this definition">¶</a></dt>
<dd><p>Current noise spectral density (input)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter17optimal_filtergslE">
<span id="calculus_optimalFilter::optimal_filtergsl__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">optimal_filtergsl</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter17optimal_filtergslE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal filter in time domain (output)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter4of_fE">
<span id="calculus_optimalFilter::of_f__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">of_f</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter4of_fE" title="Permalink to this definition">¶</a></dt>
<dd><p>Frequency axis of the optimal filter spectrum (output)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter6of_FFTE">
<span id="calculus_optimalFilter::of_FFT__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">of_FFT</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter6of_FFTE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal filter spectrum (absolute values) (output)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N22calculus_optimalFilter14of_FFT_complexE">
<span id="calculus_optimalFilter::of_FFT_complex__gsl_vector_complexPP"></span>gsl_vector_complex **<code class="descclassname"></code><code class="descname">of_FFT_complex</code><a class="headerlink" href="#_CPPv2N22calculus_optimalFilter14of_FFT_complexE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal filter spectrum (complex values) (output)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv210convertI2RPP21ReconstructInitSIRENAPP9TesRecordPP10gsl_vector">
<span id="convertI2R__ReconstructInitSIRENAPP.TesRecordPP.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">convertI2R</code><span class="sig-paren">(</span>ReconstructInitSIRENA **<em>reconstruct_init</em>, TesRecord **<em>record</em>, gsl_vector **<em>invector</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv210convertI2RPP21ReconstructInitSIRENAPP9TesRecordPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This funcion converts the current space into a quasi-resistance space (see <a class="reference internal" href="SIRENA.html#rspace"><span class="std std-ref">Quasi Resistance Space</span></a> for <strong>I2R</strong>, <strong>I2RALL</strong>, <strong>I2RNOL</strong> and <strong>I2RFITTED</strong> modes). The input <a class="reference internal" href="#_CPPv2N10convertI2R8invectorE" title="convertI2R::invector"><code class="xref cpp cpp-member docutils literal"><span class="pre">invector</span></code></a> filled in with current values is filled in here with <em>I2R</em>, <em>I2RALL</em>, <em>I2RNOL</em> or <strong>I2RFITTED</strong> quasi-resistances at the output.</p>
<ul class="simple">
<li>Read <code class="docutils literal"><span class="pre">R0</span></code>, <code class="docutils literal"><span class="pre">I0_START</span></code>, <code class="docutils literal"><span class="pre">ADUCNV</span></code> and <code class="docutils literal"><span class="pre">IMIN</span></code> from the <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-RecordFile"><code class="xref std std-option docutils literal"><span class="pre">RecordFile</span></code></a> by using the pointer <em>(*reconstruct_init)-&gt;record_file_fptr</em></li>
<li>Conversion according to <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>I2R</strong></li>
<li>Conversion according to <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>I2RALL</strong><ul>
<li>Read also <code class="docutils literal"><span class="pre">RL</span></code>, <code class="docutils literal"><span class="pre">LFILTER</span></code> and <code class="docutils literal"><span class="pre">TTR</span></code> from the <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-RecordFile"><code class="xref std std-option docutils literal"><span class="pre">RecordFile</span></code></a></li>
</ul>
</li>
<li>Conversion according to <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>I2RNOL</strong><ul>
<li><em>I2RALL</em> neglecting the circuit inductance</li>
</ul>
</li>
<li>Conversion according to <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>I2RFITTED</strong></li>
<li>Because in <a class="reference internal" href="#_CPPv29runEnergyP9TesRecordPP21ReconstructInitSIRENAPP16PulsesCollectionPP19OptimalFilterSIRENA" title="runEnergy"><code class="xref cpp cpp-func docutils literal"><span class="pre">runEnergy()</span></code></a> the record (<em>TesRecord</em> type) is used <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The <strong>I2R</strong>, <strong>I2RALL</strong>, <strong>I2RNOL</strong> or <strong>I2RFITTED</strong> transformed record has to be used</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N10convertI2R16reconstruct_initE">
<span id="convertI2R::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N10convertI2R16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10convertI2R6recordE">
<span id="convertI2R::record__TesRecordPP"></span>TesRecord **<code class="descclassname"></code><code class="descname">record</code><a class="headerlink" href="#_CPPv2N10convertI2R6recordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure containing the input ADC record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10convertI2R8invectorE">
<span id="convertI2R::invector__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">invector</code><a class="headerlink" href="#_CPPv2N10convertI2R8invectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input current (ADC) vector &amp; output resistance (<em>I2R</em> or <em>I2RALL</em> or <em>I2RNOL</em> or <em>I2RFITTED</em>) vector</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv216createDetectFileP21ReconstructInitSIRENAdPP8fitsfile">
<span id="createDetectFile__ReconstructInitSIRENAP.double.fitsfilePP"></span>int <code class="descclassname"></code><code class="descname">createDetectFile</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em>, double <em>samprate</em>, fitsfile **<em>dtcObject</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv216createDetectFileP21ReconstructInitSIRENAdPP8fitsfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function creates an intermediate FITS file with some useful info (during the development phase) if the <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-intermediate"><code class="xref std std-option docutils literal"><span class="pre">intermediate</span></code></a> input parameter is set to 1.</p>
<p>The intermediate FITS file will contain 2 HDUs:</p>
<blockquote>
<div><ul class="simple">
<li><strong>PULSES</strong> HDU will contain some info about the found pulses: <strong>TSTART</strong>, <strong>I0</strong> (the pulse itself), <strong>TEND</strong>, <strong>TAURISE</strong>, <strong>TAUFALL</strong> and <strong>QUALITY</strong></li>
<li><strong>TESTINFO</strong> HDU will contain columns <strong>FILDER</strong> (the low-pass filtered and differentiated records) and <strong>THRESHOLD</strong></li>
</ul>
</div></blockquote>
<p>If file exists <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Check <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-clobber"><code class="xref std std-option docutils literal"><span class="pre">clobber</span></code></a> for overwritting. If it does not, then create it.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N16createDetectFile16reconstruct_initE">
<span id="createDetectFile::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N16createDetectFile16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses some of its
values to call the intermediate file (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-detectFile"><code class="xref std std-option docutils literal"><span class="pre">detectFile</span></code></a>), to write input parameters info in the Primary extension of the intermediate file and also <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-clobber"><code class="xref std std-option docutils literal"><span class="pre">clobber</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N16createDetectFile8samprateE">
<span id="createDetectFile::samprate__double"></span>double <code class="descclassname"></code><code class="descname">samprate</code><a class="headerlink" href="#_CPPv2N16createDetectFile8samprateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate (calculated from input FITS keyword <code class="docutils literal"><span class="pre">DELTAT</span></code>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N16createDetectFile9dtcObjectE">
<span id="createDetectFile::dtcObject__fitsfile"></span>fitsfile <code class="descclassname"></code><code class="descname">dtcObject</code><a class="headerlink" href="#_CPPv2N16createDetectFile9dtcObjectE" title="Permalink to this definition">¶</a></dt>
<dd><p>Object which contains information of the intermediate FITS file (used also by <a class="reference internal" href="#_CPPv213writeTestInfoP21ReconstructInitSIRENAP10gsl_vectordP8fitsfile" title="writeTestInfo"><code class="xref cpp cpp-func docutils literal"><span class="pre">writeTestInfo()</span></code></a> and <a class="reference internal" href="#_CPPv211writePulsesPP21ReconstructInitSIRENAddP10gsl_vectoriP10gsl_vectorP10gsl_vectorP10gsl_vectorP10gsl_vectorP10gsl_vectorP8fitsfile" title="writePulses"><code class="xref cpp cpp-func docutils literal"><span class="pre">writePulses()</span></code></a>).</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv211createHistoP10gsl_vectoriPP10gsl_vectorPP10gsl_vector">
<span id="createHisto__gsl_vectorP.i.gsl_vectorPP.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">createHisto</code><span class="sig-paren">(</span>gsl_vector *<em>invector</em>, int <em>nbins</em>, gsl_vector **<em>xhistogsl</em>, gsl_vector **<em>yhistogsl</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv211createHistoP10gsl_vectoriPP10gsl_vectorPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function builds the histogram of the input vector.</p>
<blockquote>
<div><ul class="simple">
<li>Histogram x-axis values are the different input vector values (pulseheights)</li>
<li>Histogram y-axis values are the the number of cases per unit of the variable on the horizontal axis</li>
</ul>
</div></blockquote>
<ol class="arabic simple">
<li>Declare variables</li>
<li>It will work with the positive elements of the input vector <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <em>invectoraux2</em></li>
<li>Check if all the values of <a class="reference internal" href="#_CPPv2N11createHisto8invectorE" title="createHisto::invector"><code class="xref cpp cpp-member docutils literal"><span class="pre">invector</span></code></a> are the same <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Histogram of only one bin</li>
<li>Obtain <em>invector_max</em> and <em>invector_min</em></li>
<li>Obtain <em>binSize</em></li>
<li>Create histogram axis</li>
<li>Free allocated GSL vectors</li>
</ol>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N11createHisto8invectorE">
<span id="createHisto::invector__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">invector</code><a class="headerlink" href="#_CPPv2N11createHisto8invectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL input vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11createHisto5nbinsE">
<span id="createHisto::nbins__i"></span>int <code class="descclassname"></code><code class="descname">nbins</code><a class="headerlink" href="#_CPPv2N11createHisto5nbinsE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of bins to build the histogram</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11createHisto9xhistogslE">
<span id="createHisto::xhistogsl__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">xhistogsl</code><a class="headerlink" href="#_CPPv2N11createHisto9xhistogslE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with output histogram x-axis</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11createHisto9yhistogslE">
<span id="createHisto::yhistogsl__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">yhistogsl</code><a class="headerlink" href="#_CPPv2N11createHisto9yhistogslE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with output histogram y-axis</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv213createLibraryP21ReconstructInitSIRENAPbPP8fitsfile">
<span id="createLibrary__ReconstructInitSIRENAP.bP.fitsfilePP"></span>int <code class="descclassname"></code><code class="descname">createLibrary</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em>, bool *<em>appendToLibrary</em>, fitsfile **<em>inLibObject</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv213createLibraryP21ReconstructInitSIRENAPbPP8fitsfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function creates the pulse templates library FITS file, if it does not exist yet. Otherwise, it opens it (to add a new row).</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">If it exists <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Open it and set <em>appendToLibrary = true</em></p>
</li>
<li><p class="first">If it does not exist <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Create it and set <em>appendToLibrary = false</em></p>
<blockquote>
<div><ul class="simple">
<li>Write keyword <code class="docutils literal"><span class="pre">EVENTCNT</span></code> = 1 in the LIBRARY extension</li>
<li>Write info keywords about the running parameters in the Primary extension</li>
</ul>
</div></blockquote>
</li>
</ol>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N13createLibrary16reconstruct_initE">
<span id="createLibrary::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N13createLibrary16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses parameters
to call the library (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LibraryFile"><code class="xref std std-option docutils literal"><span class="pre">LibraryFile</span></code></a>) and to write input parameters info in the Primary extension of the library file</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13createLibrary15appendToLibraryE">
<span id="createLibrary::appendToLibrary__b"></span>bool <code class="descclassname"></code><code class="descname">appendToLibrary</code><a class="headerlink" href="#_CPPv2N13createLibrary15appendToLibraryE" title="Permalink to this definition">¶</a></dt>
<dd><p>Used by the function <a class="reference internal" href="#_CPPv212writeLibraryP21ReconstructInitSIRENAddP10gsl_vectorP10gsl_matrixP10gsl_matrixbPP8fitsfile" title="writeLibrary"><code class="xref cpp cpp-func docutils literal"><span class="pre">writeLibrary()</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13createLibrary11inLibObjectE">
<span id="createLibrary::inLibObject__fitsfilePP"></span>fitsfile **<code class="descclassname"></code><code class="descname">inLibObject</code><a class="headerlink" href="#_CPPv2N13createLibrary11inLibObjectE" title="Permalink to this definition">¶</a></dt>
<dd><p>Object which contains information of the library FITS file (used also by <a class="reference internal" href="#_CPPv212writeLibraryP21ReconstructInitSIRENAddP10gsl_vectorP10gsl_matrixP10gsl_matrixbPP8fitsfile" title="writeLibrary"><code class="xref cpp cpp-func docutils literal"><span class="pre">writeLibrary()</span></code></a>)</p>
</dd></dl>

</dd></dl>

<span class="target" id="d"></span><dl class="function">
<dt id="_CPPv213differentiatePP10gsl_vectori">
<span id="differentiate__gsl_vectorPP.i"></span>int <code class="descclassname"></code><code class="descname">differentiate</code><span class="sig-paren">(</span>gsl_vector **<em>invector</em>, int <em>szVct</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv213differentiatePP10gsl_vectori" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function applies the derivative method <img class="math" src="_images/math/e199b9de999a07e3d7dc0540e3bf021eca61aef7.png" alt="x_i-x_{i-1}"/> to the input vector.</p>
<p>The derivative method provides more sensitivity to handle with piled-up pulses.
Moreover, little variations of the baseline will not affect.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N13differentiate8invectorE">
<span id="differentiate::invector__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">invector</code><a class="headerlink" href="#_CPPv2N13differentiate8invectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/Ouput GSL vector (non-differentiate input vector/differentiate input vector)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13differentiate5szVctE">
<span id="differentiate::szVct__i"></span>int <code class="descclassname"></code><code class="descname">szVct</code><a class="headerlink" href="#_CPPv2N13differentiate5szVctE" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of <a class="reference internal" href="#_CPPv2N13differentiate8invectorE" title="differentiate::invector"><code class="xref cpp cpp-member docutils literal"><span class="pre">invector</span></code></a></p>
</dd></dl>

</dd></dl>

<span class="target" id="e"></span><dl class="function">
<dt id="_CPPv27eigenVVP10gsl_matrixPP10gsl_matrixPP10gsl_vector">
<span id="eigenVV__gsl_matrixP.gsl_matrixPP.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">eigenVV</code><span class="sig-paren">(</span>gsl_matrix *<em>matrixin</em>, gsl_matrix **<em>eigenvectors</em>, gsl_vector **<em>eigenvalues</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv27eigenVVP10gsl_matrixPP10gsl_matrixPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This funcion provides the principal eigenvectors and eigenvalues of the input matrix (at the moment, the first two eigenvalues and eigenvectors).</p>
<ul class="simple">
<li>Calculate the eigenvectors and the eigenvalues</li>
<li>Sort the eigenvectors and the eigenvalues in descending order</li>
<li>Choose the main eigenvectors and eigenvalues (the principal components analysis). At the moment, the first two eigenvectors and eigenvalues</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N7eigenVV8matrixinE">
<span id="eigenVV::matrixin__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">matrixin</code><a class="headerlink" href="#_CPPv2N7eigenVV8matrixinE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL matrix</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N7eigenVV12eigenvectorsE">
<span id="eigenVV::eigenvectors__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">eigenvectors</code><a class="headerlink" href="#_CPPv2N7eigenVV12eigenvectorsE" title="Permalink to this definition">¶</a></dt>
<dd><p>Subset of eigenvectors of &#8216;matrixin&#8217; chosen by PCA (the first two ones)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N7eigenVV11eigenvaluesE">
<span id="eigenVV::eigenvalues__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">eigenvalues</code><a class="headerlink" href="#_CPPv2N7eigenVV11eigenvaluesE" title="Permalink to this definition">¶</a></dt>
<dd><p>Subset of eigenvalues of &#8216;matrixin&#8217; chosen by PCA (the first two ones)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv210exit_errorPCKc6stringi">
<span id="exit_error__cCPC.string.i"></span>void <code class="descclassname"></code><code class="descname">exit_error</code><span class="sig-paren">(</span><em class="property">const</em> char *<em class="property">const</em> <em>func</em>, string <em>msg</em>, int <em>status</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv210exit_errorPCKc6stringi" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>genutils.cpp</em></p>
<p>This function prints out error messages and exits program.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N10exit_error4funcE">
<span id="exit_error::func__cCPC"></span><em class="property">const</em> char *<em class="property">const</em> <code class="descclassname"></code><code class="descname">func</code><a class="headerlink" href="#_CPPv2N10exit_error4funcE" title="Permalink to this definition">¶</a></dt>
<dd><p>Function name whose error is printed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10exit_error3msgE">
<span id="exit_error::msg__string"></span>string <code class="descclassname"></code><code class="descname">msg</code><a class="headerlink" href="#_CPPv2N10exit_error3msgE" title="Permalink to this definition">¶</a></dt>
<dd><p>Error message to be printed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10exit_error6statusE">
<span id="exit_error::status__i"></span>int <code class="descclassname"></code><code class="descname">status</code><a class="headerlink" href="#_CPPv2N10exit_error6statusE" title="Permalink to this definition">¶</a></dt>
<dd><p>Status</p>
</dd></dl>

</dd></dl>

<span class="target" id="f"></span><dl class="function">
<dt id="_CPPv23FFTP10gsl_vectorP18gsl_vector_complexd">
<span id="FFT__gsl_vectorP.gsl_vector_complexP.double"></span>int <code class="descclassname"></code><code class="descname">FFT</code><span class="sig-paren">(</span>gsl_vector *<em>invector</em>, gsl_vector_complex *<em>outvector</em>, double <em>STD</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv23FFTP10gsl_vectorP18gsl_vector_complexd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>genutils.cpp</em></p>
<p>This function calculates the FFT of the elements of a vector.</p>
<p>GSL library (overview of FFTs):</p>
<p>For physical applications it is important to remember that the index appearing in the DFT does not correspond directly to a physical frequency. If the time-step of the
DFT is <img class="math" src="_images/math/4d26a3c646f81ab56cceb818c7801dd1f3cfaaf3.png" alt="\Delta"/> then the frequency domain includes both positive and negative frequencies, ranging from <img class="math" src="_images/math/dbea819e327f646c44e10fa333e0f4a2e921af7b.png" alt="-1/(2\Delta)"/> through 0 to <img class="math" src="_images/math/81af1bd851843772a7b291be1db5df102f02cf38.png" alt="+1/(2\Delta)"/>. The positive frequencies are stored from the beginning of the array up to the middle, and the negative frequencies are stored backwards from the end of the array.</p>
<p>Here is a table which shows the layout of the array data, and the correspondence between the time domain data z, and the frequency domain data x.</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="27%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">index</th>
<th class="head">z</th>
<th class="head">x = FFT(z)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td><img class="math" src="_images/math/6834a94848f5ed487e51d7190143128b1bc81870.png" alt="z(t = 0)"/></td>
<td><img class="math" src="_images/math/11845bf970b25bc5c33f8c7452b9cfa9a7850998.png" alt="x(f = 0)"/></td>
</tr>
<tr class="row-odd"><td>1</td>
<td><img class="math" src="_images/math/0ad54e584bbd7fc673fbf4ce690188ce2ec59169.png" alt="z(t = 1)"/></td>
<td><img class="math" src="_images/math/913edbac7573cbab52d18cfa6a5040c6dff37bf2.png" alt="x(f = 1/(n\Delta))"/></td>
</tr>
<tr class="row-even"><td>2</td>
<td><img class="math" src="_images/math/8a42c9a31708305c272648ab0bf20bb87e29d5fd.png" alt="z(t = 2)"/></td>
<td><img class="math" src="_images/math/0d9e04eb35ba72f8f11027922e755d336ae31611.png" alt="x(f = 2/(n\Delta))"/></td>
</tr>
<tr class="row-odd"><td>[...]</td>
<td>[........]</td>
<td>[..................]</td>
</tr>
<tr class="row-even"><td>n/2</td>
<td><img class="math" src="_images/math/be2393c050b5af7e67d211ccc93db48b30b8aee9.png" alt="z(t = n/2)"/></td>
<td><img class="math" src="_images/math/b71bbce63b0a5d30bd3bc73f32061e770a99eb26.png" alt="x(f = +1/(2\Delta),-1/(2\Delta))"/></td>
</tr>
<tr class="row-odd"><td>[...]</td>
<td>[........]</td>
<td>[..................]</td>
</tr>
<tr class="row-even"><td>n-3</td>
<td><img class="math" src="_images/math/80f7f7751e141a88a08561c3226a33f4b882e6ca.png" alt="z(t = n-3)"/></td>
<td><img class="math" src="_images/math/c6e932cec99a2007a02e6f154b544b9877f90b23.png" alt="x(f = -3/(n\Delta))"/></td>
</tr>
<tr class="row-odd"><td>n-2</td>
<td><img class="math" src="_images/math/6ccfe74ee01f2bc535268200039563290155af57.png" alt="z(t = n-2)"/></td>
<td><img class="math" src="_images/math/cd24cc207470feaee11e11584b90a24d0f090bcf.png" alt="x(f = -2/(n\Delta))"/></td>
</tr>
<tr class="row-even"><td>n-1</td>
<td><img class="math" src="_images/math/3bc6011e59ae47ccca1316bef7ecd663894fa060.png" alt="z(t = n-1)"/></td>
<td><img class="math" src="_images/math/5207a342349aafb580b71e841c298e223e2b49fb.png" alt="x(f = -1/(n\Delta))"/></td>
</tr>
</tbody>
</table>
<p>The frequency axis will be built as <em>f = i/STD = i/(size/samprate)</em> with <em>i</em> varying from 0 to <em>size/2-1</em> (<em>n=size</em> and <img class="math" src="_images/math/87971eb88bf6c327ba61b49da16606039c4e8fa2.png" alt="\Delta=1/samprate"/>  sec/sample).</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N3FFT8invectorE">
<span id="FFT::invector__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">invector</code><a class="headerlink" href="#_CPPv2N3FFT8invectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3FFT9outvectorE">
<span id="FFT::outvector__gsl_vector_complexP"></span>gsl_vector_complex *<code class="descclassname"></code><code class="descname">outvector</code><a class="headerlink" href="#_CPPv2N3FFT9outvectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Output GSL complex vector with the FFT of <a class="reference internal" href="#_CPPv2N3FFT8invectorE" title="FFT::invector"><code class="xref cpp cpp-member docutils literal"><span class="pre">invector</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N3FFT3STDE">
<span id="FFT::STD__double"></span>double <code class="descclassname"></code><code class="descname">STD</code><a class="headerlink" href="#_CPPv2N3FFT3STDE" title="Permalink to this definition">¶</a></dt>
<dd><p>SelectedTimeDuration = (Size of <a class="reference internal" href="#_CPPv2N3FFT8invectorE" title="FFT::invector"><code class="xref cpp cpp-member docutils literal"><span class="pre">invector</span></code></a>)/<em>samprate</em></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv210FFTinverseP18gsl_vector_complexP10gsl_vectord">
<span id="FFTinverse__gsl_vector_complexP.gsl_vectorP.double"></span>int <code class="descclassname"></code><code class="descname">FFTinverse</code><span class="sig-paren">(</span>gsl_vector_complex *<em>invector</em>, gsl_vector *<em>outvector</em>, double <em>STD</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv210FFTinverseP18gsl_vector_complexP10gsl_vectord" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>genutils.cpp</em></p>
<p>This function calculates the inverse FFT of the elements of a vector.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N10FFTinverse8invectorE">
<span id="FFTinverse::invector__gsl_vector_complexP"></span>gsl_vector_complex *<code class="descclassname"></code><code class="descname">invector</code><a class="headerlink" href="#_CPPv2N10FFTinverse8invectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL complex vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10FFTinverse9outvectorE">
<span id="FFTinverse::outvector__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">outvector</code><a class="headerlink" href="#_CPPv2N10FFTinverse9outvectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Output GSL vector with the inverse FFT of <a class="reference internal" href="#_CPPv2N10FFTinverse8invectorE" title="FFTinverse::invector"><code class="xref cpp cpp-member docutils literal"><span class="pre">invector</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10FFTinverse3STDE">
<span id="FFTinverse::STD__double"></span>double <code class="descclassname"></code><code class="descname">STD</code><a class="headerlink" href="#_CPPv2N10FFTinverse3STDE" title="Permalink to this definition">¶</a></dt>
<dd><p>SelectedTimeDuration = (Size of <a class="reference internal" href="#_CPPv2N10FFTinverse8invectorE" title="FFTinverse::invector"><code class="xref cpp cpp-member docutils literal"><span class="pre">invector</span></code></a>)/<em>samprate</em></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv213filderLibraryPP21ReconstructInitSIRENAd">
<span id="filderLibrary__ReconstructInitSIRENAPP.double"></span>int <code class="descclassname"></code><code class="descname">filderLibrary</code><span class="sig-paren">(</span>ReconstructInitSIRENA **<em>reconstruct_init</em>, double <em>samprate</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv213filderLibraryPP21ReconstructInitSIRENAd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function calculates the (low-pass filter and) derivative of the models (<em>pulse_templates</em>) in the library (only necessary if first record),
and it stores the <em>pulse_templates_filder</em> and the <em>maxDERs</em> (see below) in the <a class="reference internal" href="#_CPPv2N13filderLibrary16reconstruct_initE" title="filderLibrary::reconstruct_init"><code class="xref cpp cpp-member docutils literal"><span class="pre">reconstruct_init</span></code></a> structure.</p>
<p>The maximum of the (low-pass filtered and) differentiated pulse has to be compared to the <em>maxDERs</em> to select the appropriate model.</p>
<ol class="arabic simple">
<li>Check if it is the first record</li>
<li>(Low-pass filter and) differentiate the models (<em>pulse_templates</em>) of the library</li>
<li>Store the (low-pass filtered) derivatives in <em>pulse_templates_filder</em></li>
<li>Calculate the maximum of the (low-pass filtered and) differentiated models (<em>maxDERs</em>)</li>
</ol>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N13filderLibrary16reconstruct_initE">
<span id="filderLibrary::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N13filderLibrary16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses some parameters
to filter (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-scaleFactor"><code class="xref std std-option docutils literal"><span class="pre">scaleFactor</span></code></a>) and other parameters to handle the pulse templates and their derivatives (<em>ntemplates</em>, <em>pulse_templates</em>,
<em>pulse_templates_filder</em> and <em>maxDERs</em>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13filderLibrary8samprateE">
<span id="filderLibrary::samprate__double"></span>double <code class="descclassname"></code><code class="descname">samprate</code><a class="headerlink" href="#_CPPv2N13filderLibrary8samprateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv210fileExistsRKNSt6stringE">
<span id="fileExists__ssCR"></span>bool <code class="descclassname"></code><code class="descname">fileExists</code><span class="sig-paren">(</span><em class="property">const</em> std::string &amp;<em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv210fileExistsRKNSt6stringE" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>genutils.cpp</em></p>
<p>This function checks for file existence returning a boolean value.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N10fileExists4nameE">
<span id="fileExists::name__ssCR"></span><em class="property">const</em> std::string &amp;<code class="descclassname"></code><code class="descname">name</code><a class="headerlink" href="#_CPPv2N10fileExists4nameE" title="Permalink to this definition">¶</a></dt>
<dd><p>File name</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv216filterByWaveletsP21ReconstructInitSIRENAPP10gsl_vectoriPi">
<span id="filterByWavelets__ReconstructInitSIRENAP.gsl_vectorPP.i.iP"></span>int <code class="descclassname"></code><code class="descname">filterByWavelets</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em>, gsl_vector **<em>invector</em>, int <em>length</em>, int *<em>onlyOnce</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv216filterByWaveletsP21ReconstructInitSIRENAPP10gsl_vectoriPi" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function filters the input/output signal <a class="reference internal" href="#_CPPv2N16filterByWavelets8invectorE" title="filterByWavelets::invector"><code class="xref cpp cpp-member docutils literal"><span class="pre">invector</span></code></a>, reducing the noise level.</p>
<p>Steps:</p>
<ul class="simple">
<li>It is only going to work with <em>n</em> elements of :cpp:member:&#8217;invector&#8217;</li>
<li>Discrete Wavelet Treansform</li>
<li>Sorting coefficients</li>
<li>Hard thresholding: <em>n-nc</em> coefficeints are deleted (those with low energy)</li>
<li>Inverse DWT</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N16filterByWavelets16reconstruct_initE">
<span id="filterByWavelets::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N16filterByWavelets16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values).</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N16filterByWavelets8invectorE">
<span id="filterByWavelets::invector__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">invector</code><a class="headerlink" href="#_CPPv2N16filterByWavelets8invectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output signal</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N16filterByWavelets6lengthE">
<span id="filterByWavelets::length__i"></span>int <code class="descclassname"></code><code class="descname">length</code><a class="headerlink" href="#_CPPv2N16filterByWavelets6lengthE" title="Permalink to this definition">¶</a></dt>
<dd><p>Length of the wavelet transform</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N16filterByWavelets8onlyOnceE">
<span id="filterByWavelets::onlyOnce__iP"></span>int *<code class="descclassname"></code><code class="descname">onlyOnce</code><a class="headerlink" href="#_CPPv2N16filterByWavelets8onlyOnceE" title="Permalink to this definition">¶</a></dt>
<dd><p>In order to control the times to be executed</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv213findMeanSigmaP10gsl_vectorPdPd">
<span id="findMeanSigma__gsl_vectorP.doubleP.doubleP"></span>int <code class="descclassname"></code><code class="descname">findMeanSigma</code><span class="sig-paren">(</span>gsl_vector *<em>invector</em>, double *<em>mean</em>, double *<em>sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv213findMeanSigmaP10gsl_vectorPdPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function calculates the mean and the standard deviation of the input vector.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N13findMeanSigma8invectorE">
<span id="findMeanSigma::invector__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">invector</code><a class="headerlink" href="#_CPPv2N13findMeanSigma8invectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findMeanSigma4meanE">
<span id="findMeanSigma::mean__doubleP"></span>double *<code class="descclassname"></code><code class="descname">mean</code><a class="headerlink" href="#_CPPv2N13findMeanSigma4meanE" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean of the elements of <a class="reference internal" href="#_CPPv2N13findMeanSigma8invectorE" title="findMeanSigma::invector"><code class="xref cpp cpp-member docutils literal"><span class="pre">invector</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findMeanSigma5sigmaE">
<span id="findMeanSigma::sigma__doubleP"></span>double *<code class="descclassname"></code><code class="descname">sigma</code><a class="headerlink" href="#_CPPv2N13findMeanSigma5sigmaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Standard deviation of the elements of <a class="reference internal" href="#_CPPv2N13findMeanSigma8invectorE" title="findMeanSigma::invector"><code class="xref cpp cpp-member docutils literal"><span class="pre">invector</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv213findPulsesCALP10gsl_vectorP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPiPdddidddP21ReconstructInitSIRENAdd">
<span id="findPulsesCAL__gsl_vectorP.gsl_vectorP.gsl_vectorPP.gsl_vectorPP.gsl_vectorPP.gsl_vectorPP.iP.doubleP.double.double.i.double.double.double.ReconstructInitSIRENAP.double.double"></span>int <code class="descclassname"></code><code class="descname">findPulsesCAL</code><span class="sig-paren">(</span>gsl_vector *<em>vectorin</em>, gsl_vector *<em>vectorinDER</em>, gsl_vector **<em>tstart</em>, gsl_vector **<em>quality</em>, gsl_vector **<em>pulseheight</em>, gsl_vector **<em>maxDERgsl</em>, int *<em>nPulses</em>, double *<em>threshold</em>, double <em>scalefactor</em>, double <em>samplingRate</em>, int <em>samplesup</em>, double <em>nsgms</em>, double <em>lb</em>, double <em>lrs</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, double <em>stopcriteriamkc</em>, double <em>kappamkc</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv213findPulsesCALP10gsl_vectorP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPiPdddidddP21ReconstructInitSIRENAdd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function is going to find the pulses in a record (in the <em>CALibration</em> mode) by using the function <a class="reference internal" href="#_CPPv213findTstartCALiP10gsl_vectordiP21ReconstructInitSIRENAPiPP10gsl_vectorPP10gsl_vectorPP10gsl_vector" title="findTstartCAL"><code class="xref cpp cpp-func docutils literal"><span class="pre">findTstartCAL()</span></code></a>.</p>
<p>Steps:</p>
<ul class="simple">
<li>Declare variables</li>
<li>First step to look for single pulses (call <a class="reference internal" href="#_CPPv219medianKappaClippingP10gsl_vectordddiPd" title="medianKappaClipping"><code class="xref cpp cpp-func docutils literal"><span class="pre">medianKappaClipping()</span></code></a>)<ul>
<li>Call <a class="reference internal" href="#_CPPv213findTstartCALiP10gsl_vectordiP21ReconstructInitSIRENAPiPP10gsl_vectorPP10gsl_vectorPP10gsl_vector" title="findTstartCAL"><code class="xref cpp cpp-func docutils literal"><span class="pre">findTstartCAL()</span></code></a></li>
</ul>
</li>
<li>If at least a pulse is found<ul>
<li>Get <a class="reference internal" href="#_CPPv2N13findPulsesCAL11pulseheightE" title="findPulsesCAL::pulseheight"><code class="xref cpp cpp-member docutils literal"><span class="pre">pulseheight</span></code></a> of each found pulse (in order to be used to build the pulse templates library)</li>
</ul>
</li>
<li>Free allocated GSL vectors</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N13findPulsesCAL8vectorinE">
<span id="findPulsesCAL::vectorin__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">vectorin</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL8vectorinE" title="Permalink to this definition">¶</a></dt>
<dd><p>Not filtered record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL11vectorinDERE">
<span id="findPulsesCAL::vectorinDER__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">vectorinDER</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL11vectorinDERE" title="Permalink to this definition">¶</a></dt>
<dd><p>Derivative of the (low-pass filtered) <a class="reference internal" href="#_CPPv2N13findPulsesCAL8vectorinE" title="findPulsesCAL::vectorin"><code class="xref cpp cpp-member docutils literal"><span class="pre">vectorin</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL6tstartE">
<span id="findPulsesCAL::tstart__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">tstart</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL6tstartE" title="Permalink to this definition">¶</a></dt>
<dd><p>Starting time of the found pulses into the record (in samples)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL7qualityE">
<span id="findPulsesCAL::quality__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">quality</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL7qualityE" title="Permalink to this definition">¶</a></dt>
<dd><p>Quality of the found pulses into the record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL11pulseheightE">
<span id="findPulsesCAL::pulseheight__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">pulseheight</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL11pulseheightE" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulse height of the found pulses into the record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL9maxDERgslE">
<span id="findPulsesCAL::maxDERgsl__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">maxDERgsl</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL9maxDERgslE" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum of the derivative of the found (low-pass filtered) pulses into the record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL7nPulsesE">
<span id="findPulsesCAL::nPulses__iP"></span>int *<code class="descclassname"></code><code class="descname">nPulses</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL7nPulsesE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of found pulses</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL9thresholdE">
<span id="findPulsesCAL::threshold__doubleP"></span>double *<code class="descclassname"></code><code class="descname">threshold</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL9thresholdE" title="Permalink to this definition">¶</a></dt>
<dd><p>Threshold used to find the pulses (output parameter because it is necessary out of the function)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL11scalefactorE">
<span id="findPulsesCAL::scalefactor__double"></span>double <code class="descclassname"></code><code class="descname">scalefactor</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL11scalefactorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale factor to calculate the LPF box-car length (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-scaleFactor"><code class="xref std std-option docutils literal"><span class="pre">scaleFactor</span></code></a>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL12samplingRateE">
<span id="findPulsesCAL::samplingRate__double"></span>double <code class="descclassname"></code><code class="descname">samplingRate</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL12samplingRateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL9samplesupE">
<span id="findPulsesCAL::samplesup__i"></span>int <code class="descclassname"></code><code class="descname">samplesup</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL9samplesupE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of consecutive samples over the threshold to locate a pulse (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-samplesUp"><code class="xref std std-option docutils literal"><span class="pre">samplesUp</span></code></a>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL5nsgmsE">
<span id="findPulsesCAL::nsgms__double"></span>double <code class="descclassname"></code><code class="descname">nsgms</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL5nsgmsE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of Sigmas to establish the threshold (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-nSgms"><code class="xref std std-option docutils literal"><span class="pre">nSgms</span></code></a>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL2lbE">
<span id="findPulsesCAL::lb__double"></span>double <code class="descclassname"></code><code class="descname">lb</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL2lbE" title="Permalink to this definition">¶</a></dt>
<dd><p>Vector containing the baseline averaging length used for each pulse</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL3lrsE">
<span id="findPulsesCAL::lrs__double"></span>double <code class="descclassname"></code><code class="descname">lrs</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL3lrsE" title="Permalink to this definition">¶</a></dt>
<dd><p>Running sum length (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LrsT"><code class="xref std std-option docutils literal"><span class="pre">LrsT</span></code></a> in samples)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL16reconstruct_initE">
<span id="findPulsesCAL::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses
<em>maxPulsesPerRecord</em> (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EventListSize"><code class="xref std std-option docutils literal"><span class="pre">EventListSize</span></code></a>) and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-PulseLength"><code class="xref std std-option docutils literal"><span class="pre">PulseLength</span></code></a> (and <a class="reference internal" href="#_CPPv213findTstartCALiP10gsl_vectordiP21ReconstructInitSIRENAPiPP10gsl_vectorPP10gsl_vectorPP10gsl_vector" title="findTstartCAL"><code class="xref cpp cpp-func docutils literal"><span class="pre">findTstartCAL()</span></code></a> uses <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-tstartPulse1"><code class="xref std std-option docutils literal"><span class="pre">tstartPulse1</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-tstartPulse2"><code class="xref std std-option docutils literal"><span class="pre">tstartPulse2</span></code></a> and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-tstartPulse3"><code class="xref std std-option docutils literal"><span class="pre">tstartPulse3</span></code></a>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL15stopcriteriamkcE">
<span id="findPulsesCAL::stopcriteriamkc__double"></span>double <code class="descclassname"></code><code class="descname">stopcriteriamkc</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL15stopcriteriamkcE" title="Permalink to this definition">¶</a></dt>
<dd><p>Used in <a class="reference internal" href="#_CPPv219medianKappaClippingP10gsl_vectordddiPd" title="medianKappaClipping"><code class="xref cpp cpp-func docutils literal"><span class="pre">medianKappaClipping()</span></code></a> (%)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findPulsesCAL8kappamkcE">
<span id="findPulsesCAL::kappamkc__double"></span>double <code class="descclassname"></code><code class="descname">kappamkc</code><a class="headerlink" href="#_CPPv2N13findPulsesCAL8kappamkcE" title="Permalink to this definition">¶</a></dt>
<dd><p>Used in <a class="reference internal" href="#_CPPv219medianKappaClippingP10gsl_vectordddiPd" title="medianKappaClipping"><code class="xref cpp cpp-func docutils literal"><span class="pre">medianKappaClipping()</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv215FindSecondariesiP10gsl_vectordP21ReconstructInitSIRENAiPiPP10gsl_vectorPP10gsl_vectorPP10gsl_vector">
<span id="FindSecondaries__i.gsl_vectorP.double.ReconstructInitSIRENAP.i.iP.gsl_vectorPP.gsl_vectorPP.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">FindSecondaries</code><span class="sig-paren">(</span>int <em>maxPulsesPerRecord</em>, gsl_vector *<em>adjustedDerivative</em>, double <em>adaptativethreshold</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, int <em>tstartFirstEvent</em>, int *<em>numberPulses</em>, gsl_vector **<em>tstartgsl</em>, gsl_vector **<em>flagTruncated</em>, gsl_vector **<em>maxDERgsl</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv215FindSecondariesiP10gsl_vectordP21ReconstructInitSIRENAiPiPP10gsl_vectorPP10gsl_vectorPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function runs after <a class="reference internal" href="#_CPPv217InitialTriggeringP10gsl_vectordddddPbPiPiPdi" title="InitialTriggering"><code class="xref cpp cpp-func docutils literal"><span class="pre">InitialTriggering()</span></code></a> to find all the events (except the first one) in the first derivative of the (low-pass filtered) record.</p>
<p>Steps:</p>
<ul>
<li><p class="first">Declare variables</p>
</li>
<li><p class="first">It is possible to find the tstarts...</p>
<p>It looks for an event and if a pulse is found (foundPulse=true), it looks for another event</p>
<blockquote>
<div><ul>
<li><p class="first">It looks for an event since the beginning (or the previous event) to the end of the record.
The first condition to detect an event is that the <a class="reference internal" href="#_CPPv2N15FindSecondaries18adjustedDerivativeE" title="FindSecondaries::adjustedDerivative"><code class="xref cpp cpp-member docutils literal"><span class="pre">adjustedDerivative</span></code></a> was over the <code class="xref cpp cpp-member docutils literal"><span class="pre">threshold</span></code></p>
</li>
<li><p class="first">Subtract the model from the adjusted derivative</p>
<blockquote>
<div><ul class="simple">
<li>Select the model of the found event from the libary by using the first sample of the derivative</li>
<li>Subtract</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">... Or to use the tstart provided as input parameters</p>
<blockquote>
<div><ul class="simple">
<li>Obtain the <em>maxDERs</em> of the events whose tstarts have been provided (by using the maximum of the derivative to find the model)</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Free allocated GSL vectors</p>
</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N15FindSecondaries18maxPulsesPerRecordE">
<span id="FindSecondaries::maxPulsesPerRecord__i"></span>int <code class="descclassname"></code><code class="descname">maxPulsesPerRecord</code><a class="headerlink" href="#_CPPv2N15FindSecondaries18maxPulsesPerRecordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Expected maximum number of events per record in order to not allocate the GSL variables with the size of the input vector (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EventListSize"><code class="xref std std-option docutils literal"><span class="pre">EventListSize</span></code></a>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15FindSecondaries18adjustedDerivativeE">
<span id="FindSecondaries::adjustedDerivative__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">adjustedDerivative</code><a class="headerlink" href="#_CPPv2N15FindSecondaries18adjustedDerivativeE" title="Permalink to this definition">¶</a></dt>
<dd><p>First derivative of the (low-pass filtered) record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15FindSecondaries19adaptativethresholdE">
<span id="FindSecondaries::adaptativethreshold__double"></span>double <code class="descclassname"></code><code class="descname">adaptativethreshold</code><a class="headerlink" href="#_CPPv2N15FindSecondaries19adaptativethresholdE" title="Permalink to this definition">¶</a></dt>
<dd><p>Threshold</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15FindSecondaries16reconstruct_initE">
<span id="FindSecondaries::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N15FindSecondaries16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses some parameters
(<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-PulseLength"><code class="xref std std-option docutils literal"><span class="pre">PulseLength</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-tstartPulse1"><code class="xref std std-option docutils literal"><span class="pre">tstartPulse1</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-tstartPulse2"><code class="xref std std-option docutils literal"><span class="pre">tstartPulse2</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-tstartPulse3"><code class="xref std std-option docutils literal"><span class="pre">tstartPulse3</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a>) and the templates</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15FindSecondaries16tstartFirstEventE">
<span id="FindSecondaries::tstartFirstEvent__i"></span>int <code class="descclassname"></code><code class="descname">tstartFirstEvent</code><a class="headerlink" href="#_CPPv2N15FindSecondaries16tstartFirstEventE" title="Permalink to this definition">¶</a></dt>
<dd><p>Tstart of the first event of the record (in samples) found by <a class="reference internal" href="#_CPPv217InitialTriggeringP10gsl_vectordddddPbPiPiPdi" title="InitialTriggering"><code class="xref cpp cpp-func docutils literal"><span class="pre">InitialTriggering()</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15FindSecondaries12numberPulsesE">
<span id="FindSecondaries::numberPulses__iP"></span>int *<code class="descclassname"></code><code class="descname">numberPulses</code><a class="headerlink" href="#_CPPv2N15FindSecondaries12numberPulsesE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of found events</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15FindSecondaries9tstartgslE">
<span id="FindSecondaries::tstartgsl__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">tstartgsl</code><a class="headerlink" href="#_CPPv2N15FindSecondaries9tstartgslE" title="Permalink to this definition">¶</a></dt>
<dd><p>Starting time of the found events (in samples)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15FindSecondaries13flagTruncatedE">
<span id="FindSecondaries::flagTruncated__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">flagTruncated</code><a class="headerlink" href="#_CPPv2N15FindSecondaries13flagTruncatedE" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag indicating if the event is truncated (inside this function only initial truncated pulses are classified)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15FindSecondaries9maxDERgslE">
<span id="FindSecondaries::maxDERgsl__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">maxDERgsl</code><a class="headerlink" href="#_CPPv2N15FindSecondaries9maxDERgslE" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum of the first derivative of the (low-pass filtered) record inside each found event</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15FindSecondaries11samp1DERgslE">
<span id="FindSecondaries::samp1DERgsl__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">samp1DERgsl</code><a class="headerlink" href="#_CPPv2N15FindSecondaries11samp1DERgslE" title="Permalink to this definition">¶</a></dt>
<dd><p>First sample of the first derivative of the (low-pass filtered) record inside each found event</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv213findTstartCALiP10gsl_vectordiP21ReconstructInitSIRENAPiPP10gsl_vectorPP10gsl_vectorPP10gsl_vector">
<span id="findTstartCAL__i.gsl_vectorP.double.i.ReconstructInitSIRENAP.iP.gsl_vectorPP.gsl_vectorPP.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">findTstartCAL</code><span class="sig-paren">(</span>int <em>maxPulsesPerRecord</em>, gsl_vector *<em>der</em>, double <em>adaptativethreshold</em>, int <em>nSamplesUp</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, int *<em>numberPulses</em>, gsl_vector **<em>tstartgsl</em>, gsl_vector **<em>flagTruncated</em>, gsl_vector **<em>maxDERgsl</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv213findTstartCALiP10gsl_vectordiP21ReconstructInitSIRENAPiPP10gsl_vectorPP10gsl_vectorPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function scans all the values of the derivative of the (low-pass filtered) record until it finds <a class="reference internal" href="#_CPPv2N13findTstartCAL10nSamplesUpE" title="findTstartCAL::nSamplesUp"><code class="xref cpp cpp-member docutils literal"><span class="pre">nSamplesUp</span></code></a> consecutive
values (due to the noise more than 1 value is required) over the threshold. To look for more pulses, it finds <a class="reference internal" href="#_CPPv2N13findTstartCAL10nSamplesUpE" title="findTstartCAL::nSamplesUp"><code class="xref cpp cpp-member docutils literal"><span class="pre">nSamplesUp</span></code></a> consecutive values
(due to the noise) under the threshold and then, it starts to scan again.</p>
<p>Steps:</p>
<ul>
<li><p class="first">Declare variables</p>
</li>
<li><p class="first">Allocate GSL vectors</p>
</li>
<li><p class="first">It is possible to find the tstarts...</p>
<ul class="simple">
<li>Obtain tstart of each pulse in the derivative:<ul>
<li>If <img class="math" src="_images/math/1a78d0a24370ad1e0b9f1c25c9d6ef251f029498.png" alt="der_i&gt;threshold"/> and <em>foundPulse=false</em>, it looks for <a class="reference internal" href="#_CPPv2N13findTstartCAL10nSamplesUpE" title="findTstartCAL::nSamplesUp"><code class="xref cpp cpp-member docutils literal"><span class="pre">nSamplesUp</span></code></a> consecutive samples over the threshold<ul>
<li>If not, it looks again for a pulse crossing over the threshold</li>
<li>If yes, a pulse is found (truncated if it is at the beginning)</li>
</ul>
</li>
<li>If <img class="math" src="_images/math/1a78d0a24370ad1e0b9f1c25c9d6ef251f029498.png" alt="der_i&gt;threshold"/> and <em>foundPulse=true</em>, it looks for a sample under the threshold<ul>
<li>If not, it looks again for a sample under the threshold</li>
<li>If yes, it looks for <a class="reference internal" href="#_CPPv2N13findTstartCAL10nSamplesUpE" title="findTstartCAL::nSamplesUp"><code class="xref cpp cpp-member docutils literal"><span class="pre">nSamplesUp</span></code></a> consecutive samples under the threshold and again it starts to look for a pulse</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p class="first">... Or to use the tstart provided as input parameters</p>
<p>Obtain the <em>maxDERs</em> of the pulses whose tstarts have been provided</p>
</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N13findTstartCAL18maxPulsesPerRecordE">
<span id="findTstartCAL::maxPulsesPerRecord__i"></span>int <code class="descclassname"></code><code class="descname">maxPulsesPerRecord</code><a class="headerlink" href="#_CPPv2N13findTstartCAL18maxPulsesPerRecordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Expected maximum number of pulses per record in order to not allocate the GSL variables with the size of the input vector (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EventListSize"><code class="xref std std-option docutils literal"><span class="pre">EventListSize</span></code></a>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findTstartCAL3derE">
<span id="findTstartCAL::der__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">der</code><a class="headerlink" href="#_CPPv2N13findTstartCAL3derE" title="Permalink to this definition">¶</a></dt>
<dd><p>First derivative of the (low-pass filtered) record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findTstartCAL19adaptativethresholdE">
<span id="findTstartCAL::adaptativethreshold__double"></span>double <code class="descclassname"></code><code class="descname">adaptativethreshold</code><a class="headerlink" href="#_CPPv2N13findTstartCAL19adaptativethresholdE" title="Permalink to this definition">¶</a></dt>
<dd><p>Threshold</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findTstartCAL10nSamplesUpE">
<span id="findTstartCAL::nSamplesUp__i"></span>int <code class="descclassname"></code><code class="descname">nSamplesUp</code><a class="headerlink" href="#_CPPv2N13findTstartCAL10nSamplesUpE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of consecutive samples over the threshold to &#8216;find&#8217; a pulse (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-samplesUp"><code class="xref std std-option docutils literal"><span class="pre">samplesUp</span></code></a>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findTstartCAL16reconstruct_initE">
<span id="findTstartCAL::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N13findTstartCAL16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function
uses <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-PulseLength"><code class="xref std std-option docutils literal"><span class="pre">PulseLength</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-tstartPulse1"><code class="xref std std-option docutils literal"><span class="pre">tstartPulse1</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-tstartPulse2"><code class="xref std std-option docutils literal"><span class="pre">tstartPulse2</span></code></a> and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-tstartPulse3"><code class="xref std std-option docutils literal"><span class="pre">tstartPulse3</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findTstartCAL12numberPulsesE">
<span id="findTstartCAL::numberPulses__iP"></span>int *<code class="descclassname"></code><code class="descname">numberPulses</code><a class="headerlink" href="#_CPPv2N13findTstartCAL12numberPulsesE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of found pulses</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findTstartCAL9tstartgslE">
<span id="findTstartCAL::tstartgsl__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">tstartgsl</code><a class="headerlink" href="#_CPPv2N13findTstartCAL9tstartgslE" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulses tstart (in samples)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findTstartCAL13flagTruncatedE">
<span id="findTstartCAL::flagTruncated__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">flagTruncated</code><a class="headerlink" href="#_CPPv2N13findTstartCAL13flagTruncatedE" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag indicating if the pulse is truncated</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13findTstartCAL9maxDERgslE">
<span id="findTstartCAL::maxDERgsl__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">maxDERgsl</code><a class="headerlink" href="#_CPPv2N13findTstartCAL9maxDERgslE" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum of the first derivative of the (low-pass filtered) record inside each found pulse</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv215find_EsboundarydP10gsl_vectorP21ReconstructInitSIRENAPiPiPdPd">
<span id="find_Esboundary__double.gsl_vectorP.ReconstructInitSIRENAP.iP.iP.doubleP.doubleP"></span>int <code class="descclassname"></code><code class="descname">find_Esboundary</code><span class="sig-paren">(</span>double <em>maxDER</em>, gsl_vector *<em>maxDERs</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, int *<em>indexEalpha</em>, int *<em>indexEbeta</em>, double *<em>Ealpha</em>, double *<em>Ebeta</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv215find_EsboundarydP10gsl_vectorP21ReconstructInitSIRENAPiPiPdPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em>.</p>
<p>This function provides the indexes of the two energies which straddle the pulse energy, by  comparing the maximum value of the pulse derivative
(<a class="reference internal" href="#_CPPv2N15find_Esboundary6maxDERE" title="find_Esboundary::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a>) to the list of maximums in the library  (<a class="reference internal" href="#_CPPv2N15find_Esboundary7maxDERsE" title="find_Esboundary::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a>).</p>
<p>It finds the two embracing <a class="reference internal" href="#_CPPv2N15find_Esboundary7maxDERsE" title="find_Esboundary::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the calibration library</p>
<blockquote>
<div><ul class="simple">
<li>If <a class="reference internal" href="#_CPPv2N15find_Esboundary6maxDERE" title="find_Esboundary::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is lower than the lowest <a class="reference internal" href="#_CPPv2N15find_Esboundary7maxDERsE" title="find_Esboundary::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N15find_Esboundary11indexEalphaE" title="find_Esboundary::indexEalpha"><code class="xref cpp cpp-member docutils literal"><span class="pre">indexEalpha</span></code></a> = <a class="reference internal" href="#_CPPv2N15find_Esboundary10indexEbetaE" title="find_Esboundary::indexEbeta"><code class="xref cpp cpp-member docutils literal"><span class="pre">indexEbeta</span></code></a> = 0</li>
<li>If <a class="reference internal" href="#_CPPv2N15find_Esboundary6maxDERE" title="find_Esboundary::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is higher than the highest <a class="reference internal" href="#_CPPv2N15find_Esboundary7maxDERsE" title="find_Esboundary::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N15find_Esboundary11indexEalphaE" title="find_Esboundary::indexEalpha"><code class="xref cpp cpp-member docutils literal"><span class="pre">indexEalpha</span></code></a> = <a class="reference internal" href="#_CPPv2N15find_Esboundary10indexEbetaE" title="find_Esboundary::indexEbeta"><code class="xref cpp cpp-member docutils literal"><span class="pre">indexEbeta</span></code></a> = Number of templates-1</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N15find_Esboundary6maxDERE">
<span id="find_Esboundary::maxDER__double"></span>double <code class="descclassname"></code><code class="descname">maxDER</code><a class="headerlink" href="#_CPPv2N15find_Esboundary6maxDERE" title="Permalink to this definition">¶</a></dt>
<dd><p>Max value of the derivative of the (filtered) pulse whose embracing energies are being sought</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15find_Esboundary7maxDERsE">
<span id="find_Esboundary::maxDERs__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">maxDERs</code><a class="headerlink" href="#_CPPv2N15find_Esboundary7maxDERsE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the maximum values of the derivatives of the templates in the library to be compared with the pulse being analysed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15find_Esboundary16reconstruct_initE">
<span id="find_Esboundary::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N15find_Esboundary16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses the info in the library about the energies</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15find_Esboundary11indexEalphaE">
<span id="find_Esboundary::indexEalpha__iP"></span>int *<code class="descclassname"></code><code class="descname">indexEalpha</code><a class="headerlink" href="#_CPPv2N15find_Esboundary11indexEalphaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the energy lower than the energy of the pulse which is being analyzed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15find_Esboundary10indexEbetaE">
<span id="find_Esboundary::indexEbeta__iP"></span>int *<code class="descclassname"></code><code class="descname">indexEbeta</code><a class="headerlink" href="#_CPPv2N15find_Esboundary10indexEbetaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the energy higher than the energy of the pulse which is being analyzed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15find_Esboundary6EalphaE">
<span id="find_Esboundary::Ealpha__doubleP"></span>double *<code class="descclassname"></code><code class="descname">Ealpha</code><a class="headerlink" href="#_CPPv2N15find_Esboundary6EalphaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy (in eV) which straddle the <a class="reference internal" href="#_CPPv2N15find_Esboundary6maxDERE" title="find_Esboundary::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the lower limit</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15find_Esboundary5EbetaE">
<span id="find_Esboundary::Ebeta__doubleP"></span>double *<code class="descclassname"></code><code class="descname">Ebeta</code><a class="headerlink" href="#_CPPv2N15find_Esboundary5EbetaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy (in eV) which straddle the <a class="reference internal" href="#_CPPv2N15find_Esboundary6maxDERE" title="find_Esboundary::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the higher limit</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv218find_matchedfilteridP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPdPd">
<span id="find_matchedfilter__i.double.gsl_vectorP.ReconstructInitSIRENAP.gsl_vectorPP.doubleP.doubleP"></span>int <code class="descclassname"></code><code class="descname">find_matchedfilter</code><span class="sig-paren">(</span>int <em>runF0orB0val</em>, double <em>maxDER</em>, gsl_vector *<em>maxDERs</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, gsl_vector **<em>matchedfilterFound</em>, double *<em>Ealpha</em>, double *<em>Ebeta</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv218find_matchedfilteridP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPdPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function chooses the proper matched filter (normalized template) of the calibration library (<strong>MF</strong> or <strong>MFB0</strong>) by comparing the maximum of their derivatives (<a class="reference internal" href="#_CPPv2N18find_matchedfilter6maxDERE" title="find_matchedfilter::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> versus <a class="reference internal" href="#_CPPv2N18find_matchedfilter7maxDERsE" title="find_matchedfilter::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a>).</p>
<p>It finds the two embracing <a class="reference internal" href="#_CPPv2N18find_matchedfilter7maxDERsE" title="find_matchedfilter::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the calibration library and interpolates (<a class="reference internal" href="#_CPPv217interpolate_modelPP10gsl_vectordP10gsl_vectordP10gsl_vectord" title="interpolate_model"><code class="xref cpp cpp-func docutils literal"><span class="pre">interpolate_model()</span></code></a>)</p>
<blockquote>
<div><ul class="simple">
<li>If <a class="reference internal" href="#_CPPv2N18find_matchedfilter6maxDERE" title="find_matchedfilter::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is lower than the lowest <a class="reference internal" href="#_CPPv2N18find_matchedfilter7maxDERsE" title="find_matchedfilter::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The matched filter with the lowest <a class="reference internal" href="#_CPPv2N18find_matchedfilter7maxDERsE" title="find_matchedfilter::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> (first row) in the library is chosen</li>
<li>If <a class="reference internal" href="#_CPPv2N18find_matchedfilter6maxDERE" title="find_matchedfilter::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is higher than the highest <a class="reference internal" href="#_CPPv2N18find_matchedfilter7maxDERsE" title="find_matchedfilter::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The matched filter with the highest <a class="reference internal" href="#_CPPv2N18find_matchedfilter7maxDERsE" title="find_matchedfilter::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> (last row) in the library is chosen</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N18find_matchedfilter12runF0orB0valE">
<span id="find_matchedfilter::runF0orB0val__i"></span>int <code class="descclassname"></code><code class="descname">runF0orB0val</code><a class="headerlink" href="#_CPPv2N18find_matchedfilter12runF0orB0valE" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a> = <strong>F0</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N18find_matchedfilter12runF0orB0valE" title="find_matchedfilter::runF0orB0val"><code class="xref cpp cpp-member docutils literal"><span class="pre">runF0orB0val</span></code></a> = 1. If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a> = <strong>B0</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N18find_matchedfilter12runF0orB0valE" title="find_matchedfilter::runF0orB0val"><code class="xref cpp cpp-member docutils literal"><span class="pre">runF0orB0val</span></code></a> = 0</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_matchedfilter6maxDERE">
<span id="find_matchedfilter::maxDER__double"></span>double <code class="descclassname"></code><code class="descname">maxDER</code><a class="headerlink" href="#_CPPv2N18find_matchedfilter6maxDERE" title="Permalink to this definition">¶</a></dt>
<dd><p>Max value of the derivative of the (filtered) pulse whose matched filter is being sought</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_matchedfilter7maxDERsE">
<span id="find_matchedfilter::maxDERs__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">maxDERs</code><a class="headerlink" href="#_CPPv2N18find_matchedfilter7maxDERsE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the maximum values of the derivatives of the templates in the library to be compared with the pulse being analysed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_matchedfilter16reconstruct_initE">
<span id="find_matchedfilter::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N18find_matchedfilter16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses
the info in the library (<em>matched_filters</em>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_matchedfilter18matchedfilterFoundE">
<span id="find_matchedfilter::matchedfilterFound__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">matchedfilterFound</code><a class="headerlink" href="#_CPPv2N18find_matchedfilter18matchedfilterFoundE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the matched filter selected</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_matchedfilter6EalphaE">
<span id="find_matchedfilter::Ealpha__doubleP"></span>double *<code class="descclassname"></code><code class="descname">Ealpha</code><a class="headerlink" href="#_CPPv2N18find_matchedfilter6EalphaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy (in eV) which straddle the <a class="reference internal" href="#_CPPv2N18find_matchedfilter6maxDERE" title="find_matchedfilter::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the lower limit</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_matchedfilter5EbetaE">
<span id="find_matchedfilter::Ebeta__doubleP"></span>double *<code class="descclassname"></code><code class="descname">Ebeta</code><a class="headerlink" href="#_CPPv2N18find_matchedfilter5EbetaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy (in eV) which straddle the <a class="reference internal" href="#_CPPv2N18find_matchedfilter6maxDERE" title="find_matchedfilter::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the higher limit</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv221find_matchedfilterDABdP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPP10gsl_vectorPdPd">
<span id="find_matchedfilterDAB__double.gsl_vectorP.ReconstructInitSIRENAP.gsl_vectorPP.gsl_vectorPP.doubleP.doubleP"></span>int <code class="descclassname"></code><code class="descname">find_matchedfilterDAB</code><span class="sig-paren">(</span>double <em>maxDER</em>, gsl_vector *<em>maxDERs</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, gsl_vector **<em>matchedfilterFound</em>, gsl_vector **<em>PabFound</em>, double *<em>Ealpha</em>, double *<em>Ebeta</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv221find_matchedfilterDABdP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPP10gsl_vectorPdPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function selects the proper matched filter (normalized template) from the calibration library (from column <strong>DAB</strong>) by comparing
the maximum value of the pulse derivative (<a class="reference internal" href="#_CPPv2N21find_matchedfilterDAB6maxDERE" title="find_matchedfilterDAB::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a>) to the list of maximums in the library  (<a class="reference internal" href="#_CPPv2N21find_matchedfilterDAB7maxDERsE" title="find_matchedfilterDAB::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a>) for the <em>DAB</em> interpolation method (see <a class="reference internal" href="SIRENA.html#optimalfilter"><span class="std std-ref">optimal filter chapter</span></a>). It also selects the proper row from the column <strong>PAB</strong>.</p>
<p>It finds the two embracing <a class="reference internal" href="#_CPPv2N21find_matchedfilterDAB7maxDERsE" title="find_matchedfilterDAB::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the calibration library</p>
<blockquote>
<div><ul class="simple">
<li>If <a class="reference internal" href="#_CPPv2N21find_matchedfilterDAB6maxDERE" title="find_matchedfilterDAB::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is lower than the lowest <a class="reference internal" href="#_CPPv2N21find_matchedfilterDAB7maxDERsE" title="find_matchedfilterDAB::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The data with the lowest <a class="reference internal" href="#_CPPv2N21find_matchedfilterDAB7maxDERsE" title="find_matchedfilterDAB::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> (first row) in the library are chosen</li>
<li>If <a class="reference internal" href="#_CPPv2N21find_matchedfilterDAB6maxDERE" title="find_matchedfilterDAB::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is higher than the highest <a class="reference internal" href="#_CPPv2N21find_matchedfilterDAB7maxDERsE" title="find_matchedfilterDAB::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The data of the penultimate row in the library are chosen</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N21find_matchedfilterDAB12runF0orB0valE">
<span id="find_matchedfilterDAB::runF0orB0val__i"></span>int <code class="descclassname"></code><code class="descname">runF0orB0val</code><a class="headerlink" href="#_CPPv2N21find_matchedfilterDAB12runF0orB0valE" title="Permalink to this definition">¶</a></dt>
<dd><p>If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a> = <strong>F0</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N21find_matchedfilterDAB12runF0orB0valE" title="find_matchedfilterDAB::runF0orB0val"><code class="xref cpp cpp-member docutils literal"><span class="pre">runF0orB0val</span></code></a> = 1. If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a> = <strong>B0</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv2N21find_matchedfilterDAB12runF0orB0valE" title="find_matchedfilterDAB::runF0orB0val"><code class="xref cpp cpp-member docutils literal"><span class="pre">runF0orB0val</span></code></a> = 0</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_matchedfilterDAB6maxDERE">
<span id="find_matchedfilterDAB::maxDER__double"></span>double <code class="descclassname"></code><code class="descname">maxDER</code><a class="headerlink" href="#_CPPv2N21find_matchedfilterDAB6maxDERE" title="Permalink to this definition">¶</a></dt>
<dd><p>Max value of the derivative of the (filtered) pulse whose matched filter is being sought</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_matchedfilterDAB7maxDERsE">
<span id="find_matchedfilterDAB::maxDERs__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">maxDERs</code><a class="headerlink" href="#_CPPv2N21find_matchedfilterDAB7maxDERsE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the maximum values of the derivatives of the templates in the library to be compared with the pulse being analysed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_matchedfilterDAB16reconstruct_initE">
<span id="find_matchedfilterDAB::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N21find_matchedfilterDAB16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses the info in the library (<em>matched_filters</em>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_matchedfilterDAB18matchedfilterFoundE">
<span id="find_matchedfilterDAB::matchedfilterFound__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">matchedfilterFound</code><a class="headerlink" href="#_CPPv2N21find_matchedfilterDAB18matchedfilterFoundE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the matched filter selected</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_matchedfilterDAB8PabFoundE">
<span id="find_matchedfilterDAB::PabFound__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">PabFound</code><a class="headerlink" href="#_CPPv2N21find_matchedfilterDAB8PabFoundE" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>PAB</strong> column from the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_matchedfilterDAB6EalphaE">
<span id="find_matchedfilterDAB::Ealpha__doubleP"></span>double *<code class="descclassname"></code><code class="descname">Ealpha</code><a class="headerlink" href="#_CPPv2N21find_matchedfilterDAB6EalphaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy (in eV) which straddle the <a class="reference internal" href="#_CPPv2N21find_matchedfilterDAB6maxDERE" title="find_matchedfilterDAB::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the lower limit</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_matchedfilterDAB5EbetaE">
<span id="find_matchedfilterDAB::Ebeta__doubleP"></span>double *<code class="descclassname"></code><code class="descname">Ebeta</code><a class="headerlink" href="#_CPPv2N21find_matchedfilterDAB5EbetaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy (in eV) which straddle the <a class="reference internal" href="#_CPPv2N21find_matchedfilterDAB6maxDERE" title="find_matchedfilterDAB::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the higher limit</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv219find_model_energiesdP21ReconstructInitSIRENAPP10gsl_vector">
<span id="find_model_energies__double.ReconstructInitSIRENAP.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">find_model_energies</code><span class="sig-paren">(</span>double <em>energy</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, gsl_vector **<em>modelFound</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv219find_model_energiesdP21ReconstructInitSIRENAPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function uses <a class="reference internal" href="#_CPPv2N19find_model_energies6energyE" title="find_model_energies::energy"><code class="xref cpp cpp-member docutils literal"><span class="pre">energy</span></code></a> in order to choose the proper pulse template (<em>pulse_templates_B0</em>) of the calibration library.</p>
<p>In general, it finds the two energies wich straddle <a class="reference internal" href="#_CPPv2N19find_model_energies6energyE" title="find_model_energies::energy"><code class="xref cpp cpp-member docutils literal"><span class="pre">energy</span></code></a> in the calibration library and interpolates (<a class="reference internal" href="#_CPPv217interpolate_modelPP10gsl_vectordP10gsl_vectordP10gsl_vectord" title="interpolate_model"><code class="xref cpp cpp-func docutils literal"><span class="pre">interpolate_model()</span></code></a>):</p>
<blockquote>
<div><ul class="simple">
<li>If <a class="reference internal" href="#_CPPv2N19find_model_energies6energyE" title="find_model_energies::energy"><code class="xref cpp cpp-member docutils literal"><span class="pre">energy</span></code></a> is lower than the lowest energy in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The model with the lowest energy in the library is chosen</li>
<li>If <a class="reference internal" href="#_CPPv2N19find_model_energies6energyE" title="find_model_energies::energy"><code class="xref cpp cpp-member docutils literal"><span class="pre">energy</span></code></a> is higher than the highest energy in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The model with the highest energy in the library is chosen</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N19find_model_energies6energyE">
<span id="find_model_energies::energy__double"></span>double <code class="descclassname"></code><code class="descname">energy</code><a class="headerlink" href="#_CPPv2N19find_model_energies6energyE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy of the pulse whose pulse template is being sought</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N19find_model_energies16reconstruct_initE">
<span id="find_model_energies::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N19find_model_energies16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses the energies of the models (<em>energies</em>)
and their templates (<em>pulse_templates</em>), the number of templates in the library (<em>ntemplates</em>), the template duration (<em>template_duration</em>) and
the <em>pulse_templates_B0</em>.</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N19find_model_energies10modelFoundE">
<span id="find_model_energies::modelFound__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">modelFound</code><a class="headerlink" href="#_CPPv2N19find_model_energies10modelFoundE" title="Permalink to this definition">¶</a></dt>
<dd><p>Found template of the pulse whose energy is <a class="reference internal" href="#_CPPv2N19find_model_energies6energyE" title="find_model_energies::energy"><code class="xref cpp cpp-member docutils literal"><span class="pre">energy</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv218find_model_maxDERsdP21ReconstructInitSIRENAPP10gsl_vector">
<span id="find_model_maxDERs__double.ReconstructInitSIRENAP.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">find_model_maxDERs</code><span class="sig-paren">(</span>double <em>maxDER</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, gsl_vector **<em>modelFound</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv218find_model_maxDERsdP21ReconstructInitSIRENAPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function uses the maximum of the derivative of the (filtered) pulse (<a class="reference internal" href="#_CPPv2N18find_model_maxDERs6maxDERE" title="find_model_maxDERs::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a>) in order to choose the proper
pulse template (<em>pulse_templates_filder</em>) of the calibration library.</p>
<p>In general, it finds the two <em>maxDER</em> which straddle <a class="reference internal" href="#_CPPv2N18find_model_maxDERs6maxDERE" title="find_model_maxDERs::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the calibration library and interpolates (<a class="reference internal" href="#_CPPv217interpolate_modelPP10gsl_vectordP10gsl_vectordP10gsl_vectord" title="interpolate_model"><code class="xref cpp cpp-func docutils literal"><span class="pre">interpolate_model()</span></code></a>):</p>
<blockquote>
<div><ul class="simple">
<li>If <a class="reference internal" href="#_CPPv2N18find_model_maxDERs6maxDERE" title="find_model_maxDERs::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is lower than the lowest <em>maxDERs</em> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The model with
the lowest <em>maxDERs</em> in the library is chosen</li>
<li>If <a class="reference internal" href="#_CPPv2N18find_model_maxDERs6maxDERE" title="find_model_maxDERs::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is higher than the highest <em>maxDERs</em> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The model with
the highest <em>maxDERs</em> in the library is chosen</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N18find_model_maxDERs6maxDERE">
<span id="find_model_maxDERs::maxDER__double"></span>double <code class="descclassname"></code><code class="descname">maxDER</code><a class="headerlink" href="#_CPPv2N18find_model_maxDERs6maxDERE" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum of the derivative of the (filtered) pulse whose pulse template is being sought</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_model_maxDERs16reconstruct_initE">
<span id="find_model_maxDERs::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N18find_model_maxDERs16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses the number of templates in
the library (<em>ntemplates</em>), the template duration (<em>template_duration</em>), the filtered and differentiated templates (<em>pulse_templates_filder</em>)
and the <em>maxDERs</em> of the templates</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_model_maxDERs10modelFoundE">
<span id="find_model_maxDERs::modelFound__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">modelFound</code><a class="headerlink" href="#_CPPv2N18find_model_maxDERs10modelFoundE" title="Permalink to this definition">¶</a></dt>
<dd><p>Found template of the pulse whose maximum of the derivative of the filtered version is <a class="reference internal" href="#_CPPv2N18find_model_maxDERs6maxDERE" title="find_model_maxDERs::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv220find_model_samp1DERsdP21ReconstructInitSIRENAPP10gsl_vector">
<span id="find_model_samp1DERs__double.ReconstructInitSIRENAP.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">find_model_samp1DERs</code><span class="sig-paren">(</span>double <em>samp1DER</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, gsl_vector **<em>modelFound</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv220find_model_samp1DERsdP21ReconstructInitSIRENAPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function uses the 1st sample of the derivative of the filtered pulse (<a class="reference internal" href="#_CPPv2N20find_model_samp1DERs8samp1DERE" title="find_model_samp1DERs::samp1DER"><code class="xref cpp cpp-member docutils literal"><span class="pre">samp1DER</span></code></a>) in order to choose the proper pulse template (<em>pulse_templates_filder</em>) of the calibration library.</p>
<p>It finds the two <a class="reference internal" href="#_CPPv2N20find_model_samp1DERs8samp1DERE" title="find_model_samp1DERs::samp1DER"><code class="xref cpp cpp-member docutils literal"><span class="pre">samp1DER</span></code></a> closer in the calibration library and interpolates (<a class="reference internal" href="#_CPPv217interpolate_modelPP10gsl_vectordP10gsl_vectordP10gsl_vectord" title="interpolate_model"><code class="xref cpp cpp-func docutils literal"><span class="pre">interpolate_model()</span></code></a>)</p>
<blockquote>
<div><ul class="simple">
<li>If <a class="reference internal" href="#_CPPv2N20find_model_samp1DERs8samp1DERE" title="find_model_samp1DERs::samp1DER"><code class="xref cpp cpp-member docutils literal"><span class="pre">samp1DER</span></code></a> is lower than the lowest samp1DER in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The model with the lowest samp1DER in the library is chosen</li>
<li>If <a class="reference internal" href="#_CPPv2N20find_model_samp1DERs8samp1DERE" title="find_model_samp1DERs::samp1DER"><code class="xref cpp cpp-member docutils literal"><span class="pre">samp1DER</span></code></a> is higher than the highest samp1DER in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The model with the highest samp1DER in the library is chosen</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N20find_model_samp1DERs8samp1DERE">
<span id="find_model_samp1DERs::samp1DER__double"></span>double <code class="descclassname"></code><code class="descname">samp1DER</code><a class="headerlink" href="#_CPPv2N20find_model_samp1DERs8samp1DERE" title="Permalink to this definition">¶</a></dt>
<dd><p>1st sample of the derivative of the filtered pulse whose pulse template is being sought</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N20find_model_samp1DERs16reconstruct_initE">
<span id="find_model_samp1DERs::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N20find_model_samp1DERs16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses the 1st samples of the derivative of the models (<em>samp1DERs</em>) and their derived templates (<em>pulse_templates_filder</em>), the number of templates in the library (<em>ntemplates</em>) and the template duration (<em>template_duration</em>).</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N20find_model_samp1DERs10modelFoundE">
<span id="find_model_samp1DERs::modelFound__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">modelFound</code><a class="headerlink" href="#_CPPv2N20find_model_samp1DERs10modelFoundE" title="Permalink to this definition">¶</a></dt>
<dd><p>Found template of the pulse whose 1st sample of the derivative of the filtered pulse is <a class="reference internal" href="#_CPPv2N20find_model_samp1DERs8samp1DERE" title="find_model_samp1DERs::samp1DER"><code class="xref cpp cpp-member docutils literal"><span class="pre">samp1DER</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv218find_optimalfilterdP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPdPd">
<span id="find_optimalfilter__double.gsl_vectorP.ReconstructInitSIRENAP.gsl_vectorPP.doubleP.doubleP"></span>int <code class="descclassname"></code><code class="descname">find_optimalfilter</code><span class="sig-paren">(</span>double <em>maxDER</em>, gsl_vector *<em>maxDERs</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, gsl_vector **<em>optimalfilterFound</em>, double *<em>Ealpha</em>, double *<em>Ebeta</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv218find_optimalfilterdP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPdPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function selects the proper optimal filter from the calibration library (column <strong>OF</strong>) by comparing the maximum value of the pulse derivative (<a class="reference internal" href="#_CPPv2N18find_optimalfilter6maxDERE" title="find_optimalfilter::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a>) to the list of maximums in the library  (<a class="reference internal" href="#_CPPv2N18find_optimalfilter7maxDERsE" title="find_optimalfilter::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a>).</p>
<p>It finds the two embracing <a class="reference internal" href="#_CPPv2N18find_optimalfilter7maxDERsE" title="find_optimalfilter::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the calibration library and interpolates (<a class="reference internal" href="#_CPPv217interpolate_modelPP10gsl_vectordP10gsl_vectordP10gsl_vectord" title="interpolate_model"><code class="xref cpp cpp-func docutils literal"><span class="pre">interpolate_model()</span></code></a>)</p>
<blockquote>
<div><ul class="simple">
<li>If <a class="reference internal" href="#_CPPv2N18find_optimalfilter6maxDERE" title="find_optimalfilter::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is lower than the lowest <a class="reference internal" href="#_CPPv2N18find_optimalfilter7maxDERsE" title="find_optimalfilter::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The optimal filter with the lowest <a class="reference internal" href="#_CPPv2N18find_optimalfilter7maxDERsE" title="find_optimalfilter::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> (first row) in the library is chosen</li>
<li>If <a class="reference internal" href="#_CPPv2N18find_optimalfilter6maxDERE" title="find_optimalfilter::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is higher than the highest <a class="reference internal" href="#_CPPv2N18find_optimalfilter7maxDERsE" title="find_optimalfilter::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The optimal filter with the highest <a class="reference internal" href="#_CPPv2N18find_optimalfilter7maxDERsE" title="find_optimalfilter::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> (last row) in the library is chosen</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N18find_optimalfilter6maxDERE">
<span id="find_optimalfilter::maxDER__double"></span>double <code class="descclassname"></code><code class="descname">maxDER</code><a class="headerlink" href="#_CPPv2N18find_optimalfilter6maxDERE" title="Permalink to this definition">¶</a></dt>
<dd><p>Max value of the derivative of the (filtered) pulse whose optimal filter is being sought</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_optimalfilter7maxDERsE">
<span id="find_optimalfilter::maxDERs__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">maxDERs</code><a class="headerlink" href="#_CPPv2N18find_optimalfilter7maxDERsE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the maximum values of the derivatives of the templates in the library to be compared with the pulse being analysed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_optimalfilter16reconstruct_initE">
<span id="find_optimalfilter::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N18find_optimalfilter16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses the info
in the library (<em>optimal_filters</em>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_optimalfilter18optimalfilterFoundE">
<span id="find_optimalfilter::optimalfilterFound__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">optimalfilterFound</code><a class="headerlink" href="#_CPPv2N18find_optimalfilter18optimalfilterFoundE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the optimal filter selected</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_optimalfilter6EalphaE">
<span id="find_optimalfilter::Ealpha__doubleP"></span>double *<code class="descclassname"></code><code class="descname">Ealpha</code><a class="headerlink" href="#_CPPv2N18find_optimalfilter6EalphaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy (in eV) which straddle the <a class="reference internal" href="#_CPPv2N18find_optimalfilter6maxDERE" title="find_optimalfilter::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the lower limit</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18find_optimalfilter5EbetaE">
<span id="find_optimalfilter::Ebeta__doubleP"></span>double *<code class="descclassname"></code><code class="descname">Ebeta</code><a class="headerlink" href="#_CPPv2N18find_optimalfilter5EbetaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy (in eV) which straddle the <a class="reference internal" href="#_CPPv2N18find_optimalfilter6maxDERE" title="find_optimalfilter::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the higher limit</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv221find_optimalfilterDABdP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPP10gsl_vectorPdPd">
<span id="find_optimalfilterDAB__double.gsl_vectorP.ReconstructInitSIRENAP.gsl_vectorPP.gsl_vectorPP.doubleP.doubleP"></span>int <code class="descclassname"></code><code class="descname">find_optimalfilterDAB</code><span class="sig-paren">(</span>double <em>maxDER</em>, gsl_vector *<em>maxDERs</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, gsl_vector **<em>optimalfilterFound</em>, gsl_vector **<em>PabFound</em>, double *<em>Ealpha</em>, double *<em>Ebeta</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv221find_optimalfilterDABdP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPP10gsl_vectorPdPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function selects the proper optimal filter from the calibration library (column <strong>OFAB</strong>) by comparing the maximum value of the pulse derivative (<a class="reference internal" href="#_CPPv2N21find_optimalfilterDAB6maxDERE" title="find_optimalfilterDAB::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a>) to the list of maximums in the library  (<a class="reference internal" href="#_CPPv2N21find_optimalfilterDAB7maxDERsE" title="find_optimalfilterDAB::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a>). It also selects the proper row from the column <strong>PAB</strong>.</p>
<p>It finds the two embracing <a class="reference internal" href="#_CPPv2N21find_optimalfilterDAB7maxDERsE" title="find_optimalfilterDAB::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the calibration library</p>
<blockquote>
<div><ul class="simple">
<li>If <a class="reference internal" href="#_CPPv2N21find_optimalfilterDAB6maxDERE" title="find_optimalfilterDAB::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is lower than the lowest <a class="reference internal" href="#_CPPv2N21find_optimalfilterDAB7maxDERsE" title="find_optimalfilterDAB::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The data with the lowest <a class="reference internal" href="#_CPPv2N21find_optimalfilterDAB7maxDERsE" title="find_optimalfilterDAB::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> (first row) in the library are chosen</li>
<li>If <a class="reference internal" href="#_CPPv2N21find_optimalfilterDAB6maxDERE" title="find_optimalfilterDAB::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is higher than the highest <a class="reference internal" href="#_CPPv2N21find_optimalfilterDAB7maxDERsE" title="find_optimalfilterDAB::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The data of the penultimate row in the library are chosen</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N21find_optimalfilterDAB6maxDERE">
<span id="find_optimalfilterDAB::maxDER__double"></span>double <code class="descclassname"></code><code class="descname">maxDER</code><a class="headerlink" href="#_CPPv2N21find_optimalfilterDAB6maxDERE" title="Permalink to this definition">¶</a></dt>
<dd><p>Max value of the derivative of the (filtered) pulse whose optimal filter is being sought</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_optimalfilterDAB7maxDERsE">
<span id="find_optimalfilterDAB::maxDERs__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">maxDERs</code><a class="headerlink" href="#_CPPv2N21find_optimalfilterDAB7maxDERsE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the maximum values of the derivatives of the templates in the library to be compared with the pulse being analysed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_optimalfilterDAB16reconstruct_initE">
<span id="find_optimalfilterDAB::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N21find_optimalfilterDAB16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses the info
in the library (<em>optimal_filters</em>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_optimalfilterDAB18optimalfilterFoundE">
<span id="find_optimalfilterDAB::optimalfilterFound__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">optimalfilterFound</code><a class="headerlink" href="#_CPPv2N21find_optimalfilterDAB18optimalfilterFoundE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the optimal filter selected</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_optimalfilterDAB8PabFoundE">
<span id="find_optimalfilterDAB::PabFound__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">PabFound</code><a class="headerlink" href="#_CPPv2N21find_optimalfilterDAB8PabFoundE" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>PAB</strong> column from the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_optimalfilterDAB6EalphaE">
<span id="find_optimalfilterDAB::Ealpha__doubleP"></span>double *<code class="descclassname"></code><code class="descname">Ealpha</code><a class="headerlink" href="#_CPPv2N21find_optimalfilterDAB6EalphaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy (in eV) which straddle the <a class="reference internal" href="#_CPPv2N21find_optimalfilterDAB6maxDERE" title="find_optimalfilterDAB::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the lower limit</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N21find_optimalfilterDAB5EbetaE">
<span id="find_optimalfilterDAB::Ebeta__doubleP"></span>double *<code class="descclassname"></code><code class="descname">Ebeta</code><a class="headerlink" href="#_CPPv2N21find_optimalfilterDAB5EbetaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy (in eV) which straddle the <a class="reference internal" href="#_CPPv2N21find_optimalfilterDAB6maxDERE" title="find_optimalfilterDAB::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the higher limit</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv211find_prclwndP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPP10gsl_vectorPdPd">
<span id="find_prclwn__double.gsl_vectorP.ReconstructInitSIRENAP.gsl_vectorPP.gsl_vectorPP.doubleP.doubleP"></span>int <code class="descclassname"></code><code class="descname">find_prclwn</code><span class="sig-paren">(</span>double <em>maxDER</em>, gsl_vector *<em>maxDERs</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, gsl_vector **<em>PRCLWNFound</em>, gsl_vector **<em>PabFound</em>, double *<em>Ealpha</em>, double *<em>Ebeta</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv211find_prclwndP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPP10gsl_vectorPdPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>When <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>WEIGHTN</strong> this function selects the proper precalculated values (<strong>PRCLx</strong>) from the calibration library by comparing the maximum value of the pulse derivative (<a class="reference internal" href="#_CPPv2N11find_prclwn6maxDERE" title="find_prclwn::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a>) to the list of maximums in the library (<a class="reference internal" href="#_CPPv2N11find_prclwn7maxDERsE" title="find_prclwn::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a>) for the :option:<a href="#id2"><span class="problematic" id="id3">`</span></a>OFLib`=yes. It also selects the proper row from the column <strong>PAB</strong>.</p>
<p>It finds the two embracing <a class="reference internal" href="#_CPPv2N11find_prclwn7maxDERsE" title="find_prclwn::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the calibration library</p>
<blockquote>
<div><ul class="simple">
<li>If <a class="reference internal" href="#_CPPv2N11find_prclwn6maxDERE" title="find_prclwn::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is lower than the lowest <a class="reference internal" href="#_CPPv2N11find_prclwn7maxDERsE" title="find_prclwn::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The data with the lowest <a class="reference internal" href="#_CPPv2N11find_prclwn7maxDERsE" title="find_prclwn::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> (first row) in the library are chosen</li>
<li>If <a class="reference internal" href="#_CPPv2N11find_prclwn6maxDERE" title="find_prclwn::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> is higher than the highest <a class="reference internal" href="#_CPPv2N11find_prclwn7maxDERsE" title="find_prclwn::maxDERs"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDERs</span></code></a> in the library <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The data of the penultimate row in the library are chosen</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N11find_prclwn6maxDERE">
<span id="find_prclwn::maxDER__double"></span>double <code class="descclassname"></code><code class="descname">maxDER</code><a class="headerlink" href="#_CPPv2N11find_prclwn6maxDERE" title="Permalink to this definition">¶</a></dt>
<dd><p>Max value of the derivative of the (filtered) pulse whose optimal filter is being sought</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11find_prclwn7maxDERsE">
<span id="find_prclwn::maxDERs__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">maxDERs</code><a class="headerlink" href="#_CPPv2N11find_prclwn7maxDERsE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the maximum values of the derivatives of the templates in the library to be compared with the pulse being analysed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11find_prclwn16reconstruct_initE">
<span id="find_prclwn::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N11find_prclwn16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses the info in the library (<em>PRECALWN</em>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11find_prclwn11PRCLWNFoundE">
<span id="find_prclwn::PRCLWNFound__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">PRCLWNFound</code><a class="headerlink" href="#_CPPv2N11find_prclwn11PRCLWNFoundE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the optimal filter selected</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11find_prclwn8PabFoundE">
<span id="find_prclwn::PabFound__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">PabFound</code><a class="headerlink" href="#_CPPv2N11find_prclwn8PabFoundE" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>PAB</strong> column from the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11find_prclwn6EalphaE">
<span id="find_prclwn::Ealpha__doubleP"></span>double *<code class="descclassname"></code><code class="descname">Ealpha</code><a class="headerlink" href="#_CPPv2N11find_prclwn6EalphaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy (in eV) which straddle the <a class="reference internal" href="#_CPPv2N11find_prclwn6maxDERE" title="find_prclwn::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the lower limit</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11find_prclwn5EbetaE">
<span id="find_prclwn::Ebeta__doubleP"></span>double *<code class="descclassname"></code><code class="descname">Ebeta</code><a class="headerlink" href="#_CPPv2N11find_prclwn5EbetaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy (in eV) which straddle the <a class="reference internal" href="#_CPPv2N11find_prclwn6maxDERE" title="find_prclwn::maxDER"><code class="xref cpp cpp-member docutils literal"><span class="pre">maxDER</span></code></a> in the higher limit</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv223freeOptimalFilterSIRENAP19OptimalFilterSIRENA">
<span id="freeOptimalFilterSIRENA__OptimalFilterSIRENAP"></span>extern_C_void <code class="descclassname"></code><code class="descname">freeOptimalFilterSIRENA</code><span class="sig-paren">(</span>OptimalFilterSIRENA *<em>OFilterColl</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv223freeOptimalFilterSIRENAP19OptimalFilterSIRENA" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>integraSIRENA.cpp</em></p>
<p>Destructor of <em>OptimalFilterSIRENA</em> structure.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N23freeOptimalFilterSIRENA11OFilterCollE">
<span id="freeOptimalFilterSIRENA::OFilterColl__OptimalFilterSIRENAP"></span>OptimalFilterSIRENA *<code class="descclassname"></code><code class="descname">OFilterColl</code><a class="headerlink" href="#_CPPv2N23freeOptimalFilterSIRENA11OFilterCollE" title="Permalink to this definition">¶</a></dt>
<dd><p>Instance of <em>OptimalFilterSIRENA</em> structure</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv225freeReconstructInitSIRENAP21ReconstructInitSIRENA">
<span id="freeReconstructInitSIRENA__ReconstructInitSIRENAP"></span>extern_C_void <code class="descclassname"></code><code class="descname">freeReconstructInitSIRENA</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv225freeReconstructInitSIRENAP21ReconstructInitSIRENA" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>integraSIRENA.cpp</em></p>
<p>Destructor of <em>ReconstructInitSIRENA</em> structure.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N25freeReconstructInitSIRENA16reconstruct_initE">
<span id="freeReconstructInitSIRENA::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N25freeReconstructInitSIRENA16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Instance of <em>ReconstructInitSIRENA</em> structure</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv220freePulsesCollectionP16PulsesCollection">
<span id="freePulsesCollection__PulsesCollectionP"></span>extern_C_void <code class="descclassname"></code><code class="descname">freePulsesCollection</code><span class="sig-paren">(</span>PulsesCollection *<em>PulsesColl</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv220freePulsesCollectionP16PulsesCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>integraSIRENA.cpp</em></p>
<p>Destructor of <em>PulsesCollection</em> structure.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N20freePulsesCollection10PulsesCollE">
<span id="freePulsesCollection::PulsesColl__PulsesCollectionP"></span>PulsesCollection *<code class="descclassname"></code><code class="descname">PulsesColl</code><a class="headerlink" href="#_CPPv2N20freePulsesCollection10PulsesCollE" title="Permalink to this definition">¶</a></dt>
<dd><p>Instance of <em>PulsesCollection</em> structure</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv213fromGslMatrixPPvPP10gsl_matrixi">
<span id="fromGslMatrix__voidPP.gsl_matrixPP.i"></span>int <code class="descclassname"></code><code class="descname">fromGslMatrix</code><span class="sig-paren">(</span>void **<em>buffer</em>, gsl_matrix **<em>matrix</em>, int <em>type</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv213fromGslMatrixPPvPP10gsl_matrixi" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>inoututils.cpp</em></p>
<p>The function puts the values of the input GSL matrix into an output buffer.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N13fromGslMatrix6bufferE">
<span id="fromGslMatrix::buffer__voidPP"></span>void **<code class="descclassname"></code><code class="descname">buffer</code><a class="headerlink" href="#_CPPv2N13fromGslMatrix6bufferE" title="Permalink to this definition">¶</a></dt>
<dd><p>Output buffer</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv213fromGslVectorPPvPP10gsl_vectori">
<span id="fromGslVector__voidPP.gsl_vectorPP.i"></span>int <code class="descclassname"></code><code class="descname">fromGslVector</code><span class="sig-paren">(</span>void **<em>buffer</em>, gsl_vector **<em>array</em>, int <em>type</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv213fromGslVectorPPvPP10gsl_vectori" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>inoututils.cpp</em></p>
<p>The function puts the values of the input GSL vector into an output buffer.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N13fromGslVector6bufferE">
<span id="fromGslVector::buffer__voidPP"></span>void **<code class="descclassname"></code><code class="descname">buffer</code><a class="headerlink" href="#_CPPv2N13fromGslVector6bufferE" title="Permalink to this definition">¶</a></dt>
<dd><p>Output buffer</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13fromGslVector5arrayE">
<span id="fromGslVector::array__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">array</code><a class="headerlink" href="#_CPPv2N13fromGslVector5arrayE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL vector</p>
</dd></dl>

<p>. cpp:member:: int type</p>
<blockquote>
<div>FITS type (TINT, TSHORT, TDOUBLE, etc.)</div></blockquote>
</dd></dl>

<span class="target" id="g"></span><dl class="function">
<dt id="_CPPv24getBP10gsl_vectorP10gsl_vectoriPP10gsl_vectoriPP10gsl_vector">
<span id="getB__gsl_vectorP.gsl_vectorP.i.gsl_vectorPP.i.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">getB</code><span class="sig-paren">(</span>gsl_vector *<em>vectorin</em>, gsl_vector *<em>tstart</em>, int <em>nPulses</em>, gsl_vector **<em>lb</em>, int <em>sizepulse</em>, gsl_vector **<em>B</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv24getBP10gsl_vectorP10gsl_vectoriPP10gsl_vectoriPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function calculates the sum, <a class="reference internal" href="#_CPPv2N4getB1BE" title="getB::B"><code class="xref cpp cpp-member docutils literal"><span class="pre">B</span></code></a>, of <a class="reference internal" href="#_CPPv2N4getB2lbE" title="getB::lb"><code class="xref cpp cpp-member docutils literal"><span class="pre">lb</span></code></a> digitized data samples of a pulse-free interval immediately
before each pulse. If the pulse-free interval before the current pulse is lower than <a class="reference internal" href="#_CPPv2N4getB2lbE" title="getB::lb"><code class="xref cpp cpp-member docutils literal"><span class="pre">lb</span></code></a>, <a class="reference internal" href="#_CPPv2N4getB1BE" title="getB::B"><code class="xref cpp cpp-member docutils literal"><span class="pre">B</span></code></a> is calculated with the available
number of samples. If there is not a pulse-free interval before the pulse, it is looked for it after the current pulse.
The number of samples of the pulse-free interval used to calculate <a class="reference internal" href="#_CPPv2N4getB1BE" title="getB::B"><code class="xref cpp cpp-member docutils literal"><span class="pre">B</span></code></a> is stored in the <a class="reference internal" href="#_CPPv2N4getB2lbE" title="getB::lb"><code class="xref cpp cpp-member docutils literal"><span class="pre">lb</span></code></a> vector.</p>
<p>Steps:</p>
<p>First of all, the auxiliary variable <em>Baux</em> is initialized to -999 and all the elements of the <a class="reference internal" href="#_CPPv2N4getB2lbE" title="getB::lb"><code class="xref cpp cpp-member docutils literal"><span class="pre">lb</span></code></a> vector are equal to the <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LbT"><code class="xref std std-option docutils literal"><span class="pre">LbT</span></code></a> input parameter in samples.
Then, the code is divided into 2 <em>if</em> statements:</p>
<ul class="simple">
<li>When the current pulse is the first pulse into the record:<ul>
<li><img class="math" src="_images/math/42cbb2c70e67265ae97ec355fdb91a9f98d573df.png" alt="tstart \geq lb"/> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Sum <em>lb</em> samples</li>
<li><img class="math" src="_images/math/a972e858314f63e847e1ac6b993a6d09e9e4f406.png" alt="0&lt;tstart&lt;lb"/> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Sum the available number of samples (although the available number of samples was lower than <em>lb</em>)</li>
<li><img class="math" src="_images/math/4edaaf395d89da6a96c010a2fac5e90730d1ae7e.png" alt="tstart=0"/> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> If there is not a pulse-free interval before the pulse, it is looked for it after the current pulse</li>
</ul>
</li>
<li>When the current pulse is not the first pulse into the record:<ul>
<li><img class="math" src="_images/math/7ba5ec28d216307dd2d7b83f3705694e9b36c9b7.png" alt="tstart_i-tend_{i-1} \geq lb"/> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Sum lb samples</li>
<li><img class="math" src="_images/math/3860626e86fd3486f1d1b31010fe622710d4257b.png" alt="0&lt;tstart_i-tend{i-1}&lt;lb"/> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Sum the available number of samples (although the available number of samples was lower than <em>lb</em>)</li>
<li>If there is not a pulse-free interval before the pulse, it is looked for it after the current pulse</li>
</ul>
</li>
</ul>
<p>If <em>Baux</em> is still -999, a pulse-free interval can not be found to apply the running sum filter. This has to be taken into account,
out of the function, to try to get a usable <a class="reference internal" href="#_CPPv2N4getB1BE" title="getB::B"><code class="xref cpp cpp-member docutils literal"><span class="pre">B</span></code></a>.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N4getB8vectorinE">
<span id="getB::vectorin__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">vectorin</code><a class="headerlink" href="#_CPPv2N4getB8vectorinE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4getB6tstartE">
<span id="getB::tstart__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">tstart</code><a class="headerlink" href="#_CPPv2N4getB6tstartE" title="Permalink to this definition">¶</a></dt>
<dd><p>Starting time of the pulses into the record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4getB7nPulsesE">
<span id="getB::nPulses__i"></span>int <code class="descclassname"></code><code class="descname">nPulses</code><a class="headerlink" href="#_CPPv2N4getB7nPulsesE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of pulses into the record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4getB2lbE">
<span id="getB::lb__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">lb</code><a class="headerlink" href="#_CPPv2N4getB2lbE" title="Permalink to this definition">¶</a></dt>
<dd><p>Vector containing the baseline averaging length used for each pulse</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4getB9sizepulseE">
<span id="getB::sizepulse__i"></span>int <code class="descclassname"></code><code class="descname">sizepulse</code><a class="headerlink" href="#_CPPv2N4getB9sizepulseE" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of the pulse in samples</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N4getB1BE">
<span id="getB::B__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">B</code><a class="headerlink" href="#_CPPv2N4getB1BE" title="Permalink to this definition">¶</a></dt>
<dd><p>In general, sum of the <em>Lb</em> digitized data samples (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LbT"><code class="xref std std-option docutils literal"><span class="pre">LbT</span></code></a> input parameters in samples) of a pulse-free interval immediately before the current pulse</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv220getLibraryCollectionPCKciPcPccPPcPCi">
<span id="getLibraryCollection__cCPC.i.cP.cP.c.cPP.iPC"></span>LibraryCollection *<code class="descclassname"></code><code class="descname">getLibraryCollection</code><span class="sig-paren">(</span><em class="property">const</em> char *<em class="property">const</em> <em>filename</em>, int <em>mode</em>, char *<em>energy_method</em>, char *<em>filter_method</em>, char <em>oflib</em>, char **<em>ofinterp</em>, int *<em class="property">const</em> <em>status</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv220getLibraryCollectionPCKciPcPccPPcPCi" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>integraSIRENA.cpp</em></p>
<p>This function creates and retrieves a <em>LibraryCollection</em> from a file.</p>
<ul class="simple">
<li>Create <em>LibraryCollection</em> structure</li>
<li>Open FITS file in READONLY mode (move to the first HDU) and get number of templates (rows)</li>
<li>Allocate library structure</li>
<li>Get PULSE and MF column numbers (depending the different options)</li>
<li>Get template duration</li>
<li>Allocate library structure (cont.)</li>
<li>Get matched filter duration</li>
<li>Read different columns and populate the <em>LibraryCollection</em> structure</li>
<li>Added new code to handle the new HDUs <strong>FIXFILTF</strong>, <strong>FIXFILTT</strong> and <strong>PRECALWN</strong></li>
<li>Free allocated GSL vectors and matrices</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N20getLibraryCollection4modeE">
<span id="getLibraryCollection::mode__i"></span>int <code class="descclassname"></code><code class="descname">mode</code><a class="headerlink" href="#_CPPv2N20getLibraryCollection4modeE" title="Permalink to this definition">¶</a></dt>
<dd><p>Calibration run (0) or energy reconstruction run (1), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N20getLibraryCollection13energy_methodE">
<span id="getLibraryCollection::energy_method__cP"></span>char *<code class="descclassname"></code><code class="descname">energy_method</code><a class="headerlink" href="#_CPPv2N20getLibraryCollection13energy_methodE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy calculation Method: <strong>OPTFILT</strong>, <strong>WEIGHT</strong>, <strong>WEIGHTN</strong>, <strong>I2R</strong>, <strong>I2RALL</strong>, <strong>I2RNOL</strong> or <strong>I2RFITTED</strong>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N20getLibraryCollection13filter_methodE">
<span id="getLibraryCollection::filter_method__cP"></span>char *<code class="descclassname"></code><code class="descname">filter_method</code><a class="headerlink" href="#_CPPv2N20getLibraryCollection13filter_methodE" title="Permalink to this definition">¶</a></dt>
<dd><p>Filtering Method: <strong>F0</strong> (deleting the zero frequency bin) or <strong>B0</strong> (deleting the baseline), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N20getLibraryCollection8ofinterpE">
<span id="getLibraryCollection::ofinterp__cPP"></span>char **<code class="descclassname"></code><code class="descname">ofinterp</code><a class="headerlink" href="#_CPPv2N20getLibraryCollection8ofinterpE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal Filter by using the Matched Filter or the DAB as matched filter (<em>MF</em>/<em>DAB</em>)
It has been fixed in &#8216;<a class="reference internal" href="SIRENAcommandline.html#tesreconstruction"><span class="std std-ref">tesreconstruction</span></a> as <em>DAB</em> (but it would be possible to work with <em>MF</em>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N20getLibraryCollection6statusE">
<span id="getLibraryCollection::status__iPC"></span>int *<em class="property">const</em> <code class="descclassname"></code><code class="descname">status</code><a class="headerlink" href="#_CPPv2N20getLibraryCollection6statusE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output status</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv212getNoiseSpecPCKciPcPcPCi">
<span id="getNoiseSpec__cCPC.i.cP.cP.iPC"></span>NoiseSpec *<code class="descclassname"></code><code class="descname">getNoiseSpec</code><span class="sig-paren">(</span><em class="property">const</em> char *<em class="property">const</em> <em>filename</em>, int <em>mode</em>, char *<em>energy_method</em>, char *<em>filter_method</em>, int *<em class="property">const</em> <em>status</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv212getNoiseSpecPCKciPcPcPCi" title="Permalink to this definition">¶</a></dt>
<dd><p>Located  in file: <em>integraSIRENA.cpp</em></p>
<p>This function creates and retrieves a <em>NoiseSpec</em> from a file.</p>
<ul class="simple">
<li>Create <em>NoiseSpec</em> structure</li>
<li>Open FITS file, move to the NOISE and NOISEALL HDUs and get interesting keywords</li>
<li>Allocate <em>NoiseSpec</em> structure</li>
<li>Get noise spectrum (CSD), and noise frequencies (FREQ) column numbers</li>
<li>Read column CSD and save it into the structure</li>
<li>Read column FREQ and save it into the structure</li>
<li>Return noise spectrum</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N12getNoiseSpec8filenameE">
<span id="getNoiseSpec::filename__cCPC"></span><em class="property">const</em> char *<em class="property">const</em> <code class="descclassname"></code><code class="descname">filename</code><a class="headerlink" href="#_CPPv2N12getNoiseSpec8filenameE" title="Permalink to this definition">¶</a></dt>
<dd><p>File name with noise</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12getNoiseSpec4modeE">
<span id="getNoiseSpec::mode__i"></span>int <code class="descclassname"></code><code class="descname">mode</code><a class="headerlink" href="#_CPPv2N12getNoiseSpec4modeE" title="Permalink to this definition">¶</a></dt>
<dd><p>Calibration run (0) or energy reconstruction run (1), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12getNoiseSpec13energy_methodE">
<span id="getNoiseSpec::energy_method__cP"></span>char *<code class="descclassname"></code><code class="descname">energy_method</code><a class="headerlink" href="#_CPPv2N12getNoiseSpec13energy_methodE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy calculation Method: <strong>OPTFILT</strong>, <strong>WEIGHT</strong>, <strong>WEIGHTN</strong>, <strong>I2R</strong>, <strong>I2RALL</strong>, <strong>I2RNOL</strong>, <strong>I2RFITTED</strong> or <strong>PCA</strong>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12getNoiseSpec13filter_methodE">
<span id="getNoiseSpec::filter_method__cP"></span>char *<code class="descclassname"></code><code class="descname">filter_method</code><a class="headerlink" href="#_CPPv2N12getNoiseSpec13filter_methodE" title="Permalink to this definition">¶</a></dt>
<dd><p>Filtering Method: <strong>F0</strong> (deleting the zero frequency bin) or <strong>B0</strong> (deleting the baseline), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12getNoiseSpec6statusE">
<span id="getNoiseSpec::status__iPC"></span>int *<em class="property">const</em> <code class="descclassname"></code><code class="descname">status</code><a class="headerlink" href="#_CPPv2N12getNoiseSpec6statusE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/Output status</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv214getPulseHeightP10gsl_vectorddidddiPd">
<span id="getPulseHeight__gsl_vectorP.double.double.i.double.double.double.i.doubleP"></span>int <code class="descclassname"></code><code class="descname">getPulseHeight</code><span class="sig-paren">(</span>gsl_vector *<em>vectorin</em>, double <em>tstart</em>, double <em>tstartnext</em>, int <em>lastPulse</em>, double <em>lrs</em>, double <em>lb</em>, double <em>B</em>, int <em>sizepulse</em>, double *<em>pulseheight</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv214getPulseHeightP10gsl_vectorddidddiPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located  in file: <em>pulseprocess.cpp</em></p>
<p>This function estimates the pulse height of a pulse by using a running sum filter. It extracts from the record, <a class="reference internal" href="#_CPPv2N14getPulseHeight8vectorinE" title="getPulseHeight::vectorin"><code class="xref cpp cpp-member docutils literal"><span class="pre">vectorin</span></code></a>, the pulse whose
pulse height is going to be estimated by using <a class="reference internal" href="#_CPPv29RS_filterP10gsl_vectordddPd" title="RS_filter"><code class="xref cpp cpp-func docutils literal"><span class="pre">RS_filter()</span></code></a>.</p>
<p>Steps:</p>
<ul class="simple">
<li>Declare variables</li>
<li>Extracting from the record the pulse whose pulse height is going to be estimated</li>
<li>Apply the running sum filter</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N14getPulseHeight8vectorinE">
<span id="getPulseHeight::vectorin__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">vectorin</code><a class="headerlink" href="#_CPPv2N14getPulseHeight8vectorinE" title="Permalink to this definition">¶</a></dt>
<dd><p>Not filtered record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14getPulseHeight6tstartE">
<span id="getPulseHeight::tstart__double"></span>double <code class="descclassname"></code><code class="descname">tstart</code><a class="headerlink" href="#_CPPv2N14getPulseHeight6tstartE" title="Permalink to this definition">¶</a></dt>
<dd><p>Starting time of the pulse whose pulse height is going to be estimated</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14getPulseHeight10tstartnextE">
<span id="getPulseHeight::tstartnext__double"></span>double <code class="descclassname"></code><code class="descname">tstartnext</code><a class="headerlink" href="#_CPPv2N14getPulseHeight10tstartnextE" title="Permalink to this definition">¶</a></dt>
<dd><p>Starting time of the next pulse whose pulse height is going to be estimated</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14getPulseHeight9lastPulseE">
<span id="getPulseHeight::lastPulse__i"></span>int <code class="descclassname"></code><code class="descname">lastPulse</code><a class="headerlink" href="#_CPPv2N14getPulseHeight9lastPulseE" title="Permalink to this definition">¶</a></dt>
<dd><p>It is 1 if the pulse is the last one into the record or the only one</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14getPulseHeight3lrsE">
<span id="getPulseHeight::lrs__double"></span>double <code class="descclassname"></code><code class="descname">lrs</code><a class="headerlink" href="#_CPPv2N14getPulseHeight3lrsE" title="Permalink to this definition">¶</a></dt>
<dd><p>Running sum length (equal to the <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LrsT"><code class="xref std std-option docutils literal"><span class="pre">LrsT</span></code></a> input parameter in samples)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14getPulseHeight2lbE">
<span id="getPulseHeight::lb__double"></span>double <code class="descclassname"></code><code class="descname">lb</code><a class="headerlink" href="#_CPPv2N14getPulseHeight2lbE" title="Permalink to this definition">¶</a></dt>
<dd><p>Baseline averaging length used for the pulse whose pulse height is going to be estimated</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14getPulseHeight1BE">
<span id="getPulseHeight::B__double"></span>double <code class="descclassname"></code><code class="descname">B</code><a class="headerlink" href="#_CPPv2N14getPulseHeight1BE" title="Permalink to this definition">¶</a></dt>
<dd><p>In general, sum of the <em>Lb</em> digitized data samples (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LbT"><code class="xref std std-option docutils literal"><span class="pre">LbT</span></code></a> input parameters in samples) of a pulse-free interval immediately before the current pulse</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14getPulseHeight9sizepulseE">
<span id="getPulseHeight::sizepulse__i"></span>int <code class="descclassname"></code><code class="descname">sizepulse</code><a class="headerlink" href="#_CPPv2N14getPulseHeight9sizepulseE" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of the pulse in samples</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14getPulseHeight11pulseheightE">
<span id="getPulseHeight::pulseheight__doubleP"></span>double *<code class="descclassname"></code><code class="descname">pulseheight</code><a class="headerlink" href="#_CPPv2N14getPulseHeight11pulseheightE" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimated pulse height of the pulse</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv226gsl_vector_complex_absIFCAP10gsl_vectorP18gsl_vector_complex">
<span id="gsl_vector_complex_absIFCA__gsl_vectorP.gsl_vector_complexP"></span>void <code class="descclassname"></code><code class="descname">gsl_vector_complex_absIFCA</code><span class="sig-paren">(</span>gsl_vector *<em>cvnew</em>, gsl_vector_complex *<em>cv</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv226gsl_vector_complex_absIFCAP10gsl_vectorP18gsl_vector_complex" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>genutils.cpp</em></p>
<p>This function calculates the magnitude of the complex elements of a vector (real part).</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N26gsl_vector_complex_absIFCA2cvE">
<span id="gsl_vector_complex_absIFCA::cv__gsl_vector_complexP"></span>gsl_vector_complex *<code class="descclassname"></code><code class="descname">cv</code><a class="headerlink" href="#_CPPv2N26gsl_vector_complex_absIFCA2cvE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL complex vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N26gsl_vector_complex_absIFCA5cvnewE">
<span id="gsl_vector_complex_absIFCA::cvnew__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">cvnew</code><a class="headerlink" href="#_CPPv2N26gsl_vector_complex_absIFCA5cvnewE" title="Permalink to this definition">¶</a></dt>
<dd><p>Output GSL vector with the absolute values of the elements of <a class="reference internal" href="#_CPPv2N26gsl_vector_complex_absIFCA2cvE" title="gsl_vector_complex_absIFCA::cv"><code class="xref cpp cpp-member docutils literal"><span class="pre">cv</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv226gsl_vector_complex_argIFCAP10gsl_vectorP18gsl_vector_complex">
<span id="gsl_vector_complex_argIFCA__gsl_vectorP.gsl_vector_complexP"></span>void <code class="descclassname"></code><code class="descname">gsl_vector_complex_argIFCA</code><span class="sig-paren">(</span>gsl_vector *<em>varg</em>, gsl_vector_complex *<em>vin</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv226gsl_vector_complex_argIFCAP10gsl_vectorP18gsl_vector_complex" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>genutils.cpp</em></p>
<p>This function calculates the arguments of the complex elements of a vector.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N26gsl_vector_complex_argIFCA3vinE">
<span id="gsl_vector_complex_argIFCA::vin__gsl_vector_complexP"></span>gsl_vector_complex *<code class="descclassname"></code><code class="descname">vin</code><a class="headerlink" href="#_CPPv2N26gsl_vector_complex_argIFCA3vinE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL complex vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N26gsl_vector_complex_argIFCA4vargE">
<span id="gsl_vector_complex_argIFCA::varg__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">varg</code><a class="headerlink" href="#_CPPv2N26gsl_vector_complex_argIFCA4vargE" title="Permalink to this definition">¶</a></dt>
<dd><p>Output GSL vector with the arguments of the elements of <a class="reference internal" href="#_CPPv2N26gsl_vector_complex_argIFCA3vinE" title="gsl_vector_complex_argIFCA::vin"><code class="xref cpp cpp-member docutils literal"><span class="pre">vin</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv228gsl_vector_complex_scaleIFCAP18gsl_vector_complex11gsl_complex">
<span id="gsl_vector_complex_scaleIFCA__gsl_vector_complexP.gsl_complex"></span>void <code class="descclassname"></code><code class="descname">gsl_vector_complex_scaleIFCA</code><span class="sig-paren">(</span>gsl_vector_complex *<em>cv</em>, gsl_complex <em>z</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv228gsl_vector_complex_scaleIFCAP18gsl_vector_complex11gsl_complex" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>genutils.cpp</em></p>
<p>This function multiplies the complex elements of a vector by a complex number.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N28gsl_vector_complex_scaleIFCA2cvE">
<span id="gsl_vector_complex_scaleIFCA::cv__gsl_vector_complexP"></span>gsl_vector_complex *<code class="descclassname"></code><code class="descname">cv</code><a class="headerlink" href="#_CPPv2N28gsl_vector_complex_scaleIFCA2cvE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/Output (scaled) GSL complex vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N28gsl_vector_complex_scaleIFCA1zE">
<span id="gsl_vector_complex_scaleIFCA::z__gsl_complex"></span>gsl_complex <code class="descclassname"></code><code class="descname">z</code><a class="headerlink" href="#_CPPv2N28gsl_vector_complex_scaleIFCA1zE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL complex number</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv219gsl_vector_sqrtIFCAP10gsl_vectorP10gsl_vector">
<span id="gsl_vector_sqrtIFCA__gsl_vectorP.gsl_vectorP"></span>void <code class="descclassname"></code><code class="descname">gsl_vector_sqrtIFCA</code><span class="sig-paren">(</span>gsl_vector *<em>cvnew</em>, gsl_vector *<em>cv</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv219gsl_vector_sqrtIFCAP10gsl_vectorP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>genutils.cpp</em></p>
<p>This function calculates the square root of the elements of a vector.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N19gsl_vector_sqrtIFCA2cvE">
<span id="gsl_vector_sqrtIFCA::cv__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">cv</code><a class="headerlink" href="#_CPPv2N19gsl_vector_sqrtIFCA2cvE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL complex vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N19gsl_vector_sqrtIFCA5cvnewE">
<span id="gsl_vector_sqrtIFCA::cvnew__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">cvnew</code><a class="headerlink" href="#_CPPv2N19gsl_vector_sqrtIFCA5cvnewE" title="Permalink to this definition">¶</a></dt>
<dd><p>Output GSL vector with the square root values of the elements of <a class="reference internal" href="#_CPPv2N19gsl_vector_sqrtIFCA2cvE" title="gsl_vector_sqrtIFCA::cv"><code class="xref cpp cpp-member docutils literal"><span class="pre">cv</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv223gsl_vector_SumsubvectorP10gsl_vectorllPd">
<span id="gsl_vector_Sumsubvector__gsl_vectorP.l.l.doubleP"></span>int <code class="descclassname"></code><code class="descname">gsl_vector_Sumsubvector</code><span class="sig-paren">(</span>gsl_vector *<em>invector</em>, long <em>offset</em>, long <em>n</em>, double *<em>sum</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv223gsl_vector_SumsubvectorP10gsl_vectorllPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>genutils.cpp</em></p>
<p>This function returns the sum of some elements of the input vector.</p>
<p>The starting element of the sum is <a class="reference internal" href="#_CPPv2N23gsl_vector_Sumsubvector6offsetE" title="gsl_vector_Sumsubvector::offset"><code class="xref cpp cpp-member docutils literal"><span class="pre">offset</span></code></a> from the start of the input vector. It will sum up <a class="reference internal" href="#_CPPv2N23gsl_vector_Sumsubvector1nE" title="gsl_vector_Sumsubvector::n"><code class="xref cpp cpp-member docutils literal"><span class="pre">n</span></code></a> elements.</p>
<p><a class="reference internal" href="#_CPPv2N23gsl_vector_Sumsubvector6offsetE" title="gsl_vector_Sumsubvector::offset"><code class="xref cpp cpp-member docutils literal"><span class="pre">offset</span></code></a> can take values from 0 to <em>invector-&gt;size</em></p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N23gsl_vector_Sumsubvector8invectorE">
<span id="gsl_vector_Sumsubvector::invector__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">invector</code><a class="headerlink" href="#_CPPv2N23gsl_vector_Sumsubvector8invectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N23gsl_vector_Sumsubvector6offsetE">
<span id="gsl_vector_Sumsubvector::offset__l"></span>long <code class="descclassname"></code><code class="descname">offset</code><a class="headerlink" href="#_CPPv2N23gsl_vector_Sumsubvector6offsetE" title="Permalink to this definition">¶</a></dt>
<dd><p>It is the first element to be summed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N23gsl_vector_Sumsubvector1nE">
<span id="gsl_vector_Sumsubvector::n__l"></span>long <code class="descclassname"></code><code class="descname">n</code><a class="headerlink" href="#_CPPv2N23gsl_vector_Sumsubvector1nE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of elements in the sum</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N23gsl_vector_Sumsubvector3sumE">
<span id="gsl_vector_Sumsubvector::sum__doubleP"></span>double *<code class="descclassname"></code><code class="descname">sum</code><a class="headerlink" href="#_CPPv2N23gsl_vector_Sumsubvector3sumE" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculated output value (sum of the corresponding elements)</p>
</dd></dl>

</dd></dl>

<span class="target" id="i"><span id="h"></span></span><dl class="function">
<dt id="_CPPv230initializeReconstructionSIRENAP21ReconstructInitSIRENAPCcP8fitsfilePCcPCcidddiddPCcPcPcPciicPcPcidiPCcPCccidiiiddPCcPCi">
<span id="initializeReconstructionSIRENA__ReconstructInitSIRENAP.cPC.fitsfileP.cPC.cPC.i.double.double.double.i.double.double.cPC.cP.cP.cP.i.i.c.cP.cP.i.double.i.cPC.cPC.c.i.double.i.i.i.double.double.cPC.iPC"></span>extern_C_void <code class="descclassname"></code><code class="descname">initializeReconstructionSIRENA</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em>, char *<em class="property">const</em> <em>record_file</em>, fitsfile *<em>fptr</em>, char *<em class="property">const</em> <em>library_file</em>, char *<em class="property">const</em> <em>event_file</em>, int <em>pulse_length</em>, double <em>scaleFactor</em>, double <em>samplesUp</em>, double <em>nSgms</em>, int <em>mode</em>, double <em>LrsT</em>, double <em>LbT</em>, char *<em class="property">const</em> <em>noise_file</em>, char *<em>filter_domain</em>, char *<em>filter_method</em>, char *<em>energy_method</em>, int <em>lagsornot</em>, int <em>ofiter</em>, char <em>oflib</em>, char *<em>ofinterp</em>, char *<em>oflength_strategy</em>, int <em>oflength</em>, double <em>monoenergy</em>, int <em>interm</em>, char *<em class="property">const</em> <em>detectFile</em>, char *<em class="property">const</em> <em>filterFile</em>, char <em>clobber</em>, int <em>maxPulsesPerRecord</em>, double <em>SaturationValue</em>, int <em>tstartPulse1</em>, int <em>tstartPulse2</em>, int <em>tstartPulse3</em>, double <em>energyPCA1</em>, double <em>energyPCA2</em>, char *<em class="property">const</em> <em>XMLFile</em>, int *<em class="property">const</em> <em>status</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv230initializeReconstructionSIRENAP21ReconstructInitSIRENAPCcP8fitsfilePCcPCcidddiddPCcPcPcPciicPcPcidiPCcPCccidiiiddPCcPCi" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>integraSIRENA.cpp</em></p>
<p>This function initializes the structure <em>ReconstructInitSIRENA</em> with the variables required for SIRENA reconstruction. The values are taken from the input parameters.</p>
<ul class="simple">
<li>Load <em>LibraryCollection</em> structure if library file exists</li>
<li>Load <em>NoiseSpec</em> structure</li>
<li>Fill in <em>reconstruct_init</em></li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA16reconstruct_initE">
<span id="initializeReconstructionSIRENA::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA11record_fileE">
<span id="initializeReconstructionSIRENA::record_file__cPC"></span>char *<em class="property">const</em> <code class="descclassname"></code><code class="descname">record_file</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA11record_fileE" title="Permalink to this definition">¶</a></dt>
<dd><p>Filename of input data file with records, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-RecordFile"><code class="xref std std-option docutils literal"><span class="pre">RecordFile</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA4fptrE">
<span id="initializeReconstructionSIRENA::fptr__fitsfileP"></span>fitsfile *<code class="descclassname"></code><code class="descname">fptr</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA4fptrE" title="Permalink to this definition">¶</a></dt>
<dd><p>FITS object with pointer to data file</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA12library_fileE">
<span id="initializeReconstructionSIRENA::library_file__cPC"></span>char *<em class="property">const</em> <code class="descclassname"></code><code class="descname">library_file</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA12library_fileE" title="Permalink to this definition">¶</a></dt>
<dd><p>File name of calibration library, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LibraryFile"><code class="xref std std-option docutils literal"><span class="pre">LibraryFile</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA10event_fileE">
<span id="initializeReconstructionSIRENA::event_file__cPC"></span>char *<em class="property">const</em> <code class="descclassname"></code><code class="descname">event_file</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA10event_fileE" title="Permalink to this definition">¶</a></dt>
<dd><p>File name of output events (with reconstructed energy), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-TesEventFile"><code class="xref std std-option docutils literal"><span class="pre">TesEventFile</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA12pulse_lengthE">
<span id="initializeReconstructionSIRENA::pulse_length__i"></span>int <code class="descclassname"></code><code class="descname">pulse_length</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA12pulse_lengthE" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulse length, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-PulseLength"><code class="xref std std-option docutils literal"><span class="pre">PulseLength</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA11scaleFactorE">
<span id="initializeReconstructionSIRENA::scaleFactor__double"></span>double <code class="descclassname"></code><code class="descname">scaleFactor</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA11scaleFactorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Detection scale factor for initial filtering, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-scaleFactor"><code class="xref std std-option docutils literal"><span class="pre">scaleFactor</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA9samplesUpE">
<span id="initializeReconstructionSIRENA::samplesUp__double"></span>double <code class="descclassname"></code><code class="descname">samplesUp</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA9samplesUpE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of samples for threshold trespassing, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-samplesUp"><code class="xref std std-option docutils literal"><span class="pre">samplesUp</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA5nSgmsE">
<span id="initializeReconstructionSIRENA::nSgms__double"></span>double <code class="descclassname"></code><code class="descname">nSgms</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA5nSgmsE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of standard deviations in the kappa-clipping process for threshold estimation, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-nSgms"><code class="xref std std-option docutils literal"><span class="pre">nSgms</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA4modeE">
<span id="initializeReconstructionSIRENA::mode__i"></span>int <code class="descclassname"></code><code class="descname">mode</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA4modeE" title="Permalink to this definition">¶</a></dt>
<dd><p>Calibration run (0) or energy reconstruction run (1), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA4LrsTE">
<span id="initializeReconstructionSIRENA::LrsT__double"></span>double <code class="descclassname"></code><code class="descname">LrsT</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA4LrsTE" title="Permalink to this definition">¶</a></dt>
<dd><p>Running sum length for the RS raw energy estimation (seconds), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LrsT"><code class="xref std std-option docutils literal"><span class="pre">LrsT</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA3LbTE">
<span id="initializeReconstructionSIRENA::LbT__double"></span>double <code class="descclassname"></code><code class="descname">LbT</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA3LbTE" title="Permalink to this definition">¶</a></dt>
<dd><p>Baseline averaging length for the RS raw energy estimation (seconds), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LbT"><code class="xref std std-option docutils literal"><span class="pre">LbT</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA10noise_fileE">
<span id="initializeReconstructionSIRENA::noise_file__cPC"></span>char *<em class="property">const</em> <code class="descclassname"></code><code class="descname">noise_file</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA10noise_fileE" title="Permalink to this definition">¶</a></dt>
<dd><p>Noise file, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-NoiseFile"><code class="xref std std-option docutils literal"><span class="pre">NoiseFile</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA13filter_domainE">
<span id="initializeReconstructionSIRENA::filter_domain__cP"></span>char *<code class="descclassname"></code><code class="descname">filter_domain</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA13filter_domainE" title="Permalink to this definition">¶</a></dt>
<dd><p>Filtering Domain: Time (<strong>T</strong>) or Frequency (<strong>F</strong>), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterDomain"><code class="xref std std-option docutils literal"><span class="pre">FilterDomain</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA13filter_methodE">
<span id="initializeReconstructionSIRENA::filter_method__cP"></span>char *<code class="descclassname"></code><code class="descname">filter_method</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA13filter_methodE" title="Permalink to this definition">¶</a></dt>
<dd><p>Filtering Method: <strong>F0</strong> (deleting the zero frequency bin) or <strong>F0</strong> (deleting the baseline), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA13energy_methodE">
<span id="initializeReconstructionSIRENA::energy_method__cP"></span>char *<code class="descclassname"></code><code class="descname">energy_method</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA13energy_methodE" title="Permalink to this definition">¶</a></dt>
<dd><p>Energy calculation Method: <strong>OPTFILT</strong>, <strong>WEIGHT</strong>, <strong>WEIGHTN</strong>, <strong>I2R</strong>, <strong>I2RALL</strong>, <strong>I2RNOL</strong> or <strong>I2RFITTED</strong>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA9lagsornotE">
<span id="initializeReconstructionSIRENA::lagsornot__i"></span>int <code class="descclassname"></code><code class="descname">lagsornot</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA9lagsornotE" title="Permalink to this definition">¶</a></dt>
<dd><p>Lags (1) or no lags (0), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LagsOrNot"><code class="xref std std-option docutils literal"><span class="pre">LagsOrNot</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA6ofiterE">
<span id="initializeReconstructionSIRENA::ofiter__i"></span>int <code class="descclassname"></code><code class="descname">ofiter</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA6ofiterE" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate (1) or not iterate (0), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFIter"><code class="xref std std-option docutils literal"><span class="pre">OFIter</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA5oflibE">
<span id="initializeReconstructionSIRENA::oflib__c"></span>char <code class="descclassname"></code><code class="descname">oflib</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA5oflibE" title="Permalink to this definition">¶</a></dt>
<dd><p>Work or not with a library with optimal filters (1/0), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFLib"><code class="xref std std-option docutils literal"><span class="pre">OFLib</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA8ofinterpE">
<span id="initializeReconstructionSIRENA::ofinterp__cP"></span>char *<code class="descclassname"></code><code class="descname">ofinterp</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA8ofinterpE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal Filter by using the Matched Filter or the DAB as matched filter (<em>MF</em>/<em>DAB</em>)
It has been fixed in <a class="reference internal" href="SIRENAcommandline.html#tesreconstruction"><span class="std std-ref">tesreconstruction</span></a> as <em>DAB</em></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA17oflength_strategyE">
<span id="initializeReconstructionSIRENA::oflength_strategy__cP"></span>char *<code class="descclassname"></code><code class="descname">oflength_strategy</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA17oflength_strategyE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal Filter length Strategy: <strong>FREE</strong>, <strong>BASE2</strong>, <strong>BYGRADE</strong> or <strong>FIXED</strong>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFStrategy"><code class="xref std std-option docutils literal"><span class="pre">OFStrategy</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA8oflengthE">
<span id="initializeReconstructionSIRENA::oflength__i"></span>int <code class="descclassname"></code><code class="descname">oflength</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA8oflengthE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal Filter length (taken into account if <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFStrategy"><code class="xref std std-option docutils literal"><span class="pre">OFStrategy</span></code></a> = <strong>FIXED</strong>), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFLength"><code class="xref std std-option docutils literal"><span class="pre">OFLength</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA10monoenergyE">
<span id="initializeReconstructionSIRENA::monoenergy__double"></span>double <code class="descclassname"></code><code class="descname">monoenergy</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA10monoenergyE" title="Permalink to this definition">¶</a></dt>
<dd><p>Monochromatic energy of input file in eV (only for library creation), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-monoenergy"><code class="xref std std-option docutils literal"><span class="pre">monoenergy</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA6intermE">
<span id="initializeReconstructionSIRENA::interm__i"></span>int <code class="descclassname"></code><code class="descname">interm</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA6intermE" title="Permalink to this definition">¶</a></dt>
<dd><p>Write or not intermediate files (1/0), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-intermediate"><code class="xref std std-option docutils literal"><span class="pre">intermediate</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA10detectFileE">
<span id="initializeReconstructionSIRENA::detectFile__cPC"></span>char *<em class="property">const</em> <code class="descclassname"></code><code class="descname">detectFile</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA10detectFileE" title="Permalink to this definition">¶</a></dt>
<dd><p>Intermediate detections file (if <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-intermediate"><code class="xref std std-option docutils literal"><span class="pre">intermediate</span></code></a> = 1), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-detectFile"><code class="xref std std-option docutils literal"><span class="pre">detectFile</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA10filterFileE">
<span id="initializeReconstructionSIRENA::filterFile__cPC"></span>char *<em class="property">const</em> <code class="descclassname"></code><code class="descname">filterFile</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA10filterFileE" title="Permalink to this definition">¶</a></dt>
<dd><p>Intermediate filters file (if <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-intermediate"><code class="xref std std-option docutils literal"><span class="pre">intermediate</span></code></a> = 1), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-filterFile"><code class="xref std std-option docutils literal"><span class="pre">filterFile</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA7clobberE">
<span id="initializeReconstructionSIRENA::clobber__c"></span>char <code class="descclassname"></code><code class="descname">clobber</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA7clobberE" title="Permalink to this definition">¶</a></dt>
<dd><p>Overwrite or not output files if exist (1/0), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-clobber"><code class="xref std std-option docutils literal"><span class="pre">clobber</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA18maxPulsesPerRecordE">
<span id="initializeReconstructionSIRENA::maxPulsesPerRecord__i"></span>int <code class="descclassname"></code><code class="descname">maxPulsesPerRecord</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA18maxPulsesPerRecordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Default size of the event list, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EventListSize"><code class="xref std std-option docutils literal"><span class="pre">EventListSize</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA15SaturationValueE">
<span id="initializeReconstructionSIRENA::SaturationValue__double"></span>double <code class="descclassname"></code><code class="descname">SaturationValue</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA15SaturationValueE" title="Permalink to this definition">¶</a></dt>
<dd><p>Saturation level of the ADC curves, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-SaturationValue"><code class="xref std std-option docutils literal"><span class="pre">SaturationValue</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA12tstartPulse1E">
<span id="initializeReconstructionSIRENA::tstartPulse1__i"></span>int <code class="descclassname"></code><code class="descname">tstartPulse1</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA12tstartPulse1E" title="Permalink to this definition">¶</a></dt>
<dd><p>Tstart (samples) of the first pulse (different from 0 if the tstartPulsei input parameters are going to be used), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-tstartPulse1"><code class="xref std std-option docutils literal"><span class="pre">tstartPulse1</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA12tstartPulse2E">
<span id="initializeReconstructionSIRENA::tstartPulse2__i"></span>int <code class="descclassname"></code><code class="descname">tstartPulse2</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA12tstartPulse2E" title="Permalink to this definition">¶</a></dt>
<dd><p>Tstart (samples) of the second pulse, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-tstartPulse2"><code class="xref std std-option docutils literal"><span class="pre">tstartPulse2</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA12tstartPulse3E">
<span id="initializeReconstructionSIRENA::tstartPulse3__i"></span>int <code class="descclassname"></code><code class="descname">tstartPulse3</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA12tstartPulse3E" title="Permalink to this definition">¶</a></dt>
<dd><p>Tstart (samples) of the third pulse (if 0 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> PAIRS, if not 0 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> TRIOS), <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-tstartPulse3"><code class="xref std std-option docutils literal"><span class="pre">tstartPulse3</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA10energyPCA1E">
<span id="initializeReconstructionSIRENA::energyPCA1__double"></span>double <code class="descclassname"></code><code class="descname">energyPCA1</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA10energyPCA1E" title="Permalink to this definition">¶</a></dt>
<dd><p>First energy (only for <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>PCA</strong>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA10energyPCA2E">
<span id="initializeReconstructionSIRENA::energyPCA2__double"></span>double <code class="descclassname"></code><code class="descname">energyPCA2</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA10energyPCA2E" title="Permalink to this definition">¶</a></dt>
<dd><p>Second energy (only for <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>PCA</strong>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA7XMLFileE">
<span id="initializeReconstructionSIRENA::XMLFile__cPC"></span>char *<em class="property">const</em> <code class="descclassname"></code><code class="descname">XMLFile</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA7XMLFileE" title="Permalink to this definition">¶</a></dt>
<dd><p>File name of the XML input file with instrument definition</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N30initializeReconstructionSIRENA6statusE">
<span id="initializeReconstructionSIRENA::status__iPC"></span>int *<em class="property">const</em> <code class="descclassname"></code><code class="descname">status</code><a class="headerlink" href="#_CPPv2N30initializeReconstructionSIRENA6statusE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/Output status</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv217InitialTriggeringP10gsl_vectordddddPbPiPiPdi">
<span id="InitialTriggering__gsl_vectorP.double.double.double.double.double.bP.iP.iP.doubleP.i"></span>int <code class="descclassname"></code><code class="descname">InitialTriggering</code><span class="sig-paren">(</span>gsl_vector *<em>derivative</em>, double <em>nSgms</em>, double <em>scalefactor</em>, double <em>samplingRate</em>, double <em>stopcriteriamkc</em>, double <em>kappamkc</em>, bool *<em>triggerCondition</em>, int *<em>tstart</em>, int *<em>flagTruncated</em>, double *<em>threshold</em>, int <em>tstartProvided</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv217InitialTriggeringP10gsl_vectordddddPbPiPiPdi" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function finds the first pulse in the input vector, first derivative of the (low-pass filtered) record.</p>
<p>Steps:</p>
<ul>
<li><p class="first">Declare variables</p>
</li>
<li><p class="first">Stablish the <a class="reference internal" href="#_CPPv2N17InitialTriggering9thresholdE" title="InitialTriggering::threshold"><code class="xref cpp cpp-member docutils literal"><span class="pre">threshold</span></code></a></p>
</li>
<li><p class="first">It is possible to find the tstart of the first pulse...</p>
<p>Obtain tstart of the first pulse in the derivative if <img class="math" src="_images/math/10118a49364a44f4ec0486857965f605e28b77cf.png" alt="derivative_i&gt;threshold"/></p>
</li>
<li><p class="first">... Or to use the tstart provided as input parameter</p>
</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N17InitialTriggering10derivativeE">
<span id="InitialTriggering::derivative__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">derivative</code><a class="headerlink" href="#_CPPv2N17InitialTriggering10derivativeE" title="Permalink to this definition">¶</a></dt>
<dd><p>First derivative of the (low-pass filtered) record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17InitialTriggering5nSgmsE">
<span id="InitialTriggering::nSgms__double"></span>double <code class="descclassname"></code><code class="descname">nSgms</code><a class="headerlink" href="#_CPPv2N17InitialTriggering5nSgmsE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of <em>Sigmas</em> to establish the threshold (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-nSgms"><code class="xref std std-option docutils literal"><span class="pre">nSgms</span></code></a>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17InitialTriggering11scalefactorE">
<span id="InitialTriggering::scalefactor__double"></span>double <code class="descclassname"></code><code class="descname">scalefactor</code><a class="headerlink" href="#_CPPv2N17InitialTriggering11scalefactorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale factor to calculate the LPF box-car length (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-scaleFactor"><code class="xref std std-option docutils literal"><span class="pre">scaleFactor</span></code></a>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17InitialTriggering12samplingRateE">
<span id="InitialTriggering::samplingRate__double"></span>double <code class="descclassname"></code><code class="descname">samplingRate</code><a class="headerlink" href="#_CPPv2N17InitialTriggering12samplingRateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17InitialTriggering15stopcriteriamkcE">
<span id="InitialTriggering::stopcriteriamkc__double"></span>double <code class="descclassname"></code><code class="descname">stopcriteriamkc</code><a class="headerlink" href="#_CPPv2N17InitialTriggering15stopcriteriamkcE" title="Permalink to this definition">¶</a></dt>
<dd><p>Used in <a class="reference internal" href="#_CPPv219medianKappaClippingP10gsl_vectordddiPd" title="medianKappaClipping"><code class="xref cpp cpp-func docutils literal"><span class="pre">medianKappaClipping()</span></code></a> (%)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17InitialTriggering8kappamkcE">
<span id="InitialTriggering::kappamkc__double"></span>double <code class="descclassname"></code><code class="descname">kappamkc</code><a class="headerlink" href="#_CPPv2N17InitialTriggering8kappamkcE" title="Permalink to this definition">¶</a></dt>
<dd><p>Used in <a class="reference internal" href="#_CPPv219medianKappaClippingP10gsl_vectordddiPd" title="medianKappaClipping"><code class="xref cpp cpp-func docutils literal"><span class="pre">medianKappaClipping()</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17InitialTriggering16triggerConditionE">
<span id="InitialTriggering::triggerCondition__bP"></span>bool *<code class="descclassname"></code><code class="descname">triggerCondition</code><a class="headerlink" href="#_CPPv2N17InitialTriggering16triggerConditionE" title="Permalink to this definition">¶</a></dt>
<dd><p>True <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The algorithm has found the first event</p>
<p>False <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The algorithm has not found any event</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17InitialTriggering6tstartE">
<span id="InitialTriggering::tstart__iP"></span>int *<code class="descclassname"></code><code class="descname">tstart</code><a class="headerlink" href="#_CPPv2N17InitialTriggering6tstartE" title="Permalink to this definition">¶</a></dt>
<dd><p>First event tstart (in samples)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17InitialTriggering13flagTruncatedE">
<span id="InitialTriggering::flagTruncated__iP"></span>int *<code class="descclassname"></code><code class="descname">flagTruncated</code><a class="headerlink" href="#_CPPv2N17InitialTriggering13flagTruncatedE" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag indicating if the event is truncated</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17InitialTriggering9thresholdE">
<span id="InitialTriggering::threshold__doubleP"></span>double *<code class="descclassname"></code><code class="descname">threshold</code><a class="headerlink" href="#_CPPv2N17InitialTriggering9thresholdE" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculated threshold  (output parameter because it is necessary out of the function)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17InitialTriggering14tstartProvidedE">
<span id="InitialTriggering::tstartProvided__i"></span>int <code class="descclassname"></code><code class="descname">tstartProvided</code><a class="headerlink" href="#_CPPv2N17InitialTriggering14tstartProvidedE" title="Permalink to this definition">¶</a></dt>
<dd><p>Tstart of the first pulse provided as input parameter</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv215interactiveParsP7inparami6string">
<span id="interactivePars__inparamP.i.string"></span>int <code class="descclassname"></code><code class="descname">interactivePars</code><span class="sig-paren">(</span>inparam *<em>taskPars</em>, int <em>np</em>, string <em>task</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv215interactiveParsP7inparami6string" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file <em>inoututils.cpp</em></p>
<p>This function reads input parameters interactively (provided by the user or taken as default values).
Used in tool <a class="reference internal" href="SIRENAcommandline.html#gennoisespec"><span class="std std-ref">gennoisespec</span></a>.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N15interactivePars8taskParsE">
<span id="interactivePars::taskPars__inparamP"></span>inparam *<code class="descclassname"></code><code class="descname">taskPars</code><a class="headerlink" href="#_CPPv2N15interactivePars8taskParsE" title="Permalink to this definition">¶</a></dt>
<dd><p>Instance of <em>inparam</em> structure storing input parameters</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15interactivePars2npE">
<span id="interactivePars::np__i"></span>int <code class="descclassname"></code><code class="descname">np</code><a class="headerlink" href="#_CPPv2N15interactivePars2npE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of parameters</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15interactivePars4taskE">
<span id="interactivePars::task__string"></span>string <code class="descclassname"></code><code class="descname">task</code><a class="headerlink" href="#_CPPv2N15interactivePars4taskE" title="Permalink to this definition">¶</a></dt>
<dd><p>Tool name</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv214interpolatePOSP10gsl_vectorP10gsl_vectorldPP10gsl_vectorPP10gsl_vector">
<span id="interpolatePOS__gsl_vectorP.gsl_vectorP.l.double.gsl_vectorPP.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">interpolatePOS</code><span class="sig-paren">(</span>gsl_vector *<em>x_in</em>, gsl_vector *<em>y_in</em>, long <em>size</em>, double <em>step</em>, gsl_vector **<em>x_out</em>, gsl_vector **<em>y_out</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv214interpolatePOSP10gsl_vectorP10gsl_vectorldPP10gsl_vectorPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function interpolates an input vector (<a class="reference internal" href="#_CPPv2N14interpolatePOS4x_inE" title="interpolatePOS::x_in"><code class="xref cpp cpp-member docutils literal"><span class="pre">x_in</span></code></a>, <a class="reference internal" href="#_CPPv2N14interpolatePOS4y_inE" title="interpolatePOS::y_in"><code class="xref cpp cpp-member docutils literal"><span class="pre">y_in</span></code></a>), creating an output vector (<a class="reference internal" href="#_CPPv2N14interpolatePOS5x_outE" title="interpolatePOS::x_out"><code class="xref cpp cpp-member docutils literal"><span class="pre">x_out</span></code></a>, <a class="reference internal" href="#_CPPv2N14interpolatePOS5y_outE" title="interpolatePOS::y_out"><code class="xref cpp cpp-member docutils literal"><span class="pre">y_out</span></code></a>) with the size
and frequency step given. <em>POS</em> comes from the fact that the input spectrum only has positive frequencies (in order to not handle the f=0 bin).</p>
<ul class="simple">
<li>Declare and initialize variables</li>
<li>GSL method applied for interpolatation</li>
<li>Generate the interpolated output vector</li>
<li>Free memory</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N14interpolatePOS4x_inE">
<span id="interpolatePOS::x_in__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">x_in</code><a class="headerlink" href="#_CPPv2N14interpolatePOS4x_inE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL input vector with the abscissas of the vector which is going to be interpolated</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14interpolatePOS4y_inE">
<span id="interpolatePOS::y_in__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">y_in</code><a class="headerlink" href="#_CPPv2N14interpolatePOS4y_inE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL input vector with the ordinates of the vector which is going to be interpolated</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14interpolatePOS4sizeE">
<span id="interpolatePOS::size__l"></span>long <code class="descclassname"></code><code class="descname">size</code><a class="headerlink" href="#_CPPv2N14interpolatePOS4sizeE" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of the interpolated output vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14interpolatePOS4stepE">
<span id="interpolatePOS::step__double"></span>double <code class="descclassname"></code><code class="descname">step</code><a class="headerlink" href="#_CPPv2N14interpolatePOS4stepE" title="Permalink to this definition">¶</a></dt>
<dd><p>Frequency step of the interpolated output vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14interpolatePOS5x_outE">
<span id="interpolatePOS::x_out__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">x_out</code><a class="headerlink" href="#_CPPv2N14interpolatePOS5x_outE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL output vector with the abscissas of the interpolated vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14interpolatePOS5y_outE">
<span id="interpolatePOS::y_out__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">y_out</code><a class="headerlink" href="#_CPPv2N14interpolatePOS5y_outE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL output vector with the ordinates of the interpolated vector</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv217interpolate_modelPP10gsl_vectordP10gsl_vectordP10gsl_vectord">
<span id="interpolate_model__gsl_vectorPP.double.gsl_vectorP.double.gsl_vectorP.double"></span>int <code class="descclassname"></code><code class="descname">interpolate_model</code><span class="sig-paren">(</span>gsl_vector **<em>modelFound</em>, double <em>p_model</em>, gsl_vector *<em>modelIn1</em>, double <em>p_modelIn1</em>, gsl_vector *<em>modelIn2</em>, double <em>p_modelIn2</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv217interpolate_modelPP10gsl_vectordP10gsl_vectordP10gsl_vectord" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function interpolates the pulse model, <img class="math" src="_images/math/9b11d8827e01c06d06ea72e93cab4339647df202.png" alt="p(t,E)"/>, between two models of the pulse models library,
<img class="math" src="_images/math/1fb1b0931f23367e93b9482758b8240e69b12eba.png" alt="p(t,E_1)"/> and <img class="math" src="_images/math/97d27f49cd93b884b6782d79d1f8ce74c5b3de42.png" alt="p(t,E_2)"/>, being <img class="math" src="_images/math/a1342cbc2990a53a413d10000ec46a6486f9a8b9.png" alt="E_1&lt;E&lt;E_2"/>.</p>
<p>According to the interpolation method:</p>
<div class="math">
<p><img src="_images/math/8996ff4711de85d2acd5229b81c678e92b03750f.png" alt="p(t,E)={\frac{E_2-E}{E_2-E_1}}p(t,E_1)+{\frac{E-E_1}{E_2-E_1}}p(t,E_2)"/></p>
</div><p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N17interpolate_model10modelFoundE">
<span id="interpolate_model::modelFound__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">modelFound</code><a class="headerlink" href="#_CPPv2N17interpolate_model10modelFoundE" title="Permalink to this definition">¶</a></dt>
<dd><p>Found model of the pulse whose <em>energy</em> or <em>maxDER</em> is <a class="reference internal" href="#_CPPv2N17interpolate_model7p_modelE" title="interpolate_model::p_model"><code class="xref cpp cpp-member docutils literal"><span class="pre">p_model</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17interpolate_model7p_modelE">
<span id="interpolate_model::p_model__double"></span>double <code class="descclassname"></code><code class="descname">p_model</code><a class="headerlink" href="#_CPPv2N17interpolate_model7p_modelE" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter (<em>energy</em> or <em>maxDER</em>) of the pulse whose model is being sought</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17interpolate_model8modelIn1E">
<span id="interpolate_model::modelIn1__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">modelIn1</code><a class="headerlink" href="#_CPPv2N17interpolate_model8modelIn1E" title="Permalink to this definition">¶</a></dt>
<dd><p>Model of the pulse whose parameter (<em>energy</em> or <em>maxDER</em>) is immediately lower than <a class="reference internal" href="#_CPPv2N17interpolate_model7p_modelE" title="interpolate_model::p_model"><code class="xref cpp cpp-member docutils literal"><span class="pre">p_model</span></code></a> in the library FITS file</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17interpolate_model10p_modelIn1E">
<span id="interpolate_model::p_modelIn1__double"></span>double <code class="descclassname"></code><code class="descname">p_modelIn1</code><a class="headerlink" href="#_CPPv2N17interpolate_model10p_modelIn1E" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter (<em>energy</em> or <em>maxDER</em>) immediately lower than <a class="reference internal" href="#_CPPv2N17interpolate_model7p_modelE" title="interpolate_model::p_model"><code class="xref cpp cpp-member docutils literal"><span class="pre">p_model</span></code></a> in the library FITS file</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17interpolate_model8modelIn2E">
<span id="interpolate_model::modelIn2__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">modelIn2</code><a class="headerlink" href="#_CPPv2N17interpolate_model8modelIn2E" title="Permalink to this definition">¶</a></dt>
<dd><p>Model of the pulse whose parameter (<em>energy</em> or <em>maxDER</em>) is immediately greater than <a class="reference internal" href="#_CPPv2N17interpolate_model7p_modelE" title="interpolate_model::p_model"><code class="xref cpp cpp-member docutils literal"><span class="pre">p_model</span></code></a> in the library FITS file</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N17interpolate_model10p_modelIn2E">
<span id="interpolate_model::p_modelIn2__double"></span>double <code class="descclassname"></code><code class="descname">p_modelIn2</code><a class="headerlink" href="#_CPPv2N17interpolate_model10p_modelIn2E" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameter (<em>energy</em> or <em>maxDER</em>) immediately greater than <a class="reference internal" href="#_CPPv2N17interpolate_model7p_modelE" title="interpolate_model::p_model"><code class="xref cpp cpp-member docutils literal"><span class="pre">p_model</span></code></a> in the library FITS file</p>
</dd></dl>

</dd></dl>

<span class="target" id="l"><span id="k"></span><span id="j"></span></span><dl class="function">
<dt id="_CPPv210loadRecordP9TesRecordPdPP10gsl_vector">
<span id="loadRecord__TesRecordP.doubleP.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">loadRecord</code><span class="sig-paren">(</span>TesRecord *<em>record</em>, double *<em>time_record</em>, gsl_vector **<em>adc_double</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv210loadRecordP9TesRecordPdPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This fucntion loads the structure <a class="reference internal" href="#_CPPv2N10loadRecord6recordE" title="loadRecord::record"><code class="xref cpp cpp-member docutils literal"><span class="pre">record</span></code></a> into the <a class="reference internal" href="#_CPPv2N10loadRecord10adc_doubleE" title="loadRecord::adc_double"><code class="xref cpp cpp-member docutils literal"><span class="pre">adc_double</span></code></a> GSL vector.</p>
<p>It checks if the record has been filled out with 0&#8217;s <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> It only loads the first values (which are different from 0).</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N10loadRecord6recordE">
<span id="loadRecord::record__TesRecordP"></span>TesRecord *<code class="descclassname"></code><code class="descname">record</code><a class="headerlink" href="#_CPPv2N10loadRecord6recordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>TesRecord</em> structure that contains the input record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10loadRecord11time_recordE">
<span id="loadRecord::time_record__double"></span>double <code class="descclassname"></code><code class="descname">time_record</code><a class="headerlink" href="#_CPPv2N10loadRecord11time_recordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Starting time of the record (output)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10loadRecord10adc_doubleE">
<span id="loadRecord::adc_double__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">adc_double</code><a class="headerlink" href="#_CPPv2N10loadRecord10adc_doubleE" title="Permalink to this definition">¶</a></dt>
<dd><p>Storage of the record to be processed (input/output)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv210lpf_boxcarPP10gsl_vectorii">
<span id="lpf_boxcar__gsl_vectorPP.i.i"></span>int <code class="descclassname"></code><code class="descname">lpf_boxcar</code><span class="sig-paren">(</span>gsl_vector **<em>invector</em>, int <em>szVct</em>, int <em>sampleRate</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv210lpf_boxcarPP10gsl_vectorii" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function implements a low pass filtering as a box-car function in time.</p>
<p>The box-car function is a temporal average window:</p>
<div class="math">
<p><img src="_images/math/c67f8ee71769a5265ecb0dad6c4758c25a613e18.png" alt="x_{i-1}=\sum_{0}^{n-1}\frac{I_i}{n}"/></p>
</div><div class="math">
<p><img src="_images/math/17f1d5b94cf8aadb795a7282fdc29d0401719f6c.png" alt="x_i=\sum_{1}^{n}\frac{I_i}{n}"/></p>
</div><p>If the cut frequency of the filter is <img class="math" src="_images/math/84424f4a38edec439de5737025f0c61f1dc7b875.png" alt="\mathit{f_c}"/>, the box-car length (<em>n</em>) is</p>
<div class="math">
<p><img src="_images/math/46016a86a530326d471291148484409de91973f4.png" alt="\frac{1}{f_c}samprate"/></p>
</div><p>Steps:</p>
<ul class="simple">
<li>Declare variables</li>
<li>Define the LPF (frequency domain) and the box-car function (time domain)</li>
<li>It is going to work with a longer vector to not have fake results for the last <em>boxLength</em> windows</li>
<li>Apply the box-car window by shifting it along the (lengthened) input vector</li>
<li>Free allocated GSL vectors</li>
</ul>
<p>The function returns:</p>
<blockquote>
<div><ul class="simple">
<li>1: Function cannot run</li>
<li>3: Cut-off frequency too high <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Equivalent to not filter</li>
<li>4: Cut-off frequency too low</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N10lpf_boxcar8invectorE">
<span id="lpf_boxcar::invector__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">invector</code><a class="headerlink" href="#_CPPv2N10lpf_boxcar8invectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/Output GSL vector (non-filtered input vector/filtered input vector)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10lpf_boxcar5szVctE">
<span id="lpf_boxcar::szVct__i"></span>int <code class="descclassname"></code><code class="descname">szVct</code><a class="headerlink" href="#_CPPv2N10lpf_boxcar5szVctE" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of <a class="reference internal" href="#_CPPv2N10lpf_boxcar8invectorE" title="lpf_boxcar::invector"><code class="xref cpp cpp-member docutils literal"><span class="pre">invector</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10lpf_boxcar10sampleRateE">
<span id="lpf_boxcar::sampleRate__i"></span>int <code class="descclassname"></code><code class="descname">sampleRate</code><a class="headerlink" href="#_CPPv2N10lpf_boxcar10sampleRateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate (samples/s)</p>
</dd></dl>

</dd></dl>

<span class="target" id="m"></span><dl class="function">
<dt id="_CPPv213matrix2vectorP10gsl_matrixPP10gsl_vector">
<span id="matrix2vector__gsl_matrixP.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">matrix2vector</code><span class="sig-paren">(</span>gsl_matrix *<em>matrixin</em>, gsl_vector **<em>vectorout</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv213matrix2vectorP10gsl_matrixPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function converts an input <img class="math" src="_images/math/ad8aa55157284eecb46d368d254fbcbcc1808f57.png" alt="[n \times n]"/> square matrix into an output <img class="math" src="_images/math/b3f3eaa34b1d5ebe3808600684699430c83cee7f.png" alt="n^2"/> vector. It puts the first row of the matrix (<img class="math" src="_images/math/e11f2701c4a39c7fe543a6c4150b421d50f1c159.png" alt="n"/> elements) in the first <img class="math" src="_images/math/e11f2701c4a39c7fe543a6c4150b421d50f1c159.png" alt="n"/> elements of the vector (from <img class="math" src="_images/math/532f3248d6552e7ac6b785bd935f404ad593e6a9.png" alt="0"/> to <img class="math" src="_images/math/09f6e3c7bf705fcf0fb2f289b07cd472b60d215c.png" alt="n-1"/>), the second row of the matrix in the elements from <img class="math" src="_images/math/e11f2701c4a39c7fe543a6c4150b421d50f1c159.png" alt="n"/> to <img class="math" src="_images/math/7883ee481d56b9b7196947b5f8d19809c42a2a89.png" alt="2n-1"/> of the vector and so on.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N13matrix2vector8matrixinE">
<span id="matrix2vector::matrixin__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">matrixin</code><a class="headerlink" href="#_CPPv2N13matrix2vector8matrixinE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL input square matrix <img class="math" src="_images/math/ad8aa55157284eecb46d368d254fbcbcc1808f57.png" alt="[n \times n]"/></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13matrix2vector9vectoroutE">
<span id="matrix2vector::vectorout__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">vectorout</code><a class="headerlink" href="#_CPPv2N13matrix2vector9vectoroutE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL output vector whose length is <img class="math" src="_images/math/b3f3eaa34b1d5ebe3808600684699430c83cee7f.png" alt="n^2"/></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv219medianKappaClippingP10gsl_vectordddiPd">
<span id="medianKappaClipping__gsl_vectorP.double.double.double.i.doubleP"></span>int <code class="descclassname"></code><code class="descname">medianKappaClipping</code><span class="sig-paren">(</span>gsl_vector *<em>invector</em>, double <em>kappa</em>, double <em>stopCriteria</em>, double <em>nSigmas</em>, int <em>boxLPF</em>, double *<em>threshold</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv219medianKappaClippingP10gsl_vectordddiPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function calculates a threshold in the first derivative of the record by using a Kappa-clipping method
(replacing points beyond <img class="math" src="_images/math/19ec9520d00005df2730b1c3448ec7331be78d2b.png" alt="mean\pm kappa \cdot sigma"/> with the median).</p>
<p>Mean and sigma are calculated and values of <a class="reference internal" href="#_CPPv2N19medianKappaClipping8invectorE" title="medianKappaClipping::invector"><code class="xref cpp cpp-member docutils literal"><span class="pre">invector</span></code></a> out of <img class="math" src="_images/math/04f20e9f0e7b6eed25971a94c9e38e9adc783f74.png" alt="(mean+kappa \cdot sigma,mean-kappa \cdot sigma)"/> are replaced
with the median (it is trying to look for the baseline). And this process is iteratively repeated until there are
no points beyond <img class="math" src="_images/math/f399d6fbae9606b1a5bade8d7245ade8ffdcbe44.png" alt="mean \pm kappa \cdot sigma"/>. Finally, the threshold is calculated as <img class="math" src="_images/math/bba4c7821030912dc9369ca0d2b8aebddf44369b.png" alt="mean+nSigmas \cdot sigma"/> (&#8216;+&#8217; is used because
<cite>if there are pulses in the input invector they are always positive</cite>).</p>
<p>Steps:</p>
<ul class="simple">
<li>Declare variables</li>
<li>Calculate the median</li>
<li>Iterate until there are no points out of the maximum excursion ( <img class="math" src="_images/math/2a69587de3a53265f6c2a1d69d2701d2009c5811.png" alt="kappa \cdot sigma"/>)</li>
<li>Establish the threshold as mean+nSigmas*sigma</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N19medianKappaClipping8invectorE">
<span id="medianKappaClipping::invector__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">invector</code><a class="headerlink" href="#_CPPv2N19medianKappaClipping8invectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>First derivative of the (filtered) record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N19medianKappaClipping5kappaE">
<span id="medianKappaClipping::kappa__double"></span>double <code class="descclassname"></code><code class="descname">kappa</code><a class="headerlink" href="#_CPPv2N19medianKappaClipping5kappaE" title="Permalink to this definition">¶</a></dt>
<dd><p>Value to establish the range around of the mean</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N19medianKappaClipping12stopCriteriaE">
<span id="medianKappaClipping::stopCriteria__double"></span>double <code class="descclassname"></code><code class="descname">stopCriteria</code><a class="headerlink" href="#_CPPv2N19medianKappaClipping12stopCriteriaE" title="Permalink to this definition">¶</a></dt>
<dd><p>It is given in %</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N19medianKappaClipping7nSigmasE">
<span id="medianKappaClipping::nSigmas__double"></span>double <code class="descclassname"></code><code class="descname">nSigmas</code><a class="headerlink" href="#_CPPv2N19medianKappaClipping7nSigmasE" title="Permalink to this definition">¶</a></dt>
<dd><p>Times sigma to calculate threshold as <img class="math" src="_images/math/bba4c7821030912dc9369ca0d2b8aebddf44369b.png" alt="mean+nSigmas \cdot sigma"/></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N19medianKappaClipping6boxLPFE">
<span id="medianKappaClipping::boxLPF__i"></span>int <code class="descclassname"></code><code class="descname">boxLPF</code><a class="headerlink" href="#_CPPv2N19medianKappaClipping6boxLPFE" title="Permalink to this definition">¶</a></dt>
<dd><p>Length of the low-pass filtering box-car</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N19medianKappaClipping9thresholdE">
<span id="medianKappaClipping::threshold__doubleP"></span>double *<code class="descclassname"></code><code class="descname">threshold</code><a class="headerlink" href="#_CPPv2N19medianKappaClipping9thresholdE" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculated threshold</p>
</dd></dl>

</dd></dl>

<span class="target" id="n"></span><dl class="function">
<dt id="_CPPv222newOptimalFilterSIRENAPCi">
<span id="newOptimalFilterSIRENA__iPC"></span>extern_C_OptimalFilterSIRENA *<code class="descclassname"></code><code class="descname">newOptimalFilterSIRENA</code><span class="sig-paren">(</span>int *<em class="property">const</em> <em>status</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv222newOptimalFilterSIRENAPCi" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>integraSIRENA.cpp</em></p>
<p>Constructor. It returns a pointer to an empty <em>OptimalFilterSIRENA</em> data structure.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N22newOptimalFilterSIRENA6statusE">
<span id="newOptimalFilterSIRENA::status__iPC"></span>int *<em class="property">const</em> <code class="descclassname"></code><code class="descname">status</code><a class="headerlink" href="#_CPPv2N22newOptimalFilterSIRENA6statusE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output status</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv219newPulsesCollectionPCi">
<span id="newPulsesCollection__iPC"></span>extern_C_PulsesCollection *<code class="descclassname"></code><code class="descname">newPulsesCollection</code><span class="sig-paren">(</span>int *<em class="property">const</em> <em>status</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv219newPulsesCollectionPCi" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>integraSIRENA.cpp</em></p>
<p>Constructor. It returns a pointer to an empty <em>PulsesCollection</em> data structure.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N19newPulsesCollection6statusE">
<span id="newPulsesCollection::status__iPC"></span>int *<em class="property">const</em> <code class="descclassname"></code><code class="descname">status</code><a class="headerlink" href="#_CPPv2N19newPulsesCollection6statusE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output status</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv224newReconstructInitSIRENAPCi">
<span id="newReconstructInitSIRENA__iPC"></span>extern_C_ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">newReconstructInitSIRENA</code><span class="sig-paren">(</span>int *<em class="property">const</em> <em>status</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv224newReconstructInitSIRENAPCi" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file <em>integraSIRENA.cpp</em></p>
<p>Constructor. It returns a pointer to an empty <em>ReconstructInitSIRENA</em> data structure.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N24newReconstructInitSIRENA6statusE">
<span id="newReconstructInitSIRENA::status__iPC"></span>int *<em class="property">const</em> <code class="descclassname"></code><code class="descname">status</code><a class="headerlink" href="#_CPPv2N24newReconstructInitSIRENA6statusE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output status</p>
</dd></dl>

</dd></dl>

<span class="target" id="p"><span id="o"></span></span><dl class="function">
<dt id="_CPPv27polyFitP10gsl_vectorP10gsl_vectorPdPdPd">
<span id="polyFit__gsl_vectorP.gsl_vectorP.doubleP.doubleP.doubleP"></span>int <code class="descclassname"></code><code class="descname">polyFit</code><span class="sig-paren">(</span>gsl_vector *<em>x_fit</em>, gsl_vector *<em>y_fit</em>, double *<em>a</em>, double *<em>b</em>, double *<em>c</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv27polyFitP10gsl_vectorP10gsl_vectorPdPdPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>genutils.cpp</em></p>
<p>This function makes a polynomial fitting <img class="math" src="_images/math/1e14021932666fe30ff5f5d776e762177d28b1af.png" alt="ax^2+bx+c"/> using the regression quadratic analysis. To measure how well model agrees with the data, the chi-square merit function is used, which in this case is</p>
<div class="math">
<p><img src="_images/math/b45f3a02c7c973cba2284872f75b851d4567eca2.png" alt="\chi^2 (a,b,c)= \sum_{i=1}^{N}\left(\frac{y_i-a-bx_i-c{x_i}^2}{\sigma_i}\right)^2"/></p>
</div><p>This equation is minimized to determine <em>a</em>, <em>b</em> and <em>c</em>. Then</p>
<div class="math">
<p><img src="_images/math/0999ff0a3c8357d6d07105fab3dcb86aaa8fe3c9.png" alt="\begin{array}{ccc}
S_{(x,x)}=\sum{{x_i}^2}-\frac{(\sum{x_i})^2}{N} &amp; S_{(x^2,y)}=\sum{{x_i}^2y_i}-\frac{\sum{{x_i}^2}\cdot\sum{y_i}}{N}\\
S_{(x,y)}=\sum{x_iy_i}-\frac{\sum{x_i}\cdot\sum{y_i}}{N} &amp; S_{(x^2,x^2)}=\sum{{x_i}^4}-\frac{\left(\sum{{x_i}^2}\right)^2}{N}\\
S_{(x,x^2)}=\sum{{x_i}^3}-\frac{\sum{x_i}\cdot\sum{{x_i}^2}}{N} &amp; \\
\end{array}"/></p>
</div><div class="math">
<p><img src="_images/math/c1e4ae6ba028436a91ce2f5f015d6cdd53740b2a.png" alt="a = \frac{S_{(x^2,y)}S_{(x,x)}-S_{(x,y)}S_{(x,x^2)}}{S_{(x,x)}S_{(x^2,x^2)} -{\vert S_{(x,x^2)} \vert}^2}"/></p>
</div><div class="math">
<p><img src="_images/math/e0af0d4ba98172b8698a8d69fa1438298a776040.png" alt="b = \frac{S_{(x,y)}S_{(x^2,x^2)}-S_{(x^2,y)}S_{(x,x^2)}}{S_{(x,x)}S_{(x^2,x^2)} -{\vert S_{(x,x^2)} \vert}^2}"/></p>
</div><div class="math">
<p><img src="_images/math/4e3e441470848ca55a320213dae421ccaad46017.png" alt="c = \frac{\sum{y_i}}{N}-b\frac{\sum{x_i}}{N}-a\frac{\sum{{x_i}^2}}{N}"/></p>
</div><p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N7polyFit5x_fitE">
<span id="polyFit::x_fit__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">x_fit</code><a class="headerlink" href="#_CPPv2N7polyFit5x_fitE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL with <em>x</em> vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N7polyFit5y_fitE">
<span id="polyFit::y_fit__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">y_fit</code><a class="headerlink" href="#_CPPv2N7polyFit5y_fitE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL with <em>y</em> vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N7polyFit1aE">
<span id="polyFit::a__doubleP"></span>double *<code class="descclassname"></code><code class="descname">a</code><a class="headerlink" href="#_CPPv2N7polyFit1aE" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit coefficient of the quadratic term</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N7polyFit1bE">
<span id="polyFit::b__doubleP"></span>double *<code class="descclassname"></code><code class="descname">b</code><a class="headerlink" href="#_CPPv2N7polyFit1bE" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit coefficient of the linear term</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N7polyFit1cE">
<span id="polyFit::c__doubleP"></span>double *<code class="descclassname"></code><code class="descname">c</code><a class="headerlink" href="#_CPPv2N7polyFit1cE" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit coefficient (independent term)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv213polyFitLinearP10gsl_vectorP10gsl_vectorPdPd">
<span id="polyFitLinear__gsl_vectorP.gsl_vectorP.doubleP.doubleP"></span>int <code class="descclassname"></code><code class="descname">polyFitLinear</code><span class="sig-paren">(</span>gsl_vector *<em>x_fit</em>, gsl_vector *<em>y_fit</em>, double *<em>a</em>, double *<em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv213polyFitLinearP10gsl_vectorP10gsl_vectorPdPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>genutils.cpp</em></p>
<p>This function makes a linear fitting <img class="math" src="_images/math/52b7d4b98f5bf79b6b422dfe4cc417cc104adea7.png" alt="ax+b"/> using the regression linear analysis. To measure how well model agrees with the data, the chi-square merit function is used, which in this case is</p>
<div class="math">
<p><img src="_images/math/fe265c1a16de62d742362e687fe4301b390aaff1.png" alt="\chi^2 (a,b)= \sum_{i=1}^{N}\left(\frac{y_i-a-bx_i}{\sigma_i}\right)^2"/></p>
</div><p>This equation is minimized to determine <em>a</em> and <em>b</em>. Then</p>
<div class="math">
<p><img src="_images/math/71406327439a621c7b2571d79da4eec100619d12.png" alt="a = \frac{N \sum{x_i y_i}- \sum{x_i}\sum{y_i}}{N \sum{x_i^2} - {\left(\sum{x_i}\right)}^2}"/></p>
</div><div class="math">
<p><img src="_images/math/9ad3d6014136974fad17b22a390bf3b5d38d7192.png" alt="b = \frac{\sum{y_i}}{N}-a \frac{\sum{x_i}}{N}"/></p>
</div><p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N13polyFitLinear5x_fitE">
<span id="polyFitLinear::x_fit__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">x_fit</code><a class="headerlink" href="#_CPPv2N13polyFitLinear5x_fitE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL with <em>x</em> vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13polyFitLinear5y_fitE">
<span id="polyFitLinear::y_fit__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">y_fit</code><a class="headerlink" href="#_CPPv2N13polyFitLinear5y_fitE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL with <em>y</em> vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13polyFitLinear1aE">
<span id="polyFitLinear::a__doubleP"></span>double *<code class="descclassname"></code><code class="descname">a</code><a class="headerlink" href="#_CPPv2N13polyFitLinear1aE" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit coefficient of the linear term</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13polyFitLinear1bE">
<span id="polyFitLinear::b__doubleP"></span>double *<code class="descclassname"></code><code class="descname">b</code><a class="headerlink" href="#_CPPv2N13polyFitLinear1bE" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit coefficient (independent term)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv211print_errorPCKc6stringi">
<span id="print_error__cCPC.string.i"></span>void <code class="descclassname"></code><code class="descname">print_error</code><span class="sig-paren">(</span><em class="property">const</em> char *<em class="property">const</em> <em>func</em>, string <em>message</em>, int <em>status</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv211print_errorPCKc6stringi" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>genutils.cpp</em></p>
<p>This function prints out error messages.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N11print_error4funcE">
<span id="print_error::func__cCPC"></span><em class="property">const</em> char *<em class="property">const</em> <code class="descclassname"></code><code class="descname">func</code><a class="headerlink" href="#_CPPv2N11print_error4funcE" title="Permalink to this definition">¶</a></dt>
<dd><p>Function name whose error is printed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11print_error3msgE">
<span id="print_error::msg__string"></span>string <code class="descclassname"></code><code class="descname">msg</code><a class="headerlink" href="#_CPPv2N11print_error3msgE" title="Permalink to this definition">¶</a></dt>
<dd><p>Error message to be printed</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11print_error6statusE">
<span id="print_error::status__i"></span>int <code class="descclassname"></code><code class="descname">status</code><a class="headerlink" href="#_CPPv2N11print_error6statusE" title="Permalink to this definition">¶</a></dt>
<dd><p>Status</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv210procRecordPP21ReconstructInitSIRENAddP8fitsfileP10gsl_vectorP16PulsesCollection">
<span id="procRecord__ReconstructInitSIRENAPP.double.double.fitsfileP.gsl_vectorP.PulsesCollectionP"></span>int <code class="descclassname"></code><code class="descname">procRecord</code><span class="sig-paren">(</span>ReconstructInitSIRENA **<em>reconstruct_init</em>, double <em>tstartRecord</em>, double <em>samprate</em>, fitsfile *<em>dtcObject</em>, gsl_vector *<em>record</em>, PulsesCollection *<em>foundPulses</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv210procRecordPP21ReconstructInitSIRENAddP8fitsfileP10gsl_vectorP16PulsesCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function processes the input record:</p>
<ol class="arabic simple">
<li>Declare and initialize variables</li>
<li>Allocate GSL vectors</li>
<li>(Low-pass filtering and) differentiation</li>
<li>Find the events (pulses) in the record</li>
<li>Calculate the end time of the found pulses and check if the pulses are saturated</li>
<li>Obtain the approximate rise and fall times of each pulse (to be done)</li>
<li>Load the found pulses data in the input/output <em>foundPulses</em> structure</li>
<li>Write test info (if <em>reconstruct_init-&gt;intermediate</em> = 1)</li>
<li>Write pulses info in intermediate output FITS file (if <em>reconstruct_init-&gt;intermediate</em> = 1)</li>
<li>Free allocated GSL vectors</li>
</ol>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N10procRecord16reconstruct_initE">
<span id="procRecord::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N10procRecord16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values).  In particular, this function uses parameters
to filter (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-scaleFactor"><code class="xref std std-option docutils literal"><span class="pre">scaleFactor</span></code></a>), to find pulses (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-PulseLength"><code class="xref std std-option docutils literal"><span class="pre">PulseLength</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-samplesUp"><code class="xref std std-option docutils literal"><span class="pre">samplesUp</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-nSgms"><code class="xref std std-option docutils literal"><span class="pre">nSgms</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LrsT"><code class="xref std std-option docutils literal"><span class="pre">LrsT</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-LbT"><code class="xref std std-option docutils literal"><span class="pre">LbT</span></code></a>,
<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EventListSize"><code class="xref std std-option docutils literal"><span class="pre">EventListSize</span></code></a>) and to write info (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-detectFile"><code class="xref std std-option docutils literal"><span class="pre">detectFile</span></code></a>) if <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-intermediate"><code class="xref std std-option docutils literal"><span class="pre">intermediate</span></code></a> = 1</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10procRecord12tstartRecordE">
<span id="procRecord::tstartRecord__double"></span>double <code class="descclassname"></code><code class="descname">tstartRecord</code><a class="headerlink" href="#_CPPv2N10procRecord12tstartRecordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Starting time of the record (in order to calculate absolute times)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10procRecord8samprateE">
<span id="procRecord::samprate__double"></span>double <code class="descclassname"></code><code class="descname">samprate</code><a class="headerlink" href="#_CPPv2N10procRecord8samprateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate (in order to low-pass filter)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10procRecord9dtcObjectE">
<span id="procRecord::dtcObject__fitsfileP"></span>fitsfile *<code class="descclassname"></code><code class="descname">dtcObject</code><a class="headerlink" href="#_CPPv2N10procRecord9dtcObjectE" title="Permalink to this definition">¶</a></dt>
<dd><p>Object which contains information of the intermediate FITS file (to be written if <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-intermediate"><code class="xref std std-option docutils literal"><span class="pre">intermediate</span></code></a> = 1)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10procRecord6recordE">
<span id="procRecord::record__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">record</code><a class="headerlink" href="#_CPPv2N10procRecord6recordE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with signal values of input record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N10procRecord11foundPulsesE">
<span id="procRecord::foundPulses__PulsesCollectionP"></span>PulsesCollection *<code class="descclassname"></code><code class="descname">foundPulses</code><a class="headerlink" href="#_CPPv2N10procRecord11foundPulsesE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output structure where the info about found pulses is stored</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv212pulseGradingP21ReconstructInitSIRENAiiiPiPl">
<span id="pulseGrading__ReconstructInitSIRENAP.i.i.i.iP.lP"></span>int <code class="descclassname"></code><code class="descname">pulseGrading</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em>, int <em>grade1</em>, int <em>grade2_1</em>, int <em>OFlength_strategy</em>, int *<em>pulseGrade</em>, long *<em>OFlength</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv212pulseGradingP21ReconstructInitSIRENAiiiPiPl" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function provides the pulse grade (Pileup=-2, Rejected=-1, HighRes=1, MidRes=2, LowRes=3) and the optimal filter length by taking into account the info read from the XML file and the <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFStrategy"><code class="xref std std-option docutils literal"><span class="pre">OFStrategy</span></code></a> (<strong>FREE</strong>, <strong>BASE2</strong>, <strong>BYGRADE</strong> or <strong>FIXED</strong>).</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N12pulseGrading16reconstruct_initE">
<span id="pulseGrading::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N12pulseGrading16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses the  <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFLength"><code class="xref std std-option docutils literal"><span class="pre">OFLength</span></code></a> and <em>grading</em></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12pulseGrading6grade1E">
<span id="pulseGrading::grade1__i"></span>int <code class="descclassname"></code><code class="descname">grade1</code><a class="headerlink" href="#_CPPv2N12pulseGrading6grade1E" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulse duration (length of optimal filter applied)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12pulseGrading8grade2_1E">
<span id="pulseGrading::grade2_1__i"></span>int <code class="descclassname"></code><code class="descname">grade2_1</code><a class="headerlink" href="#_CPPv2N12pulseGrading8grade2_1E" title="Permalink to this definition">¶</a></dt>
<dd><p>Difference between the start time of the pulse and the start time of the previous pulse</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12pulseGrading17OFlength_strategyE">
<span id="pulseGrading::OFlength_strategy__i"></span>int <code class="descclassname"></code><code class="descname">OFlength_strategy</code><a class="headerlink" href="#_CPPv2N12pulseGrading17OFlength_strategyE" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFStrategy"><code class="xref std std-option docutils literal"><span class="pre">OFStrategy</span></code></a> (input)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12pulseGrading10pulseGradeE">
<span id="pulseGrading::pulseGrade__iP"></span>int *<code class="descclassname"></code><code class="descname">pulseGrade</code><a class="headerlink" href="#_CPPv2N12pulseGrading10pulseGradeE" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulse grade (output)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12pulseGrading8OFlengthE">
<span id="pulseGrading::OFlength__lP"></span>long *<code class="descclassname"></code><code class="descname">OFlength</code><a class="headerlink" href="#_CPPv2N12pulseGrading8OFlengthE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal filter length (= <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFLength"><code class="xref std std-option docutils literal"><span class="pre">OFLength</span></code></a> only if <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFStrategy"><code class="xref std std-option docutils literal"><span class="pre">OFStrategy</span></code></a> = <strong>FIXED</strong>) (output)</p>
</dd></dl>

</dd></dl>

<span class="target" id="r"><span id="q"></span></span><dl class="function">
<dt id="_CPPv218readAddOrderParamsP21ReconstructInitSIRENAPP8fitsfiledidP10gsl_vectorP10gsl_matrixP10gsl_matrix">
<span id="readAddOrderParams__ReconstructInitSIRENAP.fitsfilePP.double.i.double.gsl_vectorP.gsl_matrixP.gsl_matrixP"></span>int <code class="descclassname"></code><code class="descname">readAddOrderParams</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em>, fitsfile **<em>inLibObject</em>, double <em>samprate</em>, int <em>eventcntLib</em>, double <em>estenergy</em>, gsl_vector *<em>pulsetemplate</em>, gsl_matrix *<em>covariance</em>, gsl_matrix *<em>weight</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv218readAddOrderParamsP21ReconstructInitSIRENAPP8fitsfiledidP10gsl_vectorP10gsl_matrixP10gsl_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function reads the library data, add new data and sort the data according to an energy-ascending order.</p>
<ul class="simple">
<li>Declare variables</li>
<li>Load values already in the library</li>
<li>Add new values</li>
<li>Realign</li>
<li>Add intermeadiate values</li>
<li>Recalculate intermediate values of some new pairs</li>
<li>Write values in the library</li>
<li>Free allocated GSL vectors</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N18readAddOrderParams16reconstruct_initE">
<span id="readAddOrderParams::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N18readAddOrderParams16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-PulseLength"><code class="xref std std-option docutils literal"><span class="pre">PulseLength</span></code></a>, <em>library_collection</em>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-monoenergy"><code class="xref std std-option docutils literal"><span class="pre">monoenergy</span></code></a>, <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> and <em>noise_spectrum</em></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18readAddOrderParams11inLibObjectE">
<span id="readAddOrderParams::inLibObject__fitsfilePP"></span>fitsfile **<code class="descclassname"></code><code class="descname">inLibObject</code><a class="headerlink" href="#_CPPv2N18readAddOrderParams11inLibObjectE" title="Permalink to this definition">¶</a></dt>
<dd><p>FITS object containing information of the library FITS file</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18readAddOrderParams8samprateE">
<span id="readAddOrderParams::samprate__double"></span>double <code class="descclassname"></code><code class="descname">samprate</code><a class="headerlink" href="#_CPPv2N18readAddOrderParams8samprateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18readAddOrderParams11eventcntLibE">
<span id="readAddOrderParams::eventcntLib__i"></span>int <code class="descclassname"></code><code class="descname">eventcntLib</code><a class="headerlink" href="#_CPPv2N18readAddOrderParams11eventcntLibE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of templates in the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18readAddOrderParams9estenergyE">
<span id="readAddOrderParams::estenergy__double"></span>double <code class="descclassname"></code><code class="descname">estenergy</code><a class="headerlink" href="#_CPPv2N18readAddOrderParams9estenergyE" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulse height of the template whose energy is going to be added to the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18readAddOrderParams13pulsetemplateE">
<span id="readAddOrderParams::pulsetemplate__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">pulsetemplate</code><a class="headerlink" href="#_CPPv2N18readAddOrderParams13pulsetemplateE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the pulse template whose energy is going to be added to the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18readAddOrderParams10covarianceE">
<span id="readAddOrderParams::covariance__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">covariance</code><a class="headerlink" href="#_CPPv2N18readAddOrderParams10covarianceE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL matrix with covariance matrix of the energy which is going to be added to the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N18readAddOrderParams6weightE">
<span id="readAddOrderParams::weight__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">weight</code><a class="headerlink" href="#_CPPv2N18readAddOrderParams6weightE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL matrix with weight matrix of the energy which is going to be added to the library</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv215readFitsComplex6IODataPP10gsl_matrix">
<span id="readFitsComplex__IOData.gsl_matrixPP"></span>int <code class="descclassname"></code><code class="descname">readFitsComplex</code><span class="sig-paren">(</span>IOData <em>obj</em>, gsl_matrix **<em>result</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv215readFitsComplex6IODataPP10gsl_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>inoututils.cpp</em></p>
<p>This function reads values of a complex column of a FITS file. After that, the function puts them into a GSL matrix for an easier processing.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N15readFitsComplex3objE">
<span id="readFitsComplex::obj__IOData"></span>IOData <code class="descclassname"></code><code class="descname">obj</code><a class="headerlink" href="#_CPPv2N15readFitsComplex3objE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input object for complex FITS column</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15readFitsComplex6resultE">
<span id="readFitsComplex::result__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">result</code><a class="headerlink" href="#_CPPv2N15readFitsComplex6resultE" title="Permalink to this definition">¶</a></dt>
<dd><p>Output GSL matrix</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv214readFitsSimple6IODataPP10gsl_vector">
<span id="readFitsSimple__IOData.gsl_vectorPP"></span>int <code class="descclassname"></code><code class="descname">readFitsSimple</code><span class="sig-paren">(</span>IOData <em>obj</em>, gsl_vector **<em>result</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv214readFitsSimple6IODataPP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>inoututils.cpp</em></p>
<p>This function reads values of a simple column of a FITS file. After that, the function puts them into a GSL vector for an easier processing.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N14readFitsSimple3objE">
<span id="readFitsSimple::obj__IOData"></span>IOData <code class="descclassname"></code><code class="descname">obj</code><a class="headerlink" href="#_CPPv2N14readFitsSimple3objE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input object for simple FITS column</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14readFitsSimple6resultE">
<span id="readFitsSimple::result__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">result</code><a class="headerlink" href="#_CPPv2N14readFitsSimple6resultE" title="Permalink to this definition">¶</a></dt>
<dd><p>Output GSL vector</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv223reconstructRecordSIRENAP9TesRecordP12TesEventListP21ReconstructInitSIRENAiiPP16PulsesCollectionPP19OptimalFilterSIRENAPCi">
<span id="reconstructRecordSIRENA__TesRecordP.TesEventListP.ReconstructInitSIRENAP.i.i.PulsesCollectionPP.OptimalFilterSIRENAPP.iPC"></span>extern_C_void <code class="descclassname"></code><code class="descname">reconstructRecordSIRENA</code><span class="sig-paren">(</span>TesRecord *<em>record</em>, TesEventList *<em>event_list</em>, ReconstructInitSIRENA *<em>reconstruct_init</em>, int <em>lastRecord</em>, int <em>nRecord</em>, PulsesCollection **<em>pulsesAll</em>, OptimalFilterSIRENA **<em>optimalFilter</em>, int *<em class="property">const</em> <em>status</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv223reconstructRecordSIRENAP9TesRecordP12TesEventListP21ReconstructInitSIRENAiiPP16PulsesCollectionPP19OptimalFilterSIRENAPCi" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>integraSIRENA.cpp</em></p>
<p>This function is the main wrapper function to detect, grade and calculate energy of pulses in input records.</p>
<ul>
<li><p class="first">Inititalize structure <em>PulsesCollection</em></p>
</li>
<li><p class="first">Check consistency of some input parameters</p>
</li>
<li><p class="first">Detect pulses in input record (<a class="reference internal" href="#_CPPv29runDetectP9TesRecordiP16PulsesCollectionPP21ReconstructInitSIRENAPP16PulsesCollection" title="runDetect"><code class="xref cpp cpp-func docutils literal"><span class="pre">runDetect()</span></code></a>). Save information of detected pulses</p>
<blockquote>
<div><ul class="simple">
<li>If PCA, pulses energies are already written in the <a class="reference internal" href="#_CPPv2N23reconstructRecordSIRENA9pulsesAllE" title="reconstructRecordSIRENA::pulsesAll"><code class="xref cpp cpp-member docutils literal"><span class="pre">pulsesAll</span></code></a> structure</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">If in RECONSTRUCTION (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 1):</p>
<blockquote>
<div><ul class="simple">
<li>Filter record and calculate energy of pulses (<a class="reference internal" href="#_CPPv29runEnergyP9TesRecordPP21ReconstructInitSIRENAPP16PulsesCollectionPP19OptimalFilterSIRENA" title="runEnergy"><code class="xref cpp cpp-func docutils literal"><span class="pre">runEnergy()</span></code></a>)</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Populate output event list with pulses energies, arrival time and grading</p>
</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N23reconstructRecordSIRENA6recordE">
<span id="reconstructRecordSIRENA::record__TesRecordP"></span>TesRecord *<code class="descclassname"></code><code class="descname">record</code><a class="headerlink" href="#_CPPv2N23reconstructRecordSIRENA6recordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Instance of <em>TesRecord</em> structure that contains the input record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N23reconstructRecordSIRENA10event_listE">
<span id="reconstructRecordSIRENA::event_list__TesEventListP"></span>TesEventList *<code class="descclassname"></code><code class="descname">event_list</code><a class="headerlink" href="#_CPPv2N23reconstructRecordSIRENA10event_listE" title="Permalink to this definition">¶</a></dt>
<dd><p>Instance of <em>TesEventList</em> structure that contains the information of the reconstructed pulses</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N23reconstructRecordSIRENA16reconstruct_initE">
<span id="reconstructRecordSIRENA::reconstruct_init__ReconstructInitSIRENAP"></span>ReconstructInitSIRENA *<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N23reconstructRecordSIRENA16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N23reconstructRecordSIRENA10lastRecordE">
<span id="reconstructRecordSIRENA::lastRecord__i"></span>int <code class="descclassname"></code><code class="descname">lastRecord</code><a class="headerlink" href="#_CPPv2N23reconstructRecordSIRENA10lastRecordE" title="Permalink to this definition">¶</a></dt>
<dd><p>If record being analyzed is the last one, <a class="reference internal" href="#_CPPv2N23reconstructRecordSIRENA10lastRecordE" title="reconstructRecordSIRENA::lastRecord"><code class="xref cpp cpp-member docutils literal"><span class="pre">lastRecord</span></code></a> = 1. Otherwise it is equal to 0</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N23reconstructRecordSIRENA7nRecordE">
<span id="reconstructRecordSIRENA::nRecord__i"></span>int <code class="descclassname"></code><code class="descname">nRecord</code><a class="headerlink" href="#_CPPv2N23reconstructRecordSIRENA7nRecordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input record number</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N23reconstructRecordSIRENA9pulsesAllE">
<span id="reconstructRecordSIRENA::pulsesAll__PulsesCollectionPP"></span>PulsesCollection **<code class="descclassname"></code><code class="descname">pulsesAll</code><a class="headerlink" href="#_CPPv2N23reconstructRecordSIRENA9pulsesAllE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>PulsesCollection</em> structure to successively store all the pulses used to create the library. Re-populated after each processed record.</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N23reconstructRecordSIRENA13optimalFilterE">
<span id="reconstructRecordSIRENA::optimalFilter__OptimalFilterSIRENAPP"></span>OptimalFilterSIRENA **<code class="descclassname"></code><code class="descname">optimalFilter</code><a class="headerlink" href="#_CPPv2N23reconstructRecordSIRENA13optimalFilterE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal filters used in reconstruction</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N23reconstructRecordSIRENA6statusE">
<span id="reconstructRecordSIRENA::status__iPC"></span>int *<em class="property">const</em> <code class="descclassname"></code><code class="descname">status</code><a class="headerlink" href="#_CPPv2N23reconstructRecordSIRENA6statusE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input/output status</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv29RS_filterP10gsl_vectordddPd">
<span id="RS_filter__gsl_vectorP.double.double.double.doubleP"></span>int <code class="descclassname"></code><code class="descname">RS_filter</code><span class="sig-paren">(</span>gsl_vector *<em>vector</em>, double <em>lrs</em>, double <em>lb</em>, double <em>B</em>, double *<em>pulseheight</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv29RS_filterP10gsl_vectordddPd" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>pulseprocess.cpp</em></p>
<p>This function uses the running sum filter to find the pulse height. It always works in time domain.</p>
<p>A running sum filter, <em>RS</em>, is the sum of <a class="reference internal" href="#_CPPv2N9RS_filter3lrsE" title="RS_filter::lrs"><code class="xref cpp cpp-member docutils literal"><span class="pre">lrs</span></code></a> digitized data samples. It is continuously updated upon the arrival of
new data point. Simultaneously a baseline filter, <a class="reference internal" href="#_CPPv2N9RS_filter1BE" title="RS_filter::B"><code class="xref cpp cpp-member docutils literal"><span class="pre">B</span></code></a>, is the sum of <a class="reference internal" href="#_CPPv2N9RS_filter2lbE" title="RS_filter::lb"><code class="xref cpp cpp-member docutils literal"><span class="pre">lb</span></code></a> digitized data samples without pulses. The
algorithm looks for the time when <em>RS/lrs</em> reaches its maximum. At that time <em>RS</em> is stored, <img class="math" src="_images/math/ff320d575b88570a542c4eddf672114ed72f1062.png" alt="RS_{max}"/>, and the baseline
is scaled with <a class="reference internal" href="#_CPPv2N9RS_filter3lrsE" title="RS_filter::lrs"><code class="xref cpp cpp-member docutils literal"><span class="pre">lrs</span></code></a>, <em>Bp</em> ( <img class="math" src="_images/math/b5cfd31b955e6470000ec26a6472b0a028c8bd1d.png" alt="Bp=B \cdot lrs/lb"/>). Then, the pulse height related to the pulse pseudoenergy is given by:</p>
<div class="math">
<p><img src="_images/math/e46dd77a40f398f6a621043c8bcd272b39949158.png" alt="Pulse height=\frac{RS_{max}-B_p}{lrs}"/></p>
</div><p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N9RS_filter6vectorE">
<span id="RS_filter::vector__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">vector</code><a class="headerlink" href="#_CPPv2N9RS_filter6vectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Not filtered pulse (extracted from the record in <a class="reference internal" href="#_CPPv214getPulseHeightP10gsl_vectorddidddiPd" title="getPulseHeight"><code class="xref cpp cpp-func docutils literal"><span class="pre">getPulseHeight()</span></code></a>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N9RS_filter3lrsE">
<span id="RS_filter::lrs__double"></span>double <code class="descclassname"></code><code class="descname">lrs</code><a class="headerlink" href="#_CPPv2N9RS_filter3lrsE" title="Permalink to this definition">¶</a></dt>
<dd><p>Running sum length (samples)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N9RS_filter2lbE">
<span id="RS_filter::lb__double"></span>double <code class="descclassname"></code><code class="descname">lb</code><a class="headerlink" href="#_CPPv2N9RS_filter2lbE" title="Permalink to this definition">¶</a></dt>
<dd><p>Baseline averaging length (samples)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N9RS_filter1BE">
<span id="RS_filter::B__double"></span>double <code class="descclassname"></code><code class="descname">B</code><a class="headerlink" href="#_CPPv2N9RS_filter1BE" title="Permalink to this definition">¶</a></dt>
<dd><p>In general, sum of the <a class="reference internal" href="#_CPPv2N9RS_filter2lbE" title="RS_filter::lb"><code class="xref cpp cpp-member docutils literal"><span class="pre">lb</span></code></a> digitized data samples of a pulse-free interval immediately before the current pulse</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N9RS_filter11pulseheightE">
<span id="RS_filter::pulseheight__doubleP"></span>double *<code class="descclassname"></code><code class="descname">pulseheight</code><a class="headerlink" href="#_CPPv2N9RS_filter11pulseheightE" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulseheight of the input pulse</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv29runDetectP9TesRecordiP16PulsesCollectionPP21ReconstructInitSIRENAPP16PulsesCollection">
<span id="runDetect__TesRecordP.i.PulsesCollectionP.ReconstructInitSIRENAPP.PulsesCollectionPP"></span>void <code class="descclassname"></code><code class="descname">runDetect</code><span class="sig-paren">(</span>TesRecord *<em>record</em>, int <em>lastRecord</em>, PulsesCollection *<em>pulsesAll</em>, ReconstructInitSIRENA **<em>reconstruct_init</em>, PulsesCollection **<em>pulsesInRecord</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv29runDetectP9TesRecordiP16PulsesCollectionPP21ReconstructInitSIRENAPP16PulsesCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function is responsible for the <strong>detection</strong> in SIRENA, record by record. It is used both for library creation (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 0) and energy reconstruction (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 1) runnings.</p>
<p>Conditions:</p>
<blockquote>
<div><ul class="simple">
<li>If first record and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 1  <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/>  Run <a class="reference internal" href="#_CPPv213filderLibraryPP21ReconstructInitSIRENAd" title="filderLibrary"><code class="xref cpp cpp-func docutils literal"><span class="pre">filderLibrary()</span></code></a></li>
<li>If last record and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 0 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Run <a class="reference internal" href="#_CPPv217calculateTemplateP21ReconstructInitSIRENAP16PulsesCollectionP16PulsesCollectiondPP10gsl_vectorPdPP10gsl_matrixPP10gsl_matrix" title="calculateTemplate"><code class="xref cpp cpp-func docutils literal"><span class="pre">calculateTemplate()</span></code></a> and <a class="reference internal" href="#_CPPv212writeLibraryP21ReconstructInitSIRENAddP10gsl_vectorP10gsl_matrixP10gsl_matrixbPP8fitsfile" title="writeLibrary"><code class="xref cpp cpp-func docutils literal"><span class="pre">writeLibrary()</span></code></a></li>
<li>If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-intermediate"><code class="xref std std-option docutils literal"><span class="pre">intermediate</span></code></a> = 1 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv213writeTestInfoP21ReconstructInitSIRENAP10gsl_vectordP8fitsfile" title="writeTestInfo"><code class="xref cpp cpp-func docutils literal"><span class="pre">writeTestInfo()</span></code></a> and <a class="reference internal" href="#_CPPv211writePulsesPP21ReconstructInitSIRENAddP10gsl_vectoriP10gsl_vectorP10gsl_vectorP10gsl_vectorP10gsl_vectorP10gsl_vectorP8fitsfile" title="writePulses"><code class="xref cpp cpp-func docutils literal"><span class="pre">writePulses()</span></code></a></li>
<li>If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 0 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Find pulses by using <a class="reference internal" href="#_CPPv213findPulsesCALP10gsl_vectorP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPP10gsl_vectorPiPdddidddP21ReconstructInitSIRENAdd" title="findPulsesCAL"><code class="xref cpp cpp-func docutils literal"><span class="pre">findPulsesCAL()</span></code></a></li>
<li>If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 1 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Find pulses by <a class="reference internal" href="#_CPPv217InitialTriggeringP10gsl_vectordddddPbPiPiPdi" title="InitialTriggering"><code class="xref cpp cpp-func docutils literal"><span class="pre">InitialTriggering()</span></code></a> and <a class="reference internal" href="#_CPPv215FindSecondariesiP10gsl_vectordP21ReconstructInitSIRENAiPiPP10gsl_vectorPP10gsl_vectorPP10gsl_vector" title="FindSecondaries"><code class="xref cpp cpp-func docutils literal"><span class="pre">FindSecondaries()</span></code></a></li>
</ul>
</div></blockquote>
<p>Steps:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Create library file if it is necessary: last record and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 0 (run <a class="reference internal" href="#_CPPv213createLibraryP21ReconstructInitSIRENAPbPP8fitsfile" title="createLibrary"><code class="xref cpp cpp-func docutils literal"><span class="pre">createLibrary()</span></code></a>)</p>
</li>
<li><p class="first">Create intermediate output FITS file if required (<a class="reference internal" href="#_CPPv216createDetectFileP21ReconstructInitSIRENAdPP8fitsfile" title="createDetectFile"><code class="xref cpp cpp-func docutils literal"><span class="pre">createDetectFile()</span></code></a>)</p>
</li>
<li><p class="first">(Filter and) differentiate the <em>models</em> of the library (only for the first record in <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 1 run  (<a class="reference internal" href="#_CPPv213filderLibraryPP21ReconstructInitSIRENAd" title="filderLibrary"><code class="xref cpp cpp-func docutils literal"><span class="pre">filderLibrary()</span></code></a>)</p>
</li>
<li><p class="first">Store the input record in <em>invector</em> (<a class="reference internal" href="#_CPPv210loadRecordP9TesRecordPdPP10gsl_vector" title="loadRecord"><code class="xref cpp cpp-func docutils literal"><span class="pre">loadRecord()</span></code></a>)</p>
</li>
<li><p class="first">Convert <em>I</em> into <em>R</em> if <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>I2R</strong>, <strong>I2RALL</strong>, <strong>I2RNOL</strong> or <strong>I2RFITTED</strong> (<a class="reference internal" href="#_CPPv210convertI2RPP21ReconstructInitSIRENAPP9TesRecordPP10gsl_vector" title="convertI2R"><code class="xref cpp cpp-func docutils literal"><span class="pre">convertI2R()</span></code></a>)</p>
</li>
<li><p class="first">Process each record (<code class="xref cpp cpp-func docutils literal"><span class="pre">proceRecord()</span></code>):</p>
<blockquote>
<div><ul class="simple">
<li>(Low-pass filter and) differentiate</li>
<li>Find pulses</li>
<li>Load the found pulses data in the input/output <em>foundPulses</em> structure</li>
<li>Write test info in intermediate output FITS file if <em>reconstruct_init-&gt;intermediate</em> = 1 (<a class="reference internal" href="#_CPPv213writeTestInfoP21ReconstructInitSIRENAP10gsl_vectordP8fitsfile" title="writeTestInfo"><code class="xref cpp cpp-func docutils literal"><span class="pre">writeTestInfo()</span></code></a>)</li>
<li>Write pulses info in intermediate output FITS file if <em>reconstruct_init-&gt;intermediate</em> = 1 (<a class="reference internal" href="#_CPPv211writePulsesPP21ReconstructInitSIRENAddP10gsl_vectoriP10gsl_vectorP10gsl_vectorP10gsl_vectorP10gsl_vectorP10gsl_vectorP8fitsfile" title="writePulses"><code class="xref cpp cpp-func docutils literal"><span class="pre">writePulses()</span></code></a>)</li>
</ul>
</div></blockquote>
<p><strong>From this point forward, I2R, I2RALL, I2RNOL and I2RFITTED are completely equivalent to OPTFILT</strong></p>
</li>
<li><p class="first">If last record in <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 0 run:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#_CPPv217calculateTemplateP21ReconstructInitSIRENAP16PulsesCollectionP16PulsesCollectiondPP10gsl_vectorPdPP10gsl_matrixPP10gsl_matrix" title="calculateTemplate"><code class="xref cpp cpp-func docutils literal"><span class="pre">calculateTemplate()</span></code></a> (and <a class="reference internal" href="#_CPPv212weightMatrixP21ReconstructInitSIRENAbP16PulsesCollectionP16PulsesCollectionlP10gsl_vectorP10gsl_vectorPP10gsl_matrixPP10gsl_matrix" title="weightMatrix"><code class="xref cpp cpp-func docutils literal"><span class="pre">weightMatrix()</span></code></a>)</li>
<li><a class="reference internal" href="#_CPPv212writeLibraryP21ReconstructInitSIRENAddP10gsl_vectorP10gsl_matrixP10gsl_matrixbPP8fitsfile" title="writeLibrary"><code class="xref cpp cpp-func docutils literal"><span class="pre">writeLibrary()</span></code></a></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">If last record and PCA</p>
<blockquote>
<div><ul class="simple">
<li>In order to not have restrictions when providing (*reconstruct_init)-&gt;energyPCAx</li>
<li>Covariance data</li>
<li>Eigenvalues and eigenvectors</li>
<li>RSxN (S=2)</li>
<li>AE straight line: Pto0(x,y) and Pto10(x,y)</li>
<li>Calculus of the rotation angle</li>
<li>Rotation</li>
<li>Histograms of the two clusters (two energies)</li>
<li>Conversion factor from arbitrary unit to eV</li>
<li>Energy calculation</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Close intermediate output FITS file if it is necessary</p>
</li>
</ol>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N9runDetect6recordE">
<span id="runDetect::record__TesRecordP"></span>TesRecord *<code class="descclassname"></code><code class="descname">record</code><a class="headerlink" href="#_CPPv2N9runDetect6recordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>TesRecord</em> structure that contains the input record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N9runDetect10lastRecordE">
<span id="runDetect::lastRecord__i"></span>int <code class="descclassname"></code><code class="descname">lastRecord</code><a class="headerlink" href="#_CPPv2N9runDetect10lastRecordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer to verify whether record is the last one (=1) to be read (and thus if library file will be created)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N9runDetect9pulsesAllE">
<span id="runDetect::pulsesAll__PulsesCollectionP"></span>PulsesCollection *<code class="descclassname"></code><code class="descname">pulsesAll</code><a class="headerlink" href="#_CPPv2N9runDetect9pulsesAllE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>PulsesCollection</em> structure to successively store all the pulses used to create the library. Re-populated after each processed record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N9runDetect16reconstruct_initE">
<span id="runDetect::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N9runDetect16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N9runDetect14pulsesInRecordE">
<span id="runDetect::pulsesInRecord__PulsesCollectionPP"></span>PulsesCollection **<code class="descclassname"></code><code class="descname">pulsesInRecord</code><a class="headerlink" href="#_CPPv2N9runDetect14pulsesInRecordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>PulsesCollection</em> structure to store all the pulses found in the input record</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv29runEnergyP9TesRecordPP21ReconstructInitSIRENAPP16PulsesCollectionPP19OptimalFilterSIRENA">
<span id="runEnergy__TesRecordP.ReconstructInitSIRENAPP.PulsesCollectionPP.OptimalFilterSIRENAPP"></span>void <code class="descclassname"></code><code class="descname">runEnergy</code><span class="sig-paren">(</span>TesRecord *<em>record</em>, ReconstructInitSIRENA **<em>reconstruct_init</em>, PulsesCollection **<em>pulsesInRecord</em>, OptimalFilterSIRENA **<em>optimalFilter</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv29runEnergyP9TesRecordPP21ReconstructInitSIRENAPP16PulsesCollectionPP19OptimalFilterSIRENA" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function calculates the pulse energy applying different methods (from <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a>).
It only runs in RECONSTRUCTION mode (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = <em>1</em>) (except to <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>PCA</strong>).</p>
<ul>
<li><p class="first">Declare variables</p>
</li>
<li><p class="first">Store the <a class="reference internal" href="#_CPPv2N9runEnergy6recordE" title="runEnergy::record"><code class="xref cpp cpp-member docutils literal"><span class="pre">record</span></code></a> in <em>invector</em> (<a class="reference internal" href="#_CPPv210loadRecordP9TesRecordPdPP10gsl_vector" title="loadRecord"><code class="xref cpp cpp-func docutils literal"><span class="pre">loadRecord()</span></code></a>)</p>
</li>
<li><p class="first">Subtract the baseline if <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>OPTFILT</strong> and <em>runF0orB0val</em> = 1 (<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterMethod"><code class="xref std std-option docutils literal"><span class="pre">FilterMethod</span></code></a> = <strong>B0</strong>)</p>
</li>
<li><p class="first">Subtract the baseline if <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>WEIGHT</strong></p>
</li>
<li><p class="first">Check Quality</p>
</li>
<li><p class="first">For each pulse:</p>
<blockquote>
<div><ul>
<li><p class="first">Establish the pulse grade (HighRes=0, MidRes=1, LowRes=-1) and the optimal filter length</p>
</li>
<li><p class="first">Pulse: Load the proper piece of the record in <em>pulse</em></p>
</li>
<li><p class="first">If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFIter"><code class="xref std std-option docutils literal"><span class="pre">OFIter</span></code></a> = 1, in the first iteration ( <em>numiteration</em> = 0) the values of <em>maxDER</em> and <em>maxDERs</em> are used in
<a class="reference internal" href="#_CPPv218find_matchedfilteridP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPdPd" title="find_matchedfilter"><code class="xref cpp cpp-func docutils literal"><span class="pre">find_matchedfilter()</span></code></a>, <a class="reference internal" href="#_CPPv221find_matchedfilterDABdP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPP10gsl_vectorPdPd" title="find_matchedfilterDAB"><code class="xref cpp cpp-func docutils literal"><span class="pre">find_matchedfilterDAB()</span></code></a>, <a class="reference internal" href="#_CPPv218find_optimalfilterdP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPdPd" title="find_optimalfilter"><code class="xref cpp cpp-func docutils literal"><span class="pre">find_optimalfilter()</span></code></a>, <a class="reference internal" href="#_CPPv221find_optimalfilterDABdP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPP10gsl_vectorPdPd" title="find_optimalfilterDAB"><code class="xref cpp cpp-func docutils literal"><span class="pre">find_optimalfilterDAB()</span></code></a> or <a class="reference internal" href="#_CPPv215find_EsboundarydP10gsl_vectorP21ReconstructInitSIRENAPiPiPdPd" title="find_Esboundary"><code class="xref cpp cpp-func docutils literal"><span class="pre">find_Esboundary()</span></code></a> getting the values of the <em>energies</em> which straddle the <em>maxDER</em> (<em>Ealpha</em> and <em>Ebeta</em>). It will have more iterations if the calculated <em>energy</em> is out of <em>[Ealpha, Ebeta]</em>. If <em>energy</em> is in <em>[Ealpha, Ebeta]</em> the iterative process stops.</p>
<blockquote>
<div><ul>
<li><p class="first">If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>OPTFILT</strong> (or <strong>I2R</strong>, <strong>I2RALL</strong>, <strong>I2RNOL</strong>, <strong>I2RFITTED</strong>) and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFLib"><code class="xref std std-option docutils literal"><span class="pre">OFLib</span></code></a> = 0:</p>
<blockquote>
<div><ul class="simple">
<li>Filter (find the matched filter and load it in <em>filter</em>)<ul>
<li>If <em>MF</em> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv218find_matchedfilteridP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPdPd" title="find_matchedfilter"><code class="xref cpp cpp-func docutils literal"><span class="pre">find_matchedfilter()</span></code></a></li>
<li>If <em>DAB</em> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv221find_matchedfilterDABdP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPP10gsl_vectorPdPd" title="find_matchedfilterDAB"><code class="xref cpp cpp-func docutils literal"><span class="pre">find_matchedfilterDAB()</span></code></a></li>
</ul>
</li>
<li>Calculate the optimal filter</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>OPTFILT</strong> (or <strong>I2R</strong>, <strong>I2RALL</strong>, <strong>I2RNOL</strong>, <strong>I2RFITTED</strong>) and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFLib"><code class="xref std std-option docutils literal"><span class="pre">OFLib</span></code></a> = 1:</p>
<blockquote>
<div><ul class="simple">
<li>Choose the base-2 system value closest (lower than or equal) to the pulse length</li>
<li>Filter (find the optimal filter and load it in <em>filter</em>)<ul>
<li>If <em>MF</em> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv218find_optimalfilterdP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPdPd" title="find_optimalfilter"><code class="xref cpp cpp-func docutils literal"><span class="pre">find_optimalfilter()</span></code></a></li>
<li>If <em>DAB</em> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> <a class="reference internal" href="#_CPPv221find_optimalfilterDABdP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPP10gsl_vectorPdPd" title="find_optimalfilterDAB"><code class="xref cpp cpp-func docutils literal"><span class="pre">find_optimalfilterDAB()</span></code></a></li>
</ul>
</li>
<li>If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-FilterDomain"><code class="xref std std-option docutils literal"><span class="pre">FilterDomain</span></code></a> = <strong>F</strong> <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Bin0 = 0 and conjugate</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>WEIGHT</strong> or <strong>WEIGHTN</strong>:</p>
<blockquote>
<div><ul>
<li><p class="first">Get the indexes of the two energies which straddle the pulse</p>
</li>
<li><p class="first">If <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a> = <strong>WEIGHTN</strong> and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-OFLib"><code class="xref std std-option docutils literal"><span class="pre">OFLib</span></code></a> = 1:</p>
<blockquote>
<div><ul class="simple">
<li>Choose the base-2 system value closest (lower than or equal) to the pulse length</li>
<li><a class="reference internal" href="#_CPPv211find_prclwndP10gsl_vectorP21ReconstructInitSIRENAPP10gsl_vectorPP10gsl_vectorPdPd" title="find_prclwn"><code class="xref cpp cpp-func docutils literal"><span class="pre">find_prclwn()</span></code></a> to find the appropriate values of the PRECALWN HDU (<strong>PRCLx</strong> columns)</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Calculate the energy of each pulse</p>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Subtract the pulse model from the record</p>
</li>
<li><p class="first">Write info of the pulse in the output intemediate file if <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-intermediate"><code class="xref std std-option docutils literal"><span class="pre">intermediate</span></code></a> = 1</p>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Free allocated GSL vectors</p>
</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N9runEnergy6recordE">
<span id="runEnergy::record__TesRecordPP"></span>TesRecord **<code class="descclassname"></code><code class="descname">record</code><a class="headerlink" href="#_CPPv2N9runEnergy6recordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Structure that contains the input ADC record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N9runEnergy16reconstruct_initE">
<span id="runEnergy::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N9runEnergy16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N9runEnergy14pulsesInRecordE">
<span id="runEnergy::pulsesInRecord__PulsesCollectionP"></span>PulsesCollection *<code class="descclassname"></code><code class="descname">pulsesInRecord</code><a class="headerlink" href="#_CPPv2N9runEnergy14pulsesInRecordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Collection of pulses found in the current record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N9runEnergy13optimalFilterE">
<span id="runEnergy::optimalFilter__OptimalFilterSIRENAPP"></span>OptimalFilterSIRENA **<code class="descclassname"></code><code class="descname">optimalFilter</code><a class="headerlink" href="#_CPPv2N9runEnergy13optimalFilterE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal filters used in reconstruction</p>
</dd></dl>

</dd></dl>

<span class="target" id="s"></span><dl class="function">
<dt id="_CPPv26shiftmP10gsl_vectorP10gsl_vectori">
<span id="shiftm__gsl_vectorP.gsl_vectorP.i"></span>int <code class="descclassname"></code><code class="descname">shiftm</code><span class="sig-paren">(</span>gsl_vector *<em>vectorin</em>, gsl_vector *<em>vectorout</em>, int <em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv26shiftmP10gsl_vectorP10gsl_vectori" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function returns as <a class="reference internal" href="#_CPPv2N6shiftm9vectoroutE" title="shiftm::vectorout"><code class="xref cpp cpp-member docutils literal"><span class="pre">vectorout</span></code></a> the <a class="reference internal" href="#_CPPv2N6shiftm8vectorinE" title="shiftm::vectorin"><code class="xref cpp cpp-member docutils literal"><span class="pre">vectorin</span></code></a> delayed <a class="reference internal" href="#_CPPv2N6shiftm1mE" title="shiftm::m"><code class="xref cpp cpp-member docutils literal"><span class="pre">m</span></code></a> samples.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N6shiftm1mE">
<span id="shiftm::m__i"></span>int <code class="descclassname"></code><code class="descname">m</code><a class="headerlink" href="#_CPPv2N6shiftm1mE" title="Permalink to this definition">¶</a></dt>
<dd><p>Delay in samples</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6shiftm8vectorinE">
<span id="shiftm::vectorin__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">vectorin</code><a class="headerlink" href="#_CPPv2N6shiftm8vectorinE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with input vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N6shiftm9vectoroutE">
<span id="shiftm::vectorout__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">vectorout</code><a class="headerlink" href="#_CPPv2N6shiftm9vectoroutE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL with input vector (<a class="reference internal" href="#_CPPv2N6shiftm8vectorinE" title="shiftm::vectorin"><code class="xref cpp cpp-member docutils literal"><span class="pre">vectorin</span></code></a>) delayed <a class="reference internal" href="#_CPPv2N6shiftm1mE" title="shiftm::m"><code class="xref cpp cpp-member docutils literal"><span class="pre">m</span></code></a> samples</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv27shift_mP10gsl_vectorP10gsl_vectori">
<span id="shift_m__gsl_vectorP.gsl_vectorP.i"></span>int <code class="descclassname"></code><code class="descname">shift_m</code><span class="sig-paren">(</span>gsl_vector *<em>vectorin</em>, gsl_vector *<em>vectorout</em>, int <em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv27shift_mP10gsl_vectorP10gsl_vectori" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function returns as <a class="reference internal" href="#_CPPv2N7shift_m9vectoroutE" title="shift_m::vectorout"><code class="xref cpp cpp-member docutils literal"><span class="pre">vectorout</span></code></a> the <a class="reference internal" href="#_CPPv2N7shift_m8vectorinE" title="shift_m::vectorin"><code class="xref cpp cpp-member docutils literal"><span class="pre">vectorin</span></code></a> moved forward by <a class="reference internal" href="#_CPPv2N7shift_m1mE" title="shift_m::m"><code class="xref cpp cpp-member docutils literal"><span class="pre">m</span></code></a> samples.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N7shift_m1mE">
<span id="shift_m::m__i"></span>int <code class="descclassname"></code><code class="descname">m</code><a class="headerlink" href="#_CPPv2N7shift_m1mE" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance in samples</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N7shift_m8vectorinE">
<span id="shift_m::vectorin__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">vectorin</code><a class="headerlink" href="#_CPPv2N7shift_m8vectorinE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with input vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N7shift_m9vectoroutE">
<span id="shift_m::vectorout__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">vectorout</code><a class="headerlink" href="#_CPPv2N7shift_m9vectoroutE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL with input vector (<a class="reference internal" href="#_CPPv2N7shift_m8vectorinE" title="shift_m::vectorin"><code class="xref cpp cpp-member docutils literal"><span class="pre">vectorin</span></code></a>) moved forward <a class="reference internal" href="#_CPPv2N7shift_m1mE" title="shift_m::m"><code class="xref cpp cpp-member docutils literal"><span class="pre">m</span></code></a> samples</p>
</dd></dl>

</dd></dl>

<span class="target" id="t"></span><dl class="function">
<dt id="_CPPv211toGslMatrixPPvPP10gsl_matrixliii">
<span id="toGslMatrix__voidPP.gsl_matrixPP.l.i.i.i"></span>int <code class="descclassname"></code><code class="descname">toGslMatrix</code><span class="sig-paren">(</span>void **<em>buffer</em>, gsl_matrix **<em>matrix</em>, long <em>numCol</em>, int <em>numRow</em>, int <em>type</em>, int <em>eventini</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv211toGslMatrixPPvPP10gsl_matrixliii" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>inoututils.cpp</em></p>
<p>The function puts the values of the input buffer into an output GSL matrix. Columns and rows are input parameters.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N11toGslMatrix6bufferE">
<span id="toGslMatrix::buffer__voidPP"></span>void **<code class="descclassname"></code><code class="descname">buffer</code><a class="headerlink" href="#_CPPv2N11toGslMatrix6bufferE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input buffer with data</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11toGslMatrix6matrixE">
<span id="toGslMatrix::matrix__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">matrix</code><a class="headerlink" href="#_CPPv2N11toGslMatrix6matrixE" title="Permalink to this definition">¶</a></dt>
<dd><p>Output GSL matrix</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11toGslMatrix6numColE">
<span id="toGslMatrix::numCol__l"></span>long <code class="descclassname"></code><code class="descname">numCol</code><a class="headerlink" href="#_CPPv2N11toGslMatrix6numColE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of columns</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11toGslMatrix6numRowE">
<span id="toGslMatrix::numRow__i"></span>int <code class="descclassname"></code><code class="descname">numRow</code><a class="headerlink" href="#_CPPv2N11toGslMatrix6numRowE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of rows</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11toGslMatrix4typeE">
<span id="toGslMatrix::type__i"></span>int <code class="descclassname"></code><code class="descname">type</code><a class="headerlink" href="#_CPPv2N11toGslMatrix4typeE" title="Permalink to this definition">¶</a></dt>
<dd><p>FITS type (TINT, TSHORT, TDOUBLE, etc.)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11toGslMatrix8eventiniE">
<span id="toGslMatrix::eventini__i"></span>int <code class="descclassname"></code><code class="descname">eventini</code><a class="headerlink" href="#_CPPv2N11toGslMatrix8eventiniE" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial event to start writing</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv211toGslVectorPPvPP10gsl_vectorlii">
<span id="toGslVector__voidPP.gsl_vectorPP.l.i.i"></span>int <code class="descclassname"></code><code class="descname">toGslVector</code><span class="sig-paren">(</span>void **<em>buffer</em>, gsl_vector **<em>array</em>, long <em>nevent</em>, int <em>eventini</em>, int <em>type</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv211toGslVectorPPvPP10gsl_vectorlii" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>inoututils.cpp</em></p>
<p>The function puts the values of the input buffer into an output GSL vector.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N11toGslVector6bufferE">
<span id="toGslVector::buffer__voidPP"></span>void **<code class="descclassname"></code><code class="descname">buffer</code><a class="headerlink" href="#_CPPv2N11toGslVector6bufferE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input buffer with data</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11toGslVector5arrayE">
<span id="toGslVector::array__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">array</code><a class="headerlink" href="#_CPPv2N11toGslVector5arrayE" title="Permalink to this definition">¶</a></dt>
<dd><p>Output GSL vector</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11toGslVector6neventE">
<span id="toGslVector::nevent__l"></span>long <code class="descclassname"></code><code class="descname">nevent</code><a class="headerlink" href="#_CPPv2N11toGslVector6neventE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of elements to store</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11toGslVector8eventiniE">
<span id="toGslVector::eventini__i"></span>int <code class="descclassname"></code><code class="descname">eventini</code><a class="headerlink" href="#_CPPv2N11toGslVector8eventiniE" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial element number</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11toGslVector4typeE">
<span id="toGslVector::type__i"></span>int <code class="descclassname"></code><code class="descname">type</code><a class="headerlink" href="#_CPPv2N11toGslVector4typeE" title="Permalink to this definition">¶</a></dt>
<dd><p>FITS type (TINT, TSHORT, TDOUBLE, etc.)</p>
</dd></dl>

</dd></dl>

<span class="target" id="v"><span id="u"></span></span><dl class="function">
<dt id="_CPPv213vector2matrixP10gsl_vectorPP10gsl_matrix">
<span id="vector2matrix__gsl_vectorP.gsl_matrixPP"></span>int <code class="descclassname"></code><code class="descname">vector2matrix</code><span class="sig-paren">(</span>gsl_vector *<em>vectorin</em>, gsl_matrix **<em>matrixout</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv213vector2matrixP10gsl_vectorPP10gsl_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function converts an input <img class="math" src="_images/math/b3f3eaa34b1d5ebe3808600684699430c83cee7f.png" alt="n^2"/> vector into an output <img class="math" src="_images/math/ad8aa55157284eecb46d368d254fbcbcc1808f57.png" alt="[n \times n]"/> square matrix. It puts the first <img class="math" src="_images/math/e11f2701c4a39c7fe543a6c4150b421d50f1c159.png" alt="n"/> elements of the vector in the first row of the matrix, the second group of <img class="math" src="_images/math/e11f2701c4a39c7fe543a6c4150b421d50f1c159.png" alt="n"/> elements (from <img class="math" src="_images/math/e11f2701c4a39c7fe543a6c4150b421d50f1c159.png" alt="n"/> to <img class="math" src="_images/math/7883ee481d56b9b7196947b5f8d19809c42a2a89.png" alt="2n-1"/>) of the vector in the second row and so on.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N13vector2matrix8vectorinE">
<span id="vector2matrix::vectorin__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">vectorin</code><a class="headerlink" href="#_CPPv2N13vector2matrix8vectorinE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL input vector whose length is <img class="math" src="_images/math/b3f3eaa34b1d5ebe3808600684699430c83cee7f.png" alt="n^2"/></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13vector2matrix9matrixoutE">
<span id="vector2matrix::matrixout__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">matrixout</code><a class="headerlink" href="#_CPPv2N13vector2matrix9matrixoutE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL output square matrix <img class="math" src="_images/math/ad8aa55157284eecb46d368d254fbcbcc1808f57.png" alt="[n \times n]"/></p>
</dd></dl>

</dd></dl>

<span class="target" id="w"></span><dl class="function">
<dt id="_CPPv212weightMatrixP21ReconstructInitSIRENAbP16PulsesCollectionP16PulsesCollectionlP10gsl_vectorP10gsl_vectorPP10gsl_matrixPP10gsl_matrix">
<span id="weightMatrix__ReconstructInitSIRENAP.b.PulsesCollectionP.PulsesCollectionP.l.gsl_vectorP.gsl_vectorP.gsl_matrixPP.gsl_matrixPP"></span>int <code class="descclassname"></code><code class="descname">weightMatrix</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em>, bool <em>saturatedPulses</em>, PulsesCollection *<em>pulsesAll</em>, PulsesCollection *<em>pulsesInRecord</em>, long <em>nonpileupPulses</em>, gsl_vector *<em>nonpileup</em>, gsl_vector *<em>pulseaverage</em>, gsl_matrix **<em>covariance</em>, gsl_matrix **<em>weight</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv212weightMatrixP21ReconstructInitSIRENAbP16PulsesCollectionP16PulsesCollectionlP10gsl_vectorP10gsl_vectorPP10gsl_matrixPP10gsl_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p><a class="reference internal" href="zreferences.html#fixsen2004" id="id4">[Fixsen+04]</a></p>
<p>This function calculates the weight matrix by using the non piled-up pulses found in all the records, stored in <em>pulsesAll</em> (previous records) and <em>pulsesInRecord</em> (current record). The weight matrix of each energy (and other intermediate values) will be stored in the library by the function <code class="xref cpp cpp-func docutils literal"><span class="pre">fillInLibraryData()</span></code>.</p>
<p>Definitions:</p>
<blockquote>
<div><p><img class="math" src="_images/math/a722fe8f0741807bf4ceae3434a92c4dd4477c25.png" alt="S_i^p"/>: Value of the ith-sample of the pulse number <em>p</em></p>
<p><img class="math" src="_images/math/5cdc2cb6cfc1d84f54d5c39bfaa1573e52120f84.png" alt="M_i^p"/>: Value of the ith-sample of the model number <em>p</em> (model= <em>pulseaverage</em>):</p>
<div class="math">
<p><img src="_images/math/57d0c2237d902cab235ac0d57e9ea9bfed9f5761.png" alt="M_i = &lt;S_i&gt; = (1/N)\sum_{p=1}^{N}S_i^p"/></p>
</div><p>N: number of non piled-up pulses</p>
<div class="math">
<p><img src="_images/math/017054ff9109c033cafbbf98ed9c88b8a5499068.png" alt="&amp; D_i = S_i - M_i \\
&amp; V_{ij} = &lt;D_iD_j&gt; = E[(S_i-M_i)(S_j-M_j)] = (1/N)\sum_{p=1}^{N}(S_i^p-M_i^p)(S_j^p-M_j^p) \\
&amp; V = \left[\begin{matrix} &lt;D_1D_1&gt; &amp; &lt;D_1D_2&gt; &amp; ... &amp; &lt;D_1D_n&gt; \\
&lt;D_2D_1&gt; &amp; &lt;D_2D_2&gt; &amp; ... &amp; &lt;D_2D_n&gt; \\
....  &amp;  ....  &amp; ... &amp;  ....  \\
&lt;D_nD_1&gt; &amp; &lt;D_nD_2&gt; &amp; ... &amp; &lt;D_nD_n&gt;\end{matrix}\right]"/></p>
</div><p>where <em>n</em> is the <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-PulseLength"><code class="xref std std-option docutils literal"><span class="pre">PulseLength</span></code></a> and thus <img class="math" src="_images/math/58a54ce73bf9e3a580d0f266438b8678b5cc7e7e.png" alt="V = [n \times n]"/>.</p>
<p>The weight matrix <img class="math" src="_images/math/ea47135e58aa6a74050b266f919308105f61f996.png" alt="W = [V]^{-1}"/>.</p>
</div></blockquote>
<p>Steps:</p>
<blockquote>
<div><ul>
<li><p class="first">Calculate the elements of the diagonal of the covariance matrix</p>
</li>
<li><p class="first">Calculate the elements out of the diagonal of the covariance matrix</p>
</li>
<li><p class="first">If saturated pulses <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Covariance matrix is a singular matrix <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Non invertible</p>
<p>In order to allow the covariance matrix to be inverted <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Replacing 0&#8217;s (0&#8217;s are due to the saturated values, equal in the pulse and in the model)</p>
<ul class="simple">
<li>Elements of the diagonal: Generating a random double <img class="math" src="_images/math/09968cb620b9b121ddcc33bb90eab038355375ab.png" alt="f_1"/> between a range <em>(fMin,fMax)</em> (-NoiseStd,NoiseStd) to replace 0&#8217;s with <img class="math" src="_images/math/4481ab5191c6590ab32b14519035d4e48dc7dd6d.png" alt="f_1^2"/></li>
<li>Elements out of the diagonal: Generating two random doubles <img class="math" src="_images/math/09968cb620b9b121ddcc33bb90eab038355375ab.png" alt="f_1"/> and <img class="math" src="_images/math/a23addf1349384bc83f74ce7c550fe98bbdc2b48.png" alt="f_2"/> between a range <em>(fMin,fMax)</em> (-NoiseStd,NoiseStd) to replace 0&#8217;s with <img class="math" src="_images/math/af70ec4df51fcc6f619fda49aa14de2f1018b156.png" alt="f_1 \cdot f_2"/></li>
</ul>
</li>
<li><p class="first">Calculate the weight matrix</p>
</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N12weightMatrix16reconstruct_initE">
<span id="weightMatrix::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N12weightMatrix16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values).  In particular, this function uses <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-PulseLength"><code class="xref std std-option docutils literal"><span class="pre">PulseLength</span></code></a> and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-EnergyMethod"><code class="xref std std-option docutils literal"><span class="pre">EnergyMethod</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12weightMatrix15saturatedPulsesE">
<span id="weightMatrix::saturatedPulses__b"></span>bool <code class="descclassname"></code><code class="descname">saturatedPulses</code><a class="headerlink" href="#_CPPv2N12weightMatrix15saturatedPulsesE" title="Permalink to this definition">¶</a></dt>
<dd><p>If <em>true</em>, all the pulses ( <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-mode"><code class="xref std std-option docutils literal"><span class="pre">mode</span></code></a> = 0 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> all the pulses have the same energy) are saturated</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12weightMatrix9pulsesAllE">
<span id="weightMatrix::pulsesAll__PulsesCollectionP"></span>PulsesCollection *<code class="descclassname"></code><code class="descname">pulsesAll</code><a class="headerlink" href="#_CPPv2N12weightMatrix9pulsesAllE" title="Permalink to this definition">¶</a></dt>
<dd><p>Collection of pulses found in the previous records</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12weightMatrix14pulsesInRecordE">
<span id="weightMatrix::pulsesInRecord__PulsesCollectionP"></span>PulsesCollection *<code class="descclassname"></code><code class="descname">pulsesInRecord</code><a class="headerlink" href="#_CPPv2N12weightMatrix14pulsesInRecordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Collection of pulses found in the current record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12weightMatrix15nonpileupPulsesE">
<span id="weightMatrix::nonpileupPulses__l"></span>long <code class="descclassname"></code><code class="descname">nonpileupPulses</code><a class="headerlink" href="#_CPPv2N12weightMatrix15nonpileupPulsesE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of non piled-up pulses</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12weightMatrix12pulseaverageE">
<span id="weightMatrix::pulseaverage__gsl_vectorPP"></span>gsl_vector **<code class="descclassname"></code><code class="descname">pulseaverage</code><a class="headerlink" href="#_CPPv2N12weightMatrix12pulseaverageE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the pulseaverage (= template = model) of the non piled-up pulses</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12weightMatrix10covarianceE">
<span id="weightMatrix::covariance__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">covariance</code><a class="headerlink" href="#_CPPv2N12weightMatrix10covarianceE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL matrix with covariance matrix</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12weightMatrix6weightE">
<span id="weightMatrix::weight__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">weight</code><a class="headerlink" href="#_CPPv2N12weightMatrix6weightE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL matrix with weight matrix</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv214writeFilterHDUPP21ReconstructInitSIRENAiddP10gsl_vectorP10gsl_vectorP10gsl_vectorPP8fitsfile">
<span id="writeFilterHDU__ReconstructInitSIRENAPP.i.double.double.gsl_vectorP.gsl_vectorP.gsl_vectorP.fitsfilePP"></span>int <code class="descclassname"></code><code class="descname">writeFilterHDU</code><span class="sig-paren">(</span>ReconstructInitSIRENA **<em>reconstruct_init</em>, int <em>pulse_index</em>, double <em>normalizationFactor</em>, double <em>energy</em>, gsl_vector *<em>optimalfilter</em>, gsl_vector *<em>optimalfilter_f</em>, gsl_vector *<em>optimalfilter_FFT</em>, fitsfile **<em>dtcObject</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv214writeFilterHDUPP21ReconstructInitSIRENAiddP10gsl_vectorP10gsl_vectorP10gsl_vectorPP8fitsfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function runs in RECONSTRUCTION mode and writes the optimal filter info (in the FILTER HDU) for each pulse
if <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-intermediate"><code class="xref std std-option docutils literal"><span class="pre">intermediate</span></code></a> = 1.</p>
<ul class="simple">
<li>Declare variables</li>
<li>Open intermediate FITS file</li>
<li>Create the FILTER HDU if it is the first pulse</li>
<li>Write data<ul>
<li><strong>OPTIMALF</strong> column</li>
<li><strong>OFLENGTH</strong> column</li>
<li><strong>NFCTR</strong> column</li>
<li><strong>FREQ</strong> column</li>
<li><strong>OPTIMALFF</strong> column</li>
<li><strong>ENERGY</strong> column</li>
</ul>
</li>
<li>Modify the Primary HDU</li>
<li>Close intermediate output FITS file if it is necessary</li>
<li>Free memory</li>
</ul>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N14writeFilterHDU16reconstruct_initE">
<span id="writeFilterHDU::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N14writeFilterHDU16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-detectFile"><code class="xref std std-option docutils literal"><span class="pre">detectFile</span></code></a>,
<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-clobber"><code class="xref std std-option docutils literal"><span class="pre">clobber</span></code></a> and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-PulseLength"><code class="xref std std-option docutils literal"><span class="pre">PulseLength</span></code></a></p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14writeFilterHDU11pulse_indexE">
<span id="writeFilterHDU::pulse_index__i"></span>int <code class="descclassname"></code><code class="descname">pulse_index</code><a class="headerlink" href="#_CPPv2N14writeFilterHDU11pulse_indexE" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the pulse whose info is going to be written (to know if it is the first pulse)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14writeFilterHDU19normalizationFactorE">
<span id="writeFilterHDU::normalizationFactor__double"></span>double <code class="descclassname"></code><code class="descname">normalizationFactor</code><a class="headerlink" href="#_CPPv2N14writeFilterHDU19normalizationFactorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalization factor in the expression of the optimal filtering (see <a class="reference internal" href="SIRENA.html#optimalfilter"><span class="std std-ref">Optimal Filtering</span></a>)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14writeFilterHDU6energyE">
<span id="writeFilterHDU::energy__double"></span>double <code class="descclassname"></code><code class="descname">energy</code><a class="headerlink" href="#_CPPv2N14writeFilterHDU6energyE" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimated energy (eV)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14writeFilterHDU13optimalfilterE">
<span id="writeFilterHDU::optimalfilter__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">optimalfilter</code><a class="headerlink" href="#_CPPv2N14writeFilterHDU13optimalfilterE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal filter in time domain</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14writeFilterHDU15optimalfilter_fE">
<span id="writeFilterHDU::optimalfilter_f__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">optimalfilter_f</code><a class="headerlink" href="#_CPPv2N14writeFilterHDU15optimalfilter_fE" title="Permalink to this definition">¶</a></dt>
<dd><p>Frequency axis of the optimal filter spectrum</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14writeFilterHDU17optimalfilter_FFTE">
<span id="writeFilterHDU::optimalfilter_FFT__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">optimalfilter_FFT</code><a class="headerlink" href="#_CPPv2N14writeFilterHDU17optimalfilter_FFTE" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimal filter spectrum</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N14writeFilterHDU9dtcObjectE">
<span id="writeFilterHDU::dtcObject__fitsfilePP"></span>fitsfile **<code class="descclassname"></code><code class="descname">dtcObject</code><a class="headerlink" href="#_CPPv2N14writeFilterHDU9dtcObjectE" title="Permalink to this definition">¶</a></dt>
<dd><p>Fitsfile object for intermeadiate file name</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv216writeFitsComplex6IODataP10gsl_matrix">
<span id="writeFitsComplex__IOData.gsl_matrixP"></span>int <code class="descclassname"></code><code class="descname">writeFitsComplex</code><span class="sig-paren">(</span>IOData <em>obj</em>, gsl_matrix *<em>matrix</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv216writeFitsComplex6IODataP10gsl_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>inoututils.cpp</em></p>
<p>This function reads values of a GSL matrix. After that, the function puts them into a complex column of the output FITS file.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N16writeFitsComplex3objE">
<span id="writeFitsComplex::obj__IOData"></span>IOData <code class="descclassname"></code><code class="descname">obj</code><a class="headerlink" href="#_CPPv2N16writeFitsComplex3objE" title="Permalink to this definition">¶</a></dt>
<dd><p>Object for FITS column to be written</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N16writeFitsComplex6matrixE">
<span id="writeFitsComplex::matrix__gsl_matrixP"></span>gsl_matrix *<code class="descclassname"></code><code class="descname">matrix</code><a class="headerlink" href="#_CPPv2N16writeFitsComplex6matrixE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL matrix with data</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv215writeFitsSimple6IODataP10gsl_vector">
<span id="writeFitsSimple__IOData.gsl_vectorP"></span>int <code class="descclassname"></code><code class="descname">writeFitsSimple</code><span class="sig-paren">(</span>IOData <em>obj</em>, gsl_vector *<em>vector</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv215writeFitsSimple6IODataP10gsl_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Located  in file: <em>inoututils.cpp</em></p>
<p>This function reads values of a GSL vector. After that, the function puts them into a column of the output FITS file.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N15writeFitsSimple3objE">
<span id="writeFitsSimple::obj__IOData"></span>IOData <code class="descclassname"></code><code class="descname">obj</code><a class="headerlink" href="#_CPPv2N15writeFitsSimple3objE" title="Permalink to this definition">¶</a></dt>
<dd><p>Object for FITS column to be written</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N15writeFitsSimple6vectorE">
<span id="writeFitsSimple::vector__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">vector</code><a class="headerlink" href="#_CPPv2N15writeFitsSimple6vectorE" title="Permalink to this definition">¶</a></dt>
<dd><p>Input GSL vector with data</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv212writeLibraryP21ReconstructInitSIRENAddP10gsl_vectorP10gsl_matrixP10gsl_matrixbPP8fitsfile">
<span id="writeLibrary__ReconstructInitSIRENAP.double.double.gsl_vectorP.gsl_matrixP.gsl_matrixP.b.fitsfilePP"></span>int <code class="descclassname"></code><code class="descname">writeLibrary</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em>, double <em>samprate</em>, double <em>estenergy</em>, gsl_vector *<em>pulsetemplate</em>, gsl_matrix *<em>covariance</em>, gsl_matrix *<em>weight</em>, bool <em>appendToLibrary</em>, fitsfile **<em>inLibObject</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv212writeLibraryP21ReconstructInitSIRENAddP10gsl_vectorP10gsl_matrixP10gsl_matrixbPP8fitsfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function writes the library (reordering if it is necesary and calculating some intermediate parameters)</p>
<blockquote>
<div><ul class="simple">
<li>Adding a new row to the library</li>
<li>Write the first row of the library</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N12writeLibrary16reconstruct_initE">
<span id="writeLibrary::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N12writeLibrary16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12writeLibrary8samprateE">
<span id="writeLibrary::samprate__double"></span>double <code class="descclassname"></code><code class="descname">samprate</code><a class="headerlink" href="#_CPPv2N12writeLibrary8samprateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12writeLibrary9estenergyE">
<span id="writeLibrary::estenergy__double"></span>double <code class="descclassname"></code><code class="descname">estenergy</code><a class="headerlink" href="#_CPPv2N12writeLibrary9estenergyE" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulse height of the template whose energy is going to be added to the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12writeLibrary13pulsetemplateE">
<span id="writeLibrary::pulsetemplate__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">pulsetemplate</code><a class="headerlink" href="#_CPPv2N12writeLibrary13pulsetemplateE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the pulse template whose energy is going to be added to the library</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12writeLibrary10covarianceE">
<span id="writeLibrary::covariance__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">covariance</code><a class="headerlink" href="#_CPPv2N12writeLibrary10covarianceE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL matrix with covariance matrix</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12writeLibrary6weightE">
<span id="writeLibrary::weight__gsl_matrixPP"></span>gsl_matrix **<code class="descclassname"></code><code class="descname">weight</code><a class="headerlink" href="#_CPPv2N12writeLibrary6weightE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL matrix with weight matrix</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12writeLibrary15appendToLibraryE">
<span id="writeLibrary::appendToLibrary__b"></span>bool <code class="descclassname"></code><code class="descname">appendToLibrary</code><a class="headerlink" href="#_CPPv2N12writeLibrary15appendToLibraryE" title="Permalink to this definition">¶</a></dt>
<dd><p><em>true</em> if adding a new row to the library and <em>false</em> if it is the first row to be added</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N12writeLibrary11inLibObjectE">
<span id="writeLibrary::inLibObject__fitsfilePP"></span>fitsfile **<code class="descclassname"></code><code class="descname">inLibObject</code><a class="headerlink" href="#_CPPv2N12writeLibrary11inLibObjectE" title="Permalink to this definition">¶</a></dt>
<dd><p>FITS object containing information of the library FITS file</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv28writeLogP4FILE6stringi6string">
<span id="writeLog__FILEP.string.i.string"></span>void <code class="descclassname"></code><code class="descname">writeLog</code><span class="sig-paren">(</span>FILE *<em>fileRef</em>, string <em>type</em>, int <em>verbosity</em>, string <em>message</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv28writeLogP4FILE6stringi6string" title="Permalink to this definition">¶</a></dt>
<dd><p>Located  in file: <em>inoututils.cpp</em></p>
<p>This function includes the processing of the each level of message in the log file and the output screen:</p>
<blockquote>
<div><ul class="simple">
<li>Verbosity = 0 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The log file and the output screen include Errors</li>
<li>Verbosity = 1 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The log file and the output screen include Errors and Warnings</li>
<li>Verbosity = 2 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The log file and the output screen include Errors, Warnings and Alerts</li>
<li>Verbosity = 3 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> The log file and the output screen include Errors, Warnings, Alerts and Log messages</li>
</ul>
</div></blockquote>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N8writeLog7fileRefE">
<span id="writeLog::fileRef__FILEP"></span>FILE *<code class="descclassname"></code><code class="descname">fileRef</code><a class="headerlink" href="#_CPPv2N8writeLog7fileRefE" title="Permalink to this definition">¶</a></dt>
<dd><p>File reference to log file</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N8writeLog4typeE">
<span id="writeLog::type__string"></span>string <code class="descclassname"></code><code class="descname">type</code><a class="headerlink" href="#_CPPv2N8writeLog4typeE" title="Permalink to this definition">¶</a></dt>
<dd><p>String to indicate error type &#8220;Error&#8221;, &#8220;Warning&#8221;, &#8220;Alert&#8221;,&#8221;Log&#8221; or &#8220;OK&#8221;</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N8writeLog9verbosityE">
<span id="writeLog::verbosity__i"></span>int <code class="descclassname"></code><code class="descname">verbosity</code><a class="headerlink" href="#_CPPv2N8writeLog9verbosityE" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer value for verbosity</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N8writeLog7messageE">
<span id="writeLog::message__string"></span>string <code class="descclassname"></code><code class="descname">message</code><a class="headerlink" href="#_CPPv2N8writeLog7messageE" title="Permalink to this definition">¶</a></dt>
<dd><p>String message to print</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv211writePulsesPP21ReconstructInitSIRENAddP10gsl_vectoriP10gsl_vectorP10gsl_vectorP10gsl_vectorP10gsl_vectorP10gsl_vectorP8fitsfile">
<span id="writePulses__ReconstructInitSIRENAPP.double.double.gsl_vectorP.i.gsl_vectorP.gsl_vectorP.gsl_vectorP.gsl_vectorP.gsl_vectorP.fitsfileP"></span>int <code class="descclassname"></code><code class="descname">writePulses</code><span class="sig-paren">(</span>ReconstructInitSIRENA **<em>reconstruct_init</em>, double <em>samprate</em>, double <em>initialtime</em>, gsl_vector *<em>invectorNOTFIL</em>, int <em>numPulsesRecord</em>, gsl_vector *<em>tstart</em>, gsl_vector *<em>tend</em>, gsl_vector *<em>quality</em>, gsl_vector *<em>taurise</em>, gsl_vector *<em>taufall</em>, fitsfile *<em>dtcObject</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv211writePulsesPP21ReconstructInitSIRENAddP10gsl_vectoriP10gsl_vectorP10gsl_vectorP10gsl_vectorP10gsl_vectorP10gsl_vectorP8fitsfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function writes the data of the pulses found in the record in the intermediate FITS file (in the <strong>PULSES</strong> HDU). The pulses info given is: <strong>TSTART</strong>, <strong>I0</strong> (the pulse itself), <strong>TEND</strong>, <strong>TAURISE</strong>, <strong>TAUFALL</strong> and <strong>QUALITY</strong>.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N11writePulses16reconstruct_initE">
<span id="writePulses::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N11writePulses16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values). In particular, this function uses <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-detectFile"><code class="xref std std-option docutils literal"><span class="pre">detectFile</span></code></a>,
<a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-PulseLength"><code class="xref std std-option docutils literal"><span class="pre">PulseLength</span></code></a> and <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-clobber"><code class="xref std std-option docutils literal"><span class="pre">clobber</span></code></a>.</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11writePulses8samprateE">
<span id="writePulses::samprate__double"></span>double <code class="descclassname"></code><code class="descname">samprate</code><a class="headerlink" href="#_CPPv2N11writePulses8samprateE" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling rate (to convert samples to seconds)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11writePulses11initialtimeE">
<span id="writePulses::initialtime__double"></span>double <code class="descclassname"></code><code class="descname">initialtime</code><a class="headerlink" href="#_CPPv2N11writePulses11initialtimeE" title="Permalink to this definition">¶</a></dt>
<dd><p>Starting time of the record (in order to calculate absolute times)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11writePulses14invectorNOTFILE">
<span id="writePulses::invectorNOTFIL__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">invectorNOTFIL</code><a class="headerlink" href="#_CPPv2N11writePulses14invectorNOTFILE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the original record (neither low-pass filtered nor differentiated)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11writePulses15numPulsesRecordE">
<span id="writePulses::numPulsesRecord__i"></span>int <code class="descclassname"></code><code class="descname">numPulsesRecord</code><a class="headerlink" href="#_CPPv2N11writePulses15numPulsesRecordE" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of pulses found in the record</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11writePulses6tstartE">
<span id="writePulses::tstart__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">tstart</code><a class="headerlink" href="#_CPPv2N11writePulses6tstartE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the start times of the found pulses</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11writePulses4tendE">
<span id="writePulses::tend__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">tend</code><a class="headerlink" href="#_CPPv2N11writePulses4tendE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the end times of the found pulses</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11writePulses7qualityE">
<span id="writePulses::quality__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">quality</code><a class="headerlink" href="#_CPPv2N11writePulses7qualityE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the quality of the found pulses</p>
<p>0 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Standard (good) pulses</p>
<p>1 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Truncated pulses</p>
<p>10 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Saturated pulses</p>
<p>11 <img class="math" src="_images/math/97e58c1e7a742a4105ca9408b7e8a9bf45658360.png" alt="\Rightarrow"/> Truncated and saturated pulses</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11writePulses7tauriseE">
<span id="writePulses::taurise__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">taurise</code><a class="headerlink" href="#_CPPv2N11writePulses7tauriseE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the rise time constants of the found pulses (to be done)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11writePulses7taufallE">
<span id="writePulses::taufall__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">taufall</code><a class="headerlink" href="#_CPPv2N11writePulses7taufallE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with the fall time constants of the found pulses (to be done)</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N11writePulses9dtcObjectE">
<span id="writePulses::dtcObject__fitsfileP"></span>fitsfile *<code class="descclassname"></code><code class="descname">dtcObject</code><a class="headerlink" href="#_CPPv2N11writePulses9dtcObjectE" title="Permalink to this definition">¶</a></dt>
<dd><p>Object which contains information of the intermediate FITS file</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="_CPPv213writeTestInfoP21ReconstructInitSIRENAP10gsl_vectordP8fitsfile">
<span id="writeTestInfo__ReconstructInitSIRENAP.gsl_vectorP.double.fitsfileP"></span>int <code class="descclassname"></code><code class="descname">writeTestInfo</code><span class="sig-paren">(</span>ReconstructInitSIRENA *<em>reconstruct_init</em>, gsl_vector *<em>recordDERIVATIVE</em>, double <em>threshold</em>, fitsfile *<em>dtcObject</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv213writeTestInfoP21ReconstructInitSIRENAP10gsl_vectordP8fitsfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Located in file: <em>tasksSIRENA.cpp</em></p>
<p>This function writes the <strong>TESTINFO</strong> HDU in the intermediate FITS file. The written columns are <strong>FILDER</strong> (low-pass filtered and differentiated record) and <strong>THRESHOLD</strong>.</p>
<p><strong>Members/Variables</strong></p>
<dl class="member">
<dt id="_CPPv2N13writeTestInfo16reconstruct_initE">
<span id="writeTestInfo::reconstruct_init__ReconstructInitSIRENAPP"></span>ReconstructInitSIRENA **<code class="descclassname"></code><code class="descname">reconstruct_init</code><a class="headerlink" href="#_CPPv2N13writeTestInfo16reconstruct_initE" title="Permalink to this definition">¶</a></dt>
<dd><p>Member of <em>ReconstructInitSIRENA</em> structure to initialize the reconstruction parameters (pointer and values).  In particular, this function uses <a class="reference internal" href="SIRENAcommandline.html#cmdoption-arg-detectFile"><code class="xref std std-option docutils literal"><span class="pre">detectFile</span></code></a>.</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13writeTestInfo16recordDERIVATIVEE">
<span id="writeTestInfo::recordDERIVATIVE__gsl_vectorP"></span>gsl_vector *<code class="descclassname"></code><code class="descname">recordDERIVATIVE</code><a class="headerlink" href="#_CPPv2N13writeTestInfo16recordDERIVATIVEE" title="Permalink to this definition">¶</a></dt>
<dd><p>GSL vector with input record (low-pass filtered and) differentiated</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13writeTestInfo9thresholdE">
<span id="writeTestInfo::threshold__double"></span>double <code class="descclassname"></code><code class="descname">threshold</code><a class="headerlink" href="#_CPPv2N13writeTestInfo9thresholdE" title="Permalink to this definition">¶</a></dt>
<dd><p>Threshold value used to find pulses</p>
</dd></dl>

<dl class="member">
<dt id="_CPPv2N13writeTestInfo9dtcObjectE">
<span id="writeTestInfo::dtcObject__fitsfile"></span>fitsfile <code class="descclassname"></code><code class="descname">dtcObject</code><a class="headerlink" href="#_CPPv2N13writeTestInfo9dtcObjectE" title="Permalink to this definition">¶</a></dt>
<dd><p>Object which contains information of the intermediate FITS file</p>
</dd></dl>

</dd></dl>

<span class="target" id="z"><span id="y"></span><span id="x"></span></span></div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="zreferences.html" class="btn btn-neutral float-right" title="References" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="SIRENAcommandline.html" class="btn btn-neutral" title="SIRENA Tools CLI" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Maite Ceballos &amp; Bea Cobo (IFCA).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>